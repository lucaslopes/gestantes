[
  {
    "objectID": "README.html",
    "href": "README.html",
    "title": "Introdução",
    "section": "",
    "text": "Contexto\nNo Brasil, 98% dos partos ocorrem em ambiente hospitalar, e 77% no Sistema Único de Saúde (SUS). O acesso oportuno aos serviços obstétricos de internação para o parto é fundamental para garantir a segurança do cuidado materno e neonatal. Entretanto, há “vazios assistenciais” na oferta de serviços hospitalares pelo SUS que fazem com que grande parte das parturientes precise se deslocar de um município a outro para ser assistida.\nO retardo na atenção obstétrica no momento do parto está associado à desfechos maternos adversos, e o deslocamento de grandes distâncias tem sido associado a níveis elevados de mortalidade infantil e neonatal, além de maior risco de morbimortalidade materna. Assim, a análise da distância percorrida pelas parturientes de sua residência até o hospital é um indicador útil e sensível para avaliar a dificuldade em acessar cuidados maternos e neonatais no SUS.\nA análise da acessibilidade geográfica é um componente importante da avaliação de serviços de saúde e reflete aspectos da distribuição espacial da oferta de serviços que dificultam ou promovem sua utilização. A metodologia de análise de redes sociais (ARS) tem sido utilizada nesse contexto, incluindo a internação para o parto, e também como ferramenta para gestão em saúde.\nEste projeto tem o objetivo de analisar a acessibilidade geográfica ao parto hospitalar realizado no SUS nos últimos 10 anos, em todo Brasil, aplicando a ARS como uma nova ferramenta para a gestão de serviços de saúde. Serão utilizados dados do Departamento de Informática do SUS (DATASUS) para a construção das redes de deslocamento das gestantes em busca de internação para o parto, levando-se em conta as distâncias percorridas, mapeando fluxos preferenciais e identificando lacunas geográficas de atendimento e polos de atração de maior demanda, como medida de inequidade no acesso aos serviços. O projeto avança no processo de avaliação do sistema de saúde ao desenvolver novos indicadores de acesso à serviços obstétricos, baseados em uma metodologia inovadora, e com abrangência nacional e aplicabilidade a outras áreas de saúde pública.\nEspera-se, com este estudo, gerar evidências que permitam um melhor entendimento da organização e das fragilidades do SUS na assistência à saúde da mulher no ciclo gravídico-puerperal, contribuindo para o planejamento da atenção obstétrica e para o fortalecimento de políticas públicas voltadas para melhoria do acesso aos serviços de saúde."
  },
  {
    "objectID": "sections/brasil.html",
    "href": "sections/brasil.html",
    "title": "Brasil",
    "section": "",
    "text": "Coletar procedimentos de parto de alto risco separadamente conforme códigos de procedimento abaixo:\n\n\n0310010012 ASSISTÊNCIA AO PARTO SEM DISTOCIA\n0310010039 PARTO NORMAL\n0310010047 PARTO NORMAL EM GESTACAO DE ALTO RISCO\n0310010055 PARTO NORMAL EM CENTRO DE PARTO NORMAL\n\n0411010026 PARTO CESARIANO EM GESTACAO DE ALTO RISCO\n0411010034 PARTO CESARIANO\n0411010042 PARTO CESARIANO C/ LAQUEADURA TUBARIA.\n\nFiguras para o relatório do Fiocruz Inova 22/12\n\nQuantidade de procedimentos analisados em cada biênio, separados em parto normal e parto cesariano\n% de gestantes que se deslocaram em cada biênio, separados em parto normal e parto cesariano\n% de gestantes que se deslocaram em cada biênio, agrupadas por estado de residência (agrupar parto normal e cesariano)\nMédia ponderada das distâncias percorridas pelas gestantes em cada biênio, por estado de residência (agrupar parto normal e cesariano)\nFazer análise de tendência dos 10 anos (2010-2019)\n\nNas figuras em que agruparemos por estado de residência, a gente vai continuar considerando os deslocamentos entre municípios. Só vamos filtrar pelos municípios localizados em cada um dos estados do Brasil"
  },
  {
    "objectID": "sections/database_cnes.html",
    "href": "sections/database_cnes.html",
    "title": "CNES",
    "section": "",
    "text": "import re\nimport csv\nimport time\nimport numpy as np\nimport pandas as pd\nfrom tqdm import tqdm\nfrom os import listdir\nfrom datatable import dt, f, by\nfrom bs4 import BeautifulSoup\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.common.keys import Keys\nfrom selenium.webdriver.chrome.options import Options\nfrom utils import get_path, data_load, group_cols"
  },
  {
    "objectID": "sections/database_cnes.html#sih",
    "href": "sections/database_cnes.html#sih",
    "title": "CNES",
    "section": "SIH",
    "text": "SIH\n\nColunas da tabela\n\ncols_sih = [\n  'cnes',\n]\n\n\npath_sih = get_path('SIH', 'sih.jay')\ndf_sih = dt.fread(path_sih)\ndf_sih = df_sih[:, cols_sih]\ndf_sih\n\n\n\n  \n  \n    cnes\n    ▪▪▪▪\n  \n  \n    02679477\n    12679477\n    22679477\n    32679477\n    42679477\n    52679477\n    62679477\n    72679477\n    82679477\n    92679477\n    102679477\n    112679477\n    122679477\n    132679477\n    142679477\n    ⋮⋮\n    608,8985717515\n    608,8995717515\n    608,9005717515\n    608,9015717515\n    608,9025717515\n  \n  \n  \n    608,903 rows × 1 column\n  \n\n\n\n\n\nTabela agrupada\n\ndf_sih = group_cols(df_sih, cols_sih).sort(-f.count)\ndf_sih\n\n\n\n  \n  \n    cnescount\n    ▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    023233976023\n    1267945307\n    223622874746\n    323391963991\n    44343981\n    539563693786\n    624092083756\n    724274273531\n    823519943299\n    927116132902\n    1027527002799\n    113962785\n    124182771\n    1324993632683\n    1427551572629\n    ⋮⋮⋮\n    414873201751\n    414976030291\n    415076214421\n    415177043641\n    415277430681\n  \n  \n  \n    4153 rows × 2 columns"
  },
  {
    "objectID": "sections/database_cnes.html#cnes-coletados",
    "href": "sections/database_cnes.html#cnes-coletados",
    "title": "CNES",
    "section": "CNES coletados",
    "text": "CNES coletados\n\ndf_cnes_collect = pd.DataFrame()\ndf_cnes_collect['cnes'] = cnes_list\ndf_cnes_collect['collected'] = [len(df) ==  1 for df in dfs]\ndf_cnes_collect\n\n\n\n\n\n  \n    \n      \n      cnes\n      collected\n    \n  \n  \n    \n      0\n      0002232\n      True\n    \n    \n      1\n      3151794\n      True\n    \n    \n      2\n      2323397\n      True\n    \n    \n      3\n      2311682\n      True\n    \n    \n      4\n      0026794\n      True\n    \n    \n      ...\n      ...\n      ...\n    \n    \n      4145\n      7320175\n      True\n    \n    \n      4146\n      7603029\n      True\n    \n    \n      4147\n      7621442\n      True\n    \n    \n      4148\n      7704364\n      True\n    \n    \n      4149\n      7743068\n      True\n    \n  \n\n4150 rows × 2 columns\n\n\n\n\nn_cnes = df_cnes_collect.shape[0]\nn_collected = df_cnes_collect[df_cnes_collect['collected'] == True].shape[0]\npercent_clct = n_collected / n_cnes\nprint(f'Collected {n_collected} cnes from {n_cnes} ({percent_clct:.2f}%)')\n\nCollected 3928 cnes from 4150 (0.95%)"
  },
  {
    "objectID": "sections/database_cnes.html#concatenando-tabelas",
    "href": "sections/database_cnes.html#concatenando-tabelas",
    "title": "CNES",
    "section": "Concatenando tabelas",
    "text": "Concatenando tabelas\nConcatenação das tabelas em uma\n\ndf_cnes = pd.concat([df for df in dfs if len(df) ==  1])\ndf_cnes\n\n\n\n\n\n  \n    \n      \n      UF\n      Município\n      CNES\n      Nome Fantasia\n      Natureza Jurídica(Grupo)\n      Gestão\n      Atende SUS\n    \n  \n  \n    \n      0\n      SE\n      ARACAJU\n      0002232\n      HOSPITAL E MATERNIDADE SANTA IZABEL\n      ENTIDADES SEM FINS LUCRATIVOS\n      M\n      SIM\n    \n    \n      0\n      AM\n      MANAUS\n      3151794\n      MATERNIDADE DE REFERENCIA ANA BRAGA\n      ADMINISTRAÇÃO PÚBLICA\n      E\n      SIM\n    \n    \n      0\n      PI\n      TERESINA\n      2323397\n      MATERNIDADE DONA EVANGELINA ROSA\n      ADMINISTRAÇÃO PÚBLICA\n      M\n      SIM\n    \n    \n      0\n      MT\n      CUIABA\n      2311682\n      HOSPITAL SANTA HELENA\n      ENTIDADES SEM FINS LUCRATIVOS\n      M\n      SIM\n    \n    \n      0\n      MG\n      BELO HORIZONTE\n      0026794\n      HOSPITAL SOFIA FELDMAN\n      ENTIDADES SEM FINS LUCRATIVOS\n      M\n      SIM\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      0\n      SP\n      SAO MIGUEL ARCANJO\n      7320175\n      HOSPITAL SAO MIGUEL ARCANJO\n      ENTIDADES SEM FINS LUCRATIVOS\n      M\n      SIM\n    \n    \n      0\n      MA\n      BOA VISTA DO GURUPI\n      7603029\n      HOSPITAL MUNICIPAL LENILDE OLIVEIRA\n      ADMINISTRAÇÃO PÚBLICA\n      M\n      SIM\n    \n    \n      0\n      ES\n      VITORIA\n      7621442\n      HOSPITAL ESTADUAL DE URGENCIA E EMERGENCIA\n      ADMINISTRAÇÃO PÚBLICA\n      E\n      SIM\n    \n    \n      0\n      RO\n      CACOAL\n      7704364\n      HOSPITAL DE URGENCIA E EMERGENCIA REGIONAL DE ...\n      ADMINISTRAÇÃO PÚBLICA\n      E\n      SIM\n    \n    \n      0\n      GO\n      GOIANIA\n      7743068\n      HOSPITAL ESTADUAL DE URGENCIAS GOV OTAVIO LAG ...\n      ADMINISTRAÇÃO PÚBLICA\n      E\n      SIM\n    \n  \n\n3928 rows × 7 columns"
  },
  {
    "objectID": "sections/database_cnes.html#cnes-não-atendem-sus",
    "href": "sections/database_cnes.html#cnes-não-atendem-sus",
    "title": "CNES",
    "section": "CNES não atendem SUS",
    "text": "CNES não atendem SUS\n\nQuantidade dos que atendem\n\ndf_cnes['Atende SUS'].value_counts()\n\nSIM    3814\nNÃO     114\nName: Atende SUS, dtype: int64\n\n\n\n\nOs que não antendem\n\ndf_not_sus = df_cnes[df_cnes['Atende SUS'] == 'NÃO']\ndf_not_sus =  df_not_sus.sort_values(by='UF')\ndf_not_sus\n\n\n\n\n\n  \n    \n      \n      UF\n      Município\n      CNES\n      Nome Fantasia\n      Natureza Jurídica(Grupo)\n      Gestão\n      Atende SUS\n    \n  \n  \n    \n      0\n      AL\n      MACEIO\n      2808889\n      HOSPITAL SAO RAFAEL\n      ENTIDADES EMPRESARIAIS\n      M\n      NÃO\n    \n    \n      0\n      AL\n      MACEIO\n      6782477\n      HOSPITAL GERAL E MATERNIDADE ALERTA MEDICO\n      ENTIDADES EMPRESARIAIS\n      M\n      NÃO\n    \n    \n      0\n      BA\n      IBIPEBA\n      2412985\n      HOSPITAL BOM JESUS DE NAZARE\n      ENTIDADES EMPRESARIAIS\n      E\n      NÃO\n    \n    \n      0\n      BA\n      IBIRATAIA\n      2413051\n      MATERNIDADE AURELINA VIRGILIA FAIR\n      ENTIDADES SEM FINS LUCRATIVOS\n      M\n      NÃO\n    \n    \n      0\n      BA\n      EUNAPOLIS\n      2556642\n      HOSPITAL E MATERNIDADE DE EUNAPOLIS\n      ENTIDADES EMPRESARIAIS\n      M\n      NÃO\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      0\n      SP\n      MORUNGABA\n      2026392\n      HOSPITAL SANTO ANTONIO\n      ENTIDADES EMPRESARIAIS\n      M\n      NÃO\n    \n    \n      0\n      SP\n      CAIEIRAS\n      6817203\n      HOSPITAL DE CLINICAS CAIEIRAS\n      ENTIDADES EMPRESARIAIS\n      M\n      NÃO\n    \n    \n      0\n      SP\n      SAO PAULO\n      2076934\n      HOSPITAL SOROCABANA\n      ENTIDADES SEM FINS LUCRATIVOS\n      M\n      NÃO\n    \n    \n      0\n      SP\n      TUPA\n      2080672\n      HOSPITAL SAO FRANCISCO TUPA\n      ENTIDADES SEM FINS LUCRATIVOS\n      M\n      NÃO\n    \n    \n      0\n      SP\n      TREMEMBE\n      2081326\n      HOSPITAL BOM JESUS DE TREMEMBE\n      ENTIDADES SEM FINS LUCRATIVOS\n      M\n      NÃO\n    \n  \n\n114 rows × 7 columns\n\n\n\n\n\nUF\n\ndf_not_sus['UF'].value_counts()\n\nPA    18\nBA    15\nPR    14\nGO    10\nRJ     8\nPE     8\nCE     6\nSP     5\nMT     5\nMS     4\nMA     4\nMG     4\nPI     3\nES     2\nRN     2\nAL     2\nSE     1\nRS     1\nPB     1\nDF     1\nName: UF, dtype: int64\n\n\n\n\nNatureza Jurídica(Grupo)\n\ndf_not_sus['Natureza Jurídica(Grupo)'].value_counts()\n\nENTIDADES EMPRESARIAIS           95\nENTIDADES SEM FINS LUCRATIVOS    17\nADMINISTRAÇÃO PÚBLICA             2\nName: Natureza Jurídica(Grupo), dtype: int64"
  },
  {
    "objectID": "sections/database_dists.html",
    "href": "sections/database_dists.html",
    "title": "Distâncias",
    "section": "",
    "text": "import sys\nimport json\nimport pickle\nimport numpy as np\nimport pandas as pd\nimport googlemaps as gmaps\n\nfrom os import listdir, walk\nfrom tqdm import tqdm\nfrom pathlib import Path\nfrom datetime import datetime\nfrom datatable import dt, f, by, join\n\nfrom plotly import express as px, io as pio\npd.options.plotting.backend = 'plotly'\npio.renderers.default = 'plotly_mimetype+notebook_connected'\n\nfrom utils import get_path, data_load, group_cols\nsys.path.insert(0, '../')\nfrom secret import API_KEY"
  },
  {
    "objectID": "sections/database_dists.html#open-street-map",
    "href": "sections/database_dists.html#open-street-map",
    "title": "Distâncias",
    "section": "Open Street Map",
    "text": "Open Street Map\nThis working paper describes the methodological procedure for calculating distances and travel time between the 5,570 Brazilian municipalities using the APIs from Google Maps (Application Programming Interface) and, mainly, OpenStreet Maps. This is an update of the results of Carvalho et at. (2016). The data generated by this work provide relevant information that can be used by other academic works with the most diverse applications, such as, for example, applications in regional economics, dynamic allocation models, operational research, spatial econometrics or general equilibrium models. Therefore, the main objective of this work is to build a database that can be used in several applied studies.\nArtigo\nPDF Online\nDownload\n\nCarregando tabela\n\nurl_dist = 'https://www.dropbox.com/sh/1gx8xwdddrwz2gt/AAA115SmiZ0LtTsgzrJIhrb6a/matriz_distancias.zip?dl=1'\n\n\ndf_osm = pd.read_csv(url_dist, compression='zip')\ndf_osm = dt.Frame(df_osm)\ndf_osm\n\n\n\n  \n  \n    origemdestinodistanciatempo\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000100\n    1110001110002309.056.16906\n    2110001110003399.56.28906\n    311000111000481.20111.91775\n    4110001110005391.7046.13636\n    5110001110006353.4175.53989\n    6110001110007313.5926.18117\n    7110001110008326.9835.34175\n    8110001110009145.6782.346\n    9110001110010649.54513.405\n    10110001110011214.1253.83481\n    11110001110012130.772.54781\n    12110001110013357.5117.13067\n    1311000111001460.21031.02275\n    14110001110015172.9263.18425\n    ⋮⋮⋮⋮⋮\n    31,024,895530010522200161.7292.356\n    31,024,896530010522205382.7095.47956\n    31,024,897530010522220161.6032.24894\n    31,024,898530010522230190.0013.21608\n    31,024,89953001053001000\n  \n  \n  \n    31,024,900 rows × 4 columns\n  \n\n\n\n~30 seconds to download\n\n\nSalvando tabela baixada\n\npath_osm = get_path('DISTANCIAS', 'distancias.jay')\ndf_osm.to_jay(path_osm)"
  },
  {
    "objectID": "sections/database_dists.html#municípios",
    "href": "sections/database_dists.html#municípios",
    "title": "Distâncias",
    "section": "Municípios",
    "text": "Municípios\n\nCarregando tabela\n\npath_munic = get_path('LOCALIDADES', 'municipios.csv.gzip')\ndf_munic = dt.fread(path_munic)\ndf_munic\n\n\n\n  \n  \n    cod_municipionome_municipiocapitalufcod_ufnome_ufregiaolatitudelongitude\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0520005Abadia de Goiás0GO52GoiásCentro-Oeste−16.7573−49.4412\n    1310010Abadia dos Dourados0MG31Minas GeraisSudeste−18.4831−47.3916\n    2520010Abadiânia0GO52GoiásCentro-Oeste−16.197−48.7057\n    3310020Abaeté0MG31Minas GeraisSudeste−19.1551−45.4444\n    4150010Abaetetuba0PA15ParáNorte−1.72183−48.8788\n    5230010Abaiara0CE23CearáNordeste−7.34588−39.0416\n    6290010Abaíra0BA29BahiaNordeste−13.2488−41.6619\n    7290020Abaré0BA29BahiaNordeste−8.72073−39.1162\n    8410010Abatiá0PR41ParanáSul−23.3049−50.3133\n    9420005Abdon Batista0SC42Santa CatarinaSul−27.6126−51.0233\n    10150013Abel Figueiredo0PA15ParáNorte−4.95333−48.3933\n    11420010Abelardo Luz0SC42Santa CatarinaSul−26.5716−52.3229\n    12310030Abre Campo0MG31Minas GeraisSudeste−20.2996−42.4743\n    13260005Abreu e Lima0PE26PernambucoNordeste−7.90072−34.8984\n    14170025Abreulândia0TO17TocantinsNorte−9.62101−49.1518\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    5565293360Xique-Xique0BA29BahiaNordeste−10.823−42.7245\n    5566251740Zabelê0PB25ParaíbaNordeste−8.07901−37.1057\n    5567355715Zacarias0SP35São PauloSudeste−21.0506−50.0552\n    5568211400Zé Doca0MA21MaranhãoNordeste−3.27014−45.6553\n    5569421985Zortéa0SC42Santa CatarinaSul−27.4521−51.552\n  \n  \n  \n    5570 rows × 9 columns"
  },
  {
    "objectID": "sections/database_dists.html#sih",
    "href": "sections/database_dists.html#sih",
    "title": "Distâncias",
    "section": "SIH",
    "text": "SIH\n\nColunas\n\ncols_sih = {\n  'cod_municipio': 'origem',\n  'hosp_cod_municipio': 'destino',\n}\n\n\n\nCarregando tabela\n\npath_sih = get_path('SIH', 'sih.jay')\ndf_sih = dt.fread(path_sih, columns=cols_sih)\ndf_sih.names = cols_sih\ndf_sih = df_sih[:, list(cols_sih.values())]\ndf_sih = df_sih[f.origem != f.destino, :]\ndf_sih['count'] = 1\ndf_sih = df_sih[:, dt.sum(f.count), by('origem', 'destino')]\ndf_sih = df_sih.sort(-f.count)\ndf_sih\n\n\n\n  \n  \n    origemdestinocount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    051084051034022807\n    131546031062017147\n    226079026116016012\n    352125053001015461\n    428048028003015090\n    533035033028514875\n    623037023044014545\n    732050032053014543\n    815008015014014521\n    943230043149014273\n    1052002553001013577\n    1135150035528013106\n    1252014052087012745\n    1341004041069012717\n    1452218553001012112\n    ⋮⋮⋮⋮\n    68,5685300105213081\n    68,5695300105217701\n    68,5705300105220001\n    68,5715300105220201\n    68,5725300105220451\n  \n  \n  \n    68,573 rows × 3 columns"
  },
  {
    "objectID": "sections/database_dists.html#latitude-longitude",
    "href": "sections/database_dists.html#latitude-longitude",
    "title": "Distâncias",
    "section": "Latitude & Longitude",
    "text": "Latitude & Longitude\n\ndef get_latlon_table_by_ref(df_munic, ref):\n  cols_latlon = ['cod_municipio', 'latitude', 'longitude']\n  df_latlon = df_munic[:, cols_latlon]\n  df_latlon.names = {\n    'cod_municipio': ref,\n    'latitude': f'{ref}_latitude',\n    'longitude': f'{ref}_longitude',\n  }\n  df_latlon.key = ref\n  return df_latlon"
  },
  {
    "objectID": "sections/database_dists.html#parâmetros",
    "href": "sections/database_dists.html#parâmetros",
    "title": "Distâncias",
    "section": "Parâmetros",
    "text": "Parâmetros\n\ndef params_in_cols(df):\n  dfs = list()\n  for mode in ['driving', 'transit']: # driving | transit | bicycling | walking\n    for hour in [6, 12, 18]: # [6, 12, 18] | [7, 13, 19]\n      for traffic_model in ['best_guess', 'optimistic', 'pessimistic']: # best_guess | optimistic | pessimistic\n        if mode != 'driving' and traffic_model != 'best_guess':\n          continue\n        df_ = df.copy()\n        df_['mode'] = mode\n        df_['traffic_model'] = traffic_model\n        df_['hour'] = hour\n        dfs.append(df_)\n  df_param = pd.concat(dfs)\n  df_param = df_param.sort_values(by=[\n    'origem', 'destino', 'mode', 'traffic_model', 'hour'])\n  df_param = df_param.reset_index(drop=True)\n  return df_param"
  },
  {
    "objectID": "sections/database_dists.html#local-pra-armazenar-arquivo",
    "href": "sections/database_dists.html#local-pra-armazenar-arquivo",
    "title": "Distâncias",
    "section": "Local pra armazenar arquivo",
    "text": "Local pra armazenar arquivo\n\ndef get_backup_path(data):\n  infos = [\n    f'{data[\"hour\"]}h',\n    data['mode'],\n    data['traffic_model'],\n    str(data['origem']),\n    str(data['destino'])]\n  fname = '-'.join(infos)\n  dir = '/'.join(infos[:-1])\n  path_dir = get_path('LOCALIDADES', f'google_maps/{dir}')\n  Path(path_dir).mkdir(parents=True, exist_ok=True)\n  return path_dir + f'/{fname}.json'"
  },
  {
    "objectID": "sections/database_dists.html#requisição-para-api",
    "href": "sections/database_dists.html#requisição-para-api",
    "title": "Distâncias",
    "section": "Requisição para API",
    "text": "Requisição para API\n\ndef get_travel_info(row):\n  departure_time = datetime(year=2022, month=11, day=7, hour=row['hour'])\n  info = row.copy()\n  info['departure_time'] = str(departure_time)\n  res = gmaps.distance_matrix(\n    origins = [(row['origem_latitude'], row['origem_longitude'])],\n    destinations = [(row['destino_latitude'], row['destino_longitude'])],\n    mode = row['mode'],\n    traffic_model = row['traffic_model'],\n    departure_time = departure_time,\n    language = 'pt-BR',\n    units = 'metric',)\n  info['origin_addresses'] = res['origin_addresses'][0]\n  info['destination_addresses'] = res['destination_addresses'][0]\n  elem = res['rows'][0]['elements'][0]\n  info['status'] = elem['status']\n  for col in list(elem):\n    if col == 'status':\n      continue\n    for i_type in ['text', 'value']:\n      col_name = f'{col} ({i_type})'\n      if elem['status'] == 'OK':\n        info[col_name] = elem[col][i_type]\n      else:\n        info[col_name] = ''\n  return info"
  },
  {
    "objectID": "sections/database_dists.html#coleta-das-informações",
    "href": "sections/database_dists.html#coleta-das-informações",
    "title": "Distâncias",
    "section": "Coleta das informações",
    "text": "Coleta das informações\n\ndef request_travel_infos(df):\n  for row in tqdm(df.to_dict(orient='records')):\n    fpath = get_backup_path(row)\n    if Path(fpath).is_file() or (row['origem'] == row['destino']):\n      continue\n    try:\n      info = get_travel_info(row)\n    except:\n      info = {'status': 'ApiError'}\n    with open(fpath, 'w') as fp:\n      json.dump(info, fp)"
  },
  {
    "objectID": "sections/database_dists.html#seleção-parâmetros",
    "href": "sections/database_dists.html#seleção-parâmetros",
    "title": "Distâncias",
    "section": "Seleção parâmetros",
    "text": "Seleção parâmetros\n\ndef select_params(\n    df,\n    mode, # driving | transit | bicycling | walking\n    traffic_model, # best_guess | optimistic | pessimistic\n    hour, # [6, 12, 18] | [7, 13, 19]\n  ):\n  df_param = df[\n    (\n      df['mode'] == mode\n    ) & (\n      df['traffic_model'] == traffic_model\n    ) & (\n      df['hour'] == hour\n    )\n  ].sort_values(by='count', ascending=False)\n  return df_param"
  },
  {
    "objectID": "sections/database_dists.html#filtros",
    "href": "sections/database_dists.html#filtros",
    "title": "Distâncias",
    "section": "Filtros",
    "text": "Filtros\n\nIntra RJ\norigem e destino no estado do RJ.\n\norigem_rj = df_route['origem'].astype(str).str.startswith('33')\ndestino_rj = df_route['destino'].astype(str).str.startswith('33')\ndf_route_rj = df_route[origem_rj & destino_rj]\ndf_route_rj\n\n\n\n\n\n  \n    \n      \n      origem\n      destino\n      count\n      origem_latitude\n      origem_longitude\n      destino_latitude\n      destino_longitude\n      mode\n      traffic_model\n      hour\n    \n  \n  \n    \n      497964\n      330010\n      330023\n      1\n      -23.0011\n      -44.3196\n      -22.7528\n      -41.8846\n      driving\n      best_guess\n      6\n    \n    \n      497965\n      330010\n      330023\n      1\n      -23.0011\n      -44.3196\n      -22.7528\n      -41.8846\n      driving\n      best_guess\n      12\n    \n    \n      497966\n      330010\n      330023\n      1\n      -23.0011\n      -44.3196\n      -22.7528\n      -41.8846\n      driving\n      best_guess\n      18\n    \n    \n      497967\n      330010\n      330023\n      1\n      -23.0011\n      -44.3196\n      -22.7528\n      -41.8846\n      driving\n      optimistic\n      6\n    \n    \n      497968\n      330010\n      330023\n      1\n      -23.0011\n      -44.3196\n      -22.7528\n      -41.8846\n      driving\n      optimistic\n      12\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      519643\n      330630\n      330620\n      1\n      -22.5202\n      -44.0996\n      -22.4059\n      -43.6686\n      driving\n      pessimistic\n      12\n    \n    \n      519644\n      330630\n      330620\n      1\n      -22.5202\n      -44.0996\n      -22.4059\n      -43.6686\n      driving\n      pessimistic\n      18\n    \n    \n      519645\n      330630\n      330620\n      1\n      -22.5202\n      -44.0996\n      -22.4059\n      -43.6686\n      transit\n      best_guess\n      6\n    \n    \n      519646\n      330630\n      330620\n      1\n      -22.5202\n      -44.0996\n      -22.4059\n      -43.6686\n      transit\n      best_guess\n      12\n    \n    \n      519647\n      330630\n      330620\n      1\n      -22.5202\n      -44.0996\n      -22.4059\n      -43.6686\n      transit\n      best_guess\n      18\n    \n  \n\n15792 rows × 10 columns"
  },
  {
    "objectID": "sections/database_dists.html#consulta-api",
    "href": "sections/database_dists.html#consulta-api",
    "title": "Distâncias",
    "section": "Consulta API",
    "text": "Consulta API\n\ngmaps = gmaps.Client(key=API_KEY)\n\n\n# df_param = select_params(df_route_rj, 'driving', 'pessimistic', 18)\n# df_param = select_params(df_route_rj, 'transit', 'best_guess', 6)\n# df_param\n\n\n# df_param = select_params(df_route_sorted, 'driving', 'pessimistic', 18)\n# request_travel_infos(df_param)\n\n\n# df_param = select_params(df_route_sorted, 'transit', 'best_guess', 6)\n# request_travel_infos(df_param)\n\nRJ driving best_guess 6h\n100%|██████████| 1316/1316 [04:07<00:00, 5.32it/s]\nRJ driving best_guess 12h\n100%|██████████| 1316/1316 [04:28<00:00, 4.91it/s]\nRJ driving best_guess 18h\n100%|██████████| 1316/1316 [04:29<00:00, 4.89it/s]\nRJ driving pessimistic 18h\n100%|██████████| 1316/1316 [04:26<00:00, 5.12it/s]\nRJ transit best_guess 12h\n100%|██████████| 1316/1316 [03:20<00:00, 6.56it/s]"
  },
  {
    "objectID": "sections/database_dists.html#lendo-arquivos-salvos",
    "href": "sections/database_dists.html#lendo-arquivos-salvos",
    "title": "Distâncias",
    "section": "Lendo arquivos salvos",
    "text": "Lendo arquivos salvos\n\ndef read_data_to_df(path_dir, cols_order=None):\n  files = list()\n  for (dirpath, _, filenames) in walk(path_dir):\n    files.extend([dirpath + '/' + fl for fl in filenames if 'json' in fl])\n  infos = list()\n  for file in files:\n    with open(file) as fl:\n      d = json.load(fl)\n      infos.append(d)\n  df = pd.DataFrame(infos)\n  cols_order = df.columns if cols_order is None else cols_order\n  return df[cols_order]"
  },
  {
    "objectID": "sections/database_dists.html#ordenando-colunas",
    "href": "sections/database_dists.html#ordenando-colunas",
    "title": "Distâncias",
    "section": "Ordenando colunas",
    "text": "Ordenando colunas\n\ncols_order = [\n  'status', 'origem', 'destino', 'origin_addresses', 'destination_addresses',\n  'origem_latitude', 'origem_longitude', 'destino_latitude', 'destino_longitude',\n  'hour', 'departure_time', 'mode', 'traffic_model',\n  'distance (value)', 'distance (text)',\n  'duration (value)', 'duration (text)',\n  'duration_in_traffic (value)', 'duration_in_traffic (text)',\n  'count',\n]"
  },
  {
    "objectID": "sections/database_dists.html#tabela-resultante",
    "href": "sections/database_dists.html#tabela-resultante",
    "title": "Distâncias",
    "section": "Tabela resultante",
    "text": "Tabela resultante\n\npath_gmaps = get_path('LOCALIDADES', f'google_maps/')\npath_routes = get_path('GESTANTES', f'gmaps/routes.csv.gzip')\ndf_files = read_data_to_df(path_gmaps, cols_order=cols_order)\n# df_files = pd.read_csv(path_routes)\ndf_files\n\n\n\n\n\n  \n    \n      \n      status\n      origem\n      destino\n      origin_addresses\n      destination_addresses\n      origem_latitude\n      origem_longitude\n      destino_latitude\n      destino_longitude\n      hour\n      departure_time\n      mode\n      traffic_model\n      distance (value)\n      distance (text)\n      duration (value)\n      duration (text)\n      duration_in_traffic (value)\n      duration_in_traffic (text)\n      count\n    \n  \n  \n    \n      0\n      ZERO_RESULTS\n      292070.0\n      291360.0\n      -14.1035,-39.0137\n      -14.793,-39.046\n      -14.1035\n      -39.0137\n      -14.7930\n      -39.0460\n      6.0\n      2022-11-07 06:00:00\n      transit\n      best_guess\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      678.0\n    \n    \n      1\n      ZERO_RESULTS\n      290515.0\n      293330.0\n      -14.3347,-40.9175\n      -14.8615,-40.8442\n      -14.3347\n      -40.9175\n      -14.8615\n      -40.8442\n      6.0\n      2022-11-07 06:00:00\n      transit\n      best_guess\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      883.0\n    \n    \n      2\n      OK\n      330330.0\n      330490.0\n      R. Maria Bregua, 37 - São Lourenço, Niterói - ...\n      R. Temistocles de Almeida, 134 - Camarão, São ...\n      -22.8832\n      -43.1034\n      -22.8268\n      -43.0634\n      6.0\n      2022-11-07 06:00:00\n      transit\n      best_guess\n      9900.0\n      9,9 km\n      2271.0\n      38 minutos\n      NaN\n      NaN\n      204.0\n    \n    \n      3\n      OK\n      330330.0\n      330185.0\n      R. Maria Bregua, 37 - São Lourenço, Niterói - ...\n      R. João da Silva Maia, 14 - Parque Santo Anton...\n      -22.8832\n      -43.1034\n      -22.5347\n      -42.9895\n      6.0\n      2022-11-07 06:00:00\n      transit\n      best_guess\n      63545.0\n      63,5 km\n      12388.0\n      3 horas 26 minutos\n      NaN\n      NaN\n      2.0\n    \n    \n      4\n      OK\n      330330.0\n      330023.0\n      R. Maria Bregua, 37 - São Lourenço, Niterói - ...\n      Av. José Bento Ribeiro Dantas, 842, Búzios - R...\n      -22.8832\n      -43.1034\n      -22.7528\n      -41.8846\n      6.0\n      2022-11-07 06:00:00\n      transit\n      best_guess\n      171243.0\n      171 km\n      28870.0\n      8 horas 1 minuto\n      NaN\n      NaN\n      1.0\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      65933\n      OK\n      291810.0\n      280290.0\n      R. Delmiro Gouveia, 109 - Centro, Jeremoabo - ...\n      R. Cap. José Ferreira Neto, 244 - Centro, Itab...\n      -10.0685\n      -38.3471\n      -10.6826\n      -37.4273\n      18.0\n      2022-11-07 18:00:00\n      driving\n      pessimistic\n      144835.0\n      145 km\n      7519.0\n      2 horas 5 minutos\n      7908.0\n      2 horas 12 minutos\n      6.0\n    \n    \n      65934\n      OK\n      431075.0\n      431310.0\n      Av. Gen. Osório, 20, Ivorá - RS, 98160-000, Br...\n      R. Raimundo Aléssio, 325 - Nova Palma, RS, 972...\n      -29.5232\n      -53.5842\n      -29.4710\n      -53.4689\n      18.0\n      2022-11-07 18:00:00\n      driving\n      pessimistic\n      19878.0\n      19,9 km\n      2253.0\n      38 minutos\n      2253.0\n      38 minutos\n      3.0\n    \n    \n      65935\n      OK\n      431075.0\n      431490.0\n      Av. Gen. Osório, 20, Ivorá - RS, 98160-000, Br...\n      R. Casemiro de Abreu, 193 - Boa Vista, Porto A...\n      -29.5232\n      -53.5842\n      -30.0318\n      -51.2065\n      18.0\n      2022-11-07 18:00:00\n      driving\n      pessimistic\n      285093.0\n      285 km\n      14776.0\n      4 horas 6 minutos\n      16624.0\n      4 horas 37 minutos\n      4.0\n    \n    \n      65936\n      OK\n      431075.0\n      431690.0\n      Av. Gen. Osório, 20, Ivorá - RS, 98160-000, Br...\n      R. Conde de Porto Alegre, 365 - Bonfim, Santa ...\n      -29.5232\n      -53.5842\n      -29.6868\n      -53.8149\n      18.0\n      2022-11-07 18:00:00\n      driving\n      pessimistic\n      48429.0\n      48,4 km\n      3566.0\n      59 minutos\n      4101.0\n      1 hora 8 minutos\n      53.0\n    \n    \n      65937\n      OK\n      431849.0\n      432180.0\n      Rua Linha da Barra Zona Rural, São José do Inh...\n      R. Padre Cacique, 692 - Centro, Três de Maio -...\n      -27.7251\n      -54.1275\n      -27.7800\n      -54.2357\n      18.0\n      2022-11-07 18:00:00\n      driving\n      pessimistic\n      19250.0\n      19,2 km\n      1365.0\n      23 minutos\n      1506.0\n      25 minutos\n      116.0\n    \n  \n\n65938 rows × 20 columns\n\n\n\n\ndf_files['status'].value_counts()\n\nOK              62991\nZERO_RESULTS     2943\nApiError            4\nName: status, dtype: int64\n\n\n\nExportando\n\nCSV\n\ndf_files.to_csv(path_routes, index=False)\n\n\n\nXLSX\n\n# path_routes = get_path('GESTANTES', f'gmaps/routes.xlsx')\n# df_files.to_excel(path_routes, index=False)"
  },
  {
    "objectID": "sections/database_dists.html#driving-pessimistic-in-traffic-at-6pm-x-transit-at-12pm",
    "href": "sections/database_dists.html#driving-pessimistic-in-traffic-at-6pm-x-transit-at-12pm",
    "title": "Distâncias",
    "section": "driving pessimistic in traffic at 6pm x transit at 12pm",
    "text": "driving pessimistic in traffic at 6pm x transit at 12pm\n\nConsultar duração\n\ndef get_duration(df, origem, destino, mode, traffic_model, hour, in_traffic=True):\n  col_idx = int(in_traffic)\n  col_duration = ['duration (value)', 'duration_in_traffic (value)'][col_idx]\n  duration = df[\n    (\n      df['origem'] == origem\n    ) & (\n      df['destino'] == destino\n    ) & (\n      df['mode'] == mode\n    ) & (\n      df['traffic_model'] == traffic_model\n    ) & (\n      df['hour'] == hour\n    )\n  ]\n  duration = list(duration[col_duration])[0]\n  return duration\n\n\n\nComparação\n\ndef hours_comparison(df):\n  cols_route = ['origem', 'destino', 'distance (value)']\n  df_select = df[(\n      (df['mode'] == 'driving') & (df['traffic_model'] == 'pessimistic') & (df['hour'] == 18)\n    ) | (\n      (df['mode'] == 'transit') & (df['traffic_model'] == 'best_guess') & (df['hour'] == 6)\n  )]\n  for col in df_select.columns:\n    if col not in {'status', 'mode', 'traffic_model', 'late_pct'}:\n      df_select.loc[:, col] = df_select[col].apply(lambda x: x if pd.isna(x) else int(x))\n  df_route = df_select[cols_route].groupby(cols_route, as_index=False).sum()\n  ratios = list()\n  for row in tqdm(df_route.to_dict(orient='records')):\n    try:\n      driving = get_duration(df_select, row['origem'], row['destino'], 'driving', 'pessimistic', 18, in_traffic=True)\n      print(driving)\n      transit = get_duration(df_select, row['origem'], row['destino'], 'transit', 'best_guess', 6, in_traffic=False)\n      ratio = (transit - driving) / driving\n    except:\n      ratio = np.nan\n    ratios.append(ratio)\n  df_route['ratio'] = ratios\n  df_route = df_route.sort_values(cols_route).reset_index(drop=True)\n  return df_route#.dropna()\n\n\ndf_vs = hours_comparison(df_inv.dropna(subset=['duration (value)']))\ndf_vs\n\n/var/folders/9d/972tfrtd01z2hhl836z97zdr0000gn/T/ipykernel_55860/3508088823.py:10: SettingWithCopyWarning:\n\n\nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n\n/var/folders/9d/972tfrtd01z2hhl836z97zdr0000gn/T/ipykernel_55860/3508088823.py:10: FutureWarning:\n\nIn a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`\n\n100%|██████████| 58352/58352 [00:00<00:00, 1364711.67it/s]\n\n\n\n\n\n\n  \n    \n      \n      origem\n      destino\n      distance (value)\n      ratio\n    \n  \n  \n    \n      0\n      110001\n      110002\n      330612\n      NaN\n    \n    \n      1\n      110001\n      110004\n      109937\n      NaN\n    \n    \n      2\n      110001\n      110009\n      143458\n      NaN\n    \n    \n      3\n      110001\n      110012\n      153453\n      NaN\n    \n    \n      4\n      110001\n      110013\n      389010\n      NaN\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      58347\n      530010\n      521760\n      57271\n      NaN\n    \n    \n      58348\n      530010\n      521830\n      311269\n      NaN\n    \n    \n      58349\n      530010\n      521975\n      52771\n      NaN\n    \n    \n      58350\n      530010\n      522068\n      256309\n      NaN\n    \n    \n      58351\n      530010\n      522200\n      163256\n      NaN\n    \n  \n\n58352 rows × 4 columns\n\n\n\n\n\nHistograma\n\npx.histogram(df_vs, x='ratio')\n\n\n                                                \n\n\n\n\nDensity contour\n\nfig = px.density_contour(df_vs, x='ratio', y='distance (value)', marginal_x=\"histogram\", marginal_y=\"histogram\") #log_x=True, log_y=True) # , opacity=.25\nfig.show()"
  },
  {
    "objectID": "sections/database_dists.html#diferença-com-tráfego",
    "href": "sections/database_dists.html#diferença-com-tráfego",
    "title": "Distâncias",
    "section": "% diferença com tráfego",
    "text": "% diferença com tráfego\n\nTabela com atraso percentual\n\ntraffic = 'duration_in_traffic (value)'\nnormal = 'duration (value)'\ndf_inv['late_pct'] = (df_inv[traffic] - df_inv[normal]) / df_inv[normal]\ndf_inv\n\n\n\n\n\n  \n    \n      \n      status\n      count\n      origem\n      destino\n      hour\n      mode\n      traffic_model\n      distance (value)\n      duration (value)\n      duration_in_traffic (value)\n      late_pct\n    \n  \n  \n    \n      0\n      OK\n      2.0\n      110001.0\n      110002.0\n      18.0\n      driving\n      pessimistic\n      330612.0\n      18065.0\n      20190.0\n      0.117631\n    \n    \n      1\n      OK\n      12.0\n      110001.0\n      110004.0\n      18.0\n      driving\n      pessimistic\n      109937.0\n      6238.0\n      6757.0\n      0.083200\n    \n    \n      2\n      OK\n      2.0\n      110001.0\n      110009.0\n      18.0\n      driving\n      pessimistic\n      143458.0\n      8228.0\n      10193.0\n      0.238819\n    \n    \n      3\n      OK\n      26.0\n      110001.0\n      110012.0\n      18.0\n      driving\n      pessimistic\n      153453.0\n      8366.0\n      9749.0\n      0.165312\n    \n    \n      4\n      OK\n      3.0\n      110001.0\n      110013.0\n      18.0\n      driving\n      pessimistic\n      389010.0\n      21686.0\n      23707.0\n      0.093194\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      65933\n      OK\n      2.0\n      530010.0\n      522200.0\n      18.0\n      driving\n      pessimistic\n      163256.0\n      8350.0\n      13232.0\n      0.584671\n    \n    \n      65934\n      ApiError\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n    \n    \n      65935\n      ApiError\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n    \n    \n      65936\n      ApiError\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n    \n    \n      65937\n      ApiError\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n    \n  \n\n65938 rows × 11 columns\n\n\n\n\n\nHistograma\ntraffic = normal + normal * late_pct\n\npx.histogram(df_inv, x='late_pct', color='hour', barmode='overlay', opacity=.5)"
  },
  {
    "objectID": "sections/database_dists.html#comparação-entre-horas",
    "href": "sections/database_dists.html#comparação-entre-horas",
    "title": "Distâncias",
    "section": "Comparação entre horas",
    "text": "Comparação entre horas\n\nConsultar duração\n\ndef get_duration(df, origem, destino, hour, col):\n  return list(df[\n    (\n      df['origem'] == origem\n    ) & (\n      df['destino'] == destino\n    ) & (\n      df['hour'] == hour\n    )\n  ][col])[0]\n\n\n\nTabela de comparação entre horários\n\ndef hours_comparison(df, i=0):\n  cols_route = ['origem', 'destino']\n  cols_duration = ['duration_in_traffic (value)', 'duration (value)']\n  # hours = list(df_inv['hour'].unique())\n  df_route = df[cols_route].groupby(cols_route, as_index=False).sum()\n  df_route_soon = df_route.copy()\n  df_route_late = df_route.copy()\n  df_route_soon['time'] = 'soon (6am)'\n  df_route_late['time'] = 'late (6pm)'\n  col_val_soon = list()\n  col_val_late = list()\n  for row in df_route.to_dict(orient='records'):\n    dur_6am = get_duration(df, row['origem'], row['destino'], 6, cols_duration[i])\n    dur_12h = get_duration(df, row['origem'], row['destino'], 12, cols_duration[i])\n    dur_6pm = get_duration(df, row['origem'], row['destino'], 18, cols_duration[i])\n    soon = (dur_12h - dur_6am) / dur_12h\n    late = (dur_6pm - dur_12h) / dur_12h\n    col_val_soon.append(soon)\n    col_val_late.append(late)\n  df_route_soon['diff_perct'] = col_val_soon\n  df_route_late['diff_perct'] = col_val_late\n  df_comp = pd.concat([df_route_soon, df_route_late])\n  df_comp = df_comp.sort_values(cols_route).reset_index(drop=True)\n  return df_comp\n\n\n# df_comp_traffic = hours_comparison(df_inv, 0)\n# df_comp_normal = hours_comparison(df_inv, 1)\n\n\n\nHistograma (tráfego)\n6(a|p)m = 12pm * diff_perct\n\n# px.histogram(df_comp_traffic, x='diff_perct', color='time', barmode='overlay', opacity=.5)\n\n\n\nHistograma (normal)\n6(a|p)m = 12pm + 12pm * diff_perct\n\n# px.histogram(df_comp_normal, x='diff_perct', color='time', barmode='overlay', opacity=.5)"
  },
  {
    "objectID": "sections/database_dists.html#comparação-com-osm",
    "href": "sections/database_dists.html#comparação-com-osm",
    "title": "Distâncias",
    "section": "Comparação com OSM",
    "text": "Comparação com OSM\n\nLendo tabela OSM\n\npath_dist = get_path('DISTANCIAS', 'distancias.jay')\ndf_osm = dt.fread(path_dist)\ndf_osm = df_osm.to_pandas()\ndf_osm\n\n\n\n\n\n  \n    \n      \n      origem\n      destino\n      distancia\n      tempo\n    \n  \n  \n    \n      0\n      110001\n      110001\n      0.000000\n      0.000000\n    \n    \n      1\n      110001\n      110002\n      309.050000\n      6.169056\n    \n    \n      2\n      110001\n      110003\n      399.499700\n      6.289056\n    \n    \n      3\n      110001\n      110004\n      81.201103\n      1.917750\n    \n    \n      4\n      110001\n      110005\n      391.704300\n      6.136361\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      31024895\n      530010\n      522200\n      161.728900\n      2.356000\n    \n    \n      31024896\n      530010\n      522205\n      382.708800\n      5.479556\n    \n    \n      31024897\n      530010\n      522220\n      161.603400\n      2.248944\n    \n    \n      31024898\n      530010\n      522230\n      190.000900\n      3.216083\n    \n    \n      31024899\n      530010\n      530010\n      0.000000\n      0.000000\n    \n  \n\n31024900 rows × 4 columns\n\n\n\n\n\nMesclando tabelas\nNormalizando o tempo entre elas (ambas em segundos).\n\ndf_dist = pd.merge(df_inv, df_osm, how='left', on=['origem', 'destino'])\ndf_dist['tempo'] = df_dist['tempo'] * 60 * 60\ndf_dist\n\nKeyboardInterrupt: \n\n\n\n\nColuna da diferença percentual\nOSM em relação ao GMAPS.\n\nreference = ['duration_in_traffic (value)', 'duration (value)']\ncompare = 'tempo'\ndf_dist['diff_pct_traffic'] = (df_dist[reference[0]] - df_dist[compare]) / df_dist[compare]\ndf_dist['diff_pct_normal'] = (df_dist[reference[1]] - df_dist[compare]) / df_dist[compare]\ndf_dist\n\n\n\n\n\n  \n    \n      \n      status\n      count\n      origem\n      destino\n      hour\n      mode\n      traffic_model\n      distance (value)\n      duration (value)\n      duration_in_traffic (value)\n      late_pct\n      distancia\n      tempo\n      diff_pct_traffic\n      diff_pct_normal\n    \n  \n  \n    \n      0\n      OK\n      2.0\n      110001.0\n      110002.0\n      18.0\n      driving\n      pessimistic\n      330612.0\n      18065.0\n      20190.0\n      0.117631\n      309.050000\n      22208.6\n      -0.090893\n      -0.186576\n    \n    \n      1\n      OK\n      12.0\n      110001.0\n      110004.0\n      18.0\n      driving\n      pessimistic\n      109937.0\n      6238.0\n      6757.0\n      0.083200\n      81.201103\n      6903.9\n      -0.021278\n      -0.096453\n    \n    \n      2\n      OK\n      2.0\n      110001.0\n      110009.0\n      18.0\n      driving\n      pessimistic\n      143458.0\n      8228.0\n      10193.0\n      0.238819\n      145.678200\n      8445.6\n      0.206901\n      -0.025765\n    \n    \n      3\n      OK\n      26.0\n      110001.0\n      110012.0\n      18.0\n      driving\n      pessimistic\n      153453.0\n      8366.0\n      9749.0\n      0.165312\n      130.770500\n      9172.1\n      0.062897\n      -0.087886\n    \n    \n      4\n      OK\n      3.0\n      110001.0\n      110013.0\n      18.0\n      driving\n      pessimistic\n      389010.0\n      21686.0\n      23707.0\n      0.093194\n      357.511000\n      25670.4\n      -0.076485\n      -0.155214\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      65933\n      OK\n      2.0\n      530010.0\n      522200.0\n      18.0\n      driving\n      pessimistic\n      163256.0\n      8350.0\n      13232.0\n      0.584671\n      161.728900\n      8481.6\n      0.560083\n      -0.015516\n    \n    \n      65934\n      ApiError\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n    \n    \n      65935\n      ApiError\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n    \n    \n      65936\n      ApiError\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n    \n    \n      65937\n      ApiError\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n      NaN\n    \n  \n\n65938 rows × 15 columns\n\n\n\n\n\nHistograma (tráfego)\ngmaps = osm + osm * diff_pct_traffic\n\npx.histogram(df_dist, x='diff_pct_traffic')\n\n\n                                                \n\n\n\n\nHistograma (normal)\ngmaps = osm + osm * diff_pct_normal\n\npx.histogram(df_dist, x='diff_pct_normal')"
  },
  {
    "objectID": "sections/database_dists.html#formatando-osm",
    "href": "sections/database_dists.html#formatando-osm",
    "title": "Distâncias",
    "section": "Formatando OSM",
    "text": "Formatando OSM\n\nCarregando tabela\n\npath_osm = get_path('DISTANCIAS', 'distancias.jay')\ndf_osm = dt.fread(path_osm)\ndf_osm\n\n\n\n  \n  \n    origemdestinodistanciatempo\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000100\n    1110001110002309.056.16906\n    2110001110003399.56.28906\n    311000111000481.20111.91775\n    4110001110005391.7046.13636\n    5110001110006353.4175.53989\n    6110001110007313.5926.18117\n    7110001110008326.9835.34175\n    8110001110009145.6782.346\n    9110001110010649.54513.405\n    10110001110011214.1253.83481\n    11110001110012130.772.54781\n    12110001110013357.5117.13067\n    1311000111001460.21031.02275\n    14110001110015172.9263.18425\n    ⋮⋮⋮⋮⋮\n    31,024,895530010522200161.7292.356\n    31,024,896530010522205382.7095.47956\n    31,024,897530010522220161.6032.24894\n    31,024,898530010522230190.0013.21608\n    31,024,89953001053001000\n  \n  \n  \n    31,024,900 rows × 4 columns\n  \n\n\n\n\n\nFiltrando pelo SIH\n\npath_sih = get_path('SIH', 'sih.jay')\ndf_sih = dt.fread(path_sih)\ndf_sih = df_sih[:, ['origem', 'destino']]\ndf_sih = group_cols(df_sih, ['origem', 'destino'])\ndf_osm.key = ['origem', 'destino']\ndf_osm = df_sih[:, :, join(df_osm)]\ndf_osm\n\n\n\n  \n  \n    origemdestinocountdistanciatempo\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    01100011100012000\n    11100011100022309.056.16906\n    21100011100041381.20111.91775\n    31100011100061353.4175.53989\n    41100011100091145.6782.346\n    511000111001215130.772.54781\n    61100011100132357.5117.13067\n    71100011100151172.9263.18425\n    81100011100183114.0611.87139\n    911000111002029505.8569.16514\n    10110001110025396.60651.98553\n    111100011100282348.60990.835667\n    121100011100302297.4554.71864\n    131100011101492217.3553.67378\n    141100011101501153.3372.8455\n    ⋮⋮⋮⋮⋮⋮\n    76,5335300105220201515.6686.85197\n    76,5345300105220451207.4133.05281\n    76,5355300105220683255.5553.338\n    76,5365300105222002161.7292.356\n    76,53753001053001042900\n  \n  \n  \n    76,538 rows × 5 columns\n  \n\n\n\n\n\nConvertendo pra minutos\n\ndf_osm[:, dt.update(tempo = f.tempo * 60)]\ndf_osm\n\n\n\n  \n  \n    origemdestinocountdistanciatempo\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    01100011100012000\n    11100011100022309.05370.143\n    21100011100041381.2011115.065\n    31100011100061353.417332.393\n    41100011100091145.678140.76\n    511000111001215130.77152.868\n    61100011100132357.511427.84\n    71100011100151172.926191.055\n    81100011100183114.061112.283\n    911000111002029505.856549.908\n    10110001110025396.6065119.132\n    111100011100282348.609950.14\n    121100011100302297.455283.118\n    131100011101492217.355220.427\n    141100011101501153.337170.73\n    ⋮⋮⋮⋮⋮⋮\n    76,5335300105220201515.668411.118\n    76,5345300105220451207.413183.168\n    76,5355300105220683255.555200.28\n    76,5365300105222002161.729141.36\n    76,53753001053001042900\n  \n  \n  \n    76,538 rows × 5 columns\n  \n\n\n\n\n\nRenomeando colunas\n\ndf_osm.names = {\n  'distancia': 'km (osm)',\n  'tempo': 'min (osm)'}\ndf_osm\n\n\n\n  \n  \n    origemdestinocountkm (osm)min (osm)\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    01100011100012000\n    11100011100022309.05370.143\n    21100011100041381.2011115.065\n    31100011100061353.417332.393\n    41100011100091145.678140.76\n    511000111001215130.77152.868\n    61100011100132357.511427.84\n    71100011100151172.926191.055\n    81100011100183114.061112.283\n    911000111002029505.856549.908\n    10110001110025396.6065119.132\n    111100011100282348.609950.14\n    121100011100302297.455283.118\n    131100011101492217.355220.427\n    141100011101501153.337170.73\n    ⋮⋮⋮⋮⋮⋮\n    76,5335300105220201515.668411.118\n    76,5345300105220451207.413183.168\n    76,5355300105220683255.555200.28\n    76,5365300105222002161.729141.36\n    76,53753001053001042900\n  \n  \n  \n    76,538 rows × 5 columns"
  },
  {
    "objectID": "sections/database_dists.html#formatando-gmaps",
    "href": "sections/database_dists.html#formatando-gmaps",
    "title": "Distâncias",
    "section": "Formatando GMaps",
    "text": "Formatando GMaps\n\ncols_exp = [\n  'origem', 'destino',\n  'mode', 'traffic_model', 'hour',\n  'distance (value)', 'duration (value)', 'duration_in_traffic (value)'\n]\n\n\ndf_exp = df_inv[cols_exp]\ndf_exp = df_exp[(\n    (df_exp['mode'] == 'driving') & (df_exp['traffic_model'] == 'pessimistic') & (df_exp['hour'] == 18)\n  # ) | (\n  #   (df_exp['mode'] == 'transit') & (df_exp['traffic_model'] == 'best_guess') & (df_exp['hour'] == 6)\n)]\ndf_exp = df_exp.fillna(0)\ndf_exp = df_exp[cols_exp[:2] + cols_exp[-3:]]\ndf_exp = df_exp.rename(columns={\n  'distance (value)': 'km (gmaps)',\n  'duration (value)': 'min (gmaps)',\n  'duration_in_traffic (value)': 'min (gmaps+traffic)',})\ndf_exp['km (gmaps)'] = df_exp['km (gmaps)'] / 1000\ndf_exp['min (gmaps)'] = df_exp['min (gmaps)'] / 60\ndf_exp['min (gmaps+traffic)'] = df_exp['min (gmaps+traffic)'] / 60\ndf_exp\n\n\n\n\n\n  \n    \n      \n      origem\n      destino\n      km (gmaps)\n      min (gmaps)\n      min (gmaps+traffic)\n    \n  \n  \n    \n      0\n      110001.0\n      110002.0\n      330.612\n      301.083333\n      336.500000\n    \n    \n      1\n      110001.0\n      110004.0\n      109.937\n      103.966667\n      112.616667\n    \n    \n      2\n      110001.0\n      110009.0\n      143.458\n      137.133333\n      169.883333\n    \n    \n      3\n      110001.0\n      110012.0\n      153.453\n      139.433333\n      162.483333\n    \n    \n      4\n      110001.0\n      110013.0\n      389.010\n      361.433333\n      395.116667\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      65929\n      530010.0\n      521760.0\n      57.271\n      55.383333\n      92.050000\n    \n    \n      65930\n      530010.0\n      521830.0\n      311.269\n      248.583333\n      300.350000\n    \n    \n      65931\n      530010.0\n      521975.0\n      52.771\n      46.666667\n      86.366667\n    \n    \n      65932\n      530010.0\n      522068.0\n      256.309\n      202.433333\n      249.933333\n    \n    \n      65933\n      530010.0\n      522200.0\n      163.256\n      139.166667\n      220.533333\n    \n  \n\n57925 rows × 5 columns\n\n\n\n\n# durations = list()\n# for dur, dur_trf in zip(df_exp['duration (value)'], df_exp['duration_in_traffic (value)']):\n#   durations.append(max(dur, dur_trf))\n# distances = df_exp['distance (value)']\n\n\n# df_exp = df_exp.loc[:, df_exp.columns[:-3]]\n# df_exp['duration'] = pd.Series(durations) / 60\n# df_exp['distance'] = pd.Series(distances) / 1000\n# df_exp"
  },
  {
    "objectID": "sections/database_dists.html#merge",
    "href": "sections/database_dists.html#merge",
    "title": "Distâncias",
    "section": "Merge",
    "text": "Merge\n\nf_exp = dt.Frame(df_exp)\nf_exp\n\n\n\n  \n  \n    origemdestinokm (gmaps)min (gmaps)min (gmaps+traffic)\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0110001110002330.612301.083336.5\n    1110001110004109.937103.967112.617\n    2110001110009143.458137.133169.883\n    3110001110012153.453139.433162.483\n    4110001110013389.01361.433395.117\n    5110001110018112.205105.6113.25\n    6110001110020527.971462.8509.1\n    7110001110025119.305106124.383\n    811000111002846.53846.652.3667\n    9110001110030295.573249.183261.767\n    10110001110149220.716191.867204.017\n    111100012202902946.822287.482470.05\n    12110002110004283.797252.033274.217\n    1311000211001195.51280.133386.1333\n    14110002110012181.415167.483183.75\n    ⋮⋮⋮⋮⋮⋮\n    57,92053001052176057.27155.383392.05\n    57,921530010521830311.269248.583300.35\n    57,92253001052197552.77146.666786.3667\n    57,923530010522068256.309202.433249.933\n    57,924530010522200163.256139.167220.533\n  \n  \n  \n    57,925 rows × 5 columns\n  \n\n\n\n\nf_exp.key = ['origem', 'destino']\ndf_dst = df_osm[:, :, join(f_exp)]\ndf_dst\n\n\n\n  \n  \n    origemdestinocountkm (osm)min (osm)km (gmaps)min (gmaps)min (gmaps+traffic)\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    01100011100012000NANANA\n    11100011100022309.05370.143330.612301.083336.5\n    21100011100041381.2011115.065109.937103.967112.617\n    31100011100061353.417332.393NANANA\n    41100011100091145.678140.76143.458137.133169.883\n    511000111001215130.77152.868153.453139.433162.483\n    61100011100132357.511427.84389.01361.433395.117\n    71100011100151172.926191.055NANANA\n    81100011100183114.061112.283112.205105.6113.25\n    911000111002029505.856549.908527.971462.8509.1\n    10110001110025396.6065119.132119.305106124.383\n    111100011100282348.609950.1446.53846.652.3667\n    121100011100302297.455283.118295.573249.183261.767\n    131100011101492217.355220.427220.716191.867204.017\n    141100011101501153.337170.73NANANA\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    76,5335300105220201515.668411.118NANANA\n    76,5345300105220451207.413183.168NANANA\n    76,5355300105220683255.555200.28256.309202.433249.933\n    76,5365300105222002161.729141.36163.256139.167220.533\n    76,53753001053001042900NANANA\n  \n  \n  \n    76,538 rows × 8 columns"
  },
  {
    "objectID": "sections/database_dists.html#exportando-1",
    "href": "sections/database_dists.html#exportando-1",
    "title": "Distâncias",
    "section": "Exportando",
    "text": "Exportando\n\npath_dst = get_path('GESTANTES', f'gmaps/routes_osm_gmaps.csv.gzip')\ndf_dst.to_csv(path_dst)#, index=False)"
  },
  {
    "objectID": "sections/database_indicadores.html",
    "href": "sections/database_indicadores.html",
    "title": "Indicadores",
    "section": "",
    "text": "import numpy as np\nimport pandas as pd\nfrom tqdm import tqdm\nfrom os import listdir\nfrom datatable import dt, f, by\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.common.keys import Keys\nfrom utils import get_path, data_load"
  },
  {
    "objectID": "sections/database_indicadores.html#shape-de-cada-tabela",
    "href": "sections/database_indicadores.html#shape-de-cada-tabela",
    "title": "Indicadores",
    "section": "Shape de cada tabela",
    "text": "Shape de cada tabela\n(Linhas, Colunas)\n\npath_dir = get_path('INDICADORES', '')\nfiles = [path_dir+pth for pth in listdir(path_dir) if pth[-3:] == 'csv']\ndfs = [pd.read_csv(fl, encoding='latin1', sep=';') for fl in files]\nfor df in dfs: print(df.shape)\n\n(524, 184)\n(595, 184)\n(673, 184)\n(511, 184)\n(645, 184)\n(516, 184)\n(528, 184)\n(695, 184)\n(734, 184)\n(587, 184)"
  },
  {
    "objectID": "sections/database_indicadores.html#concatenando-tabelas",
    "href": "sections/database_indicadores.html#concatenando-tabelas",
    "title": "Indicadores",
    "section": "Concatenando tabelas",
    "text": "Concatenando tabelas\nConcatenação das tabelas em uma\n\ndf_indc = pd.concat(dfs)\ndf_indc\n\n\n\n\n\n  \n    \n      \n      CÓDIGO\n      Tipo Localidade\n      UF\n      CIR\n      Município\n      Número de municípios na Região de Saúde\n      Município de capital\n      Municípios que fazem parte da zona de fronteira - IBGE\n      Municípios que fazem parte da faixa de fronteira - IBGE\n      Municípios que fazem parte da fronteira estadual\n      ...\n      Porcentual de Despesas com Investimentos pelo Total de Despesas em Saúde (2014)\n      Porcentual de Tranferências SUS pelo Total de Despesas em Saúde (2014)\n      Porcentual de Recursos Próprios em Saúde - EC29 (2014)\n      Recursos de Transferências SUS por habitante (2014)\n      Despesas com Recursos Próprios em Saúde por habitante (2014)\n      Cobertura populacional estimada pelas equipes de Atenção Básica (2014)\n      % de população beneficiária de planos de saúde (Setembro/2015)\n      Porcentual de famílias beneficiárias do Programa Bolsa Família (2014)\n      Porcentual de população beneficiária do Programa Bolsa Família (2014)\n      Unnamed: 183\n    \n  \n  \n    \n      0\n      15.001\n      REGSAU\n      -\n      Araguaia\n      -\n      15\n      0\n      0\n      0\n      7\n      ...\n      8,53\n      54,61\n      18,83\n      213,11\n      161,66\n      63,90\n      5,15\n      34,43\n      31,59\n      NaN\n    \n    \n      1\n      15.002\n      REGSAU\n      -\n      Baixo Amazonas\n      -\n      14\n      0\n      3\n      5\n      5\n      ...\n      10,61\n      50,82\n      20,77\n      204,22\n      159,30\n      42,20\n      6,18\n      49,15\n      52,45\n      NaN\n    \n    \n      2\n      15.003\n      REGSAU\n      -\n      Carajás\n      -\n      17\n      0\n      0\n      0\n      9\n      ...\n      9,44\n      26,16\n      23,79\n      177,49\n      455,16\n      52,23\n      22,06\n      34,18\n      35,01\n      NaN\n    \n    \n      3\n      15.004\n      REGSAU\n      -\n      Lago de Tucuruí\n      -\n      6\n      0\n      0\n      0\n      0\n      ...\n      8,08\n      53,90\n      20,08\n      208,23\n      166,48\n      49,99\n      3,07\n      45,30\n      39,86\n      NaN\n    \n    \n      4\n      15.013\n      REGSAU\n      -\n      Marajó I\n      -\n      9\n      0\n      0\n      0\n      0\n      ...\n      20,06\n      51,15\n      17,21\n      158,85\n      111,80\n      24,19\n      1,02\n      60,93\n      61,59\n      NaN\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      582\n      171.780\n      MUNIC\n      Tocantins\n      Sudeste\n      Ponte Alta do Bom Jesus\n      15\n      Não\n      Não\n      Não\n      Sim\n      ...\n      8,43\n      34,79\n      28,54\n      199,83\n      369,45\n      100\n      2,02\n      51,97\n      46,93\n      NaN\n    \n    \n      583\n      171.800\n      MUNIC\n      Tocantins\n      Sudeste\n      Porto Alegre do Tocantins\n      15\n      Não\n      Não\n      Não\n      Não\n      ...\n      10,52\n      35,89\n      19,05\n      220,42\n      386,41\n      100\n      1,15\n      52,65\n      48,82\n      NaN\n    \n    \n      584\n      171.865\n      MUNIC\n      Tocantins\n      Sudeste\n      Rio da Conceição\n      15\n      Não\n      Não\n      Não\n      Sim\n      ...\n      13,86\n      20,14\n      15,52\n      162,11\n      538,36\n      100\n      0,81\n      47,84\n      48,19\n      NaN\n    \n    \n      585\n      172.090\n      MUNIC\n      Tocantins\n      Sudeste\n      Taguatinga\n      15\n      Não\n      Não\n      Não\n      Sim\n      ...\n      0,25\n      44,17\n      33,13\n      187,31\n      292,60\n      78,25\n      26,20\n      37,30\n      41,23\n      NaN\n    \n    \n      586\n      172.093\n      MUNIC\n      Tocantins\n      Sudeste\n      Taipas do Tocantins\n      15\n      Não\n      Não\n      Não\n      Não\n      ...\n      1,73\n      13,75\n      17,79\n      80,78\n      514,21\n      100\n      0,38\n      48,24\n      56,10\n      NaN\n    \n  \n\n6008 rows × 184 columns"
  },
  {
    "objectID": "sections/database_municipios.html",
    "href": "sections/database_municipios.html",
    "title": "Municípios",
    "section": "",
    "text": "import pandas as pd\nfrom utils import get_path"
  },
  {
    "objectID": "sections/database_municipios.html#municípios",
    "href": "sections/database_municipios.html#municípios",
    "title": "Municípios",
    "section": "Municípios",
    "text": "Municípios\nFonte Municípios\n\nCarregando tabela\n\nurl_muns = 'https://raw.githubusercontent.com/kelvins/Municipios-Brasileiros/main/csv/municipios.csv'\ndf_muns = pd.read_csv(url_muns)\ndf_muns\n\n\n\n\n\n  \n    \n      \n      codigo_ibge\n      nome\n      latitude\n      longitude\n      capital\n      codigo_uf\n      siafi_id\n      ddd\n      fuso_horario\n    \n  \n  \n    \n      0\n      5200050\n      Abadia de Goiás\n      -16.75730\n      -49.4412\n      0\n      52\n      1050\n      62\n      America/Sao_Paulo\n    \n    \n      1\n      3100104\n      Abadia dos Dourados\n      -18.48310\n      -47.3916\n      0\n      31\n      4001\n      34\n      America/Sao_Paulo\n    \n    \n      2\n      5200100\n      Abadiânia\n      -16.19700\n      -48.7057\n      0\n      52\n      9201\n      62\n      America/Sao_Paulo\n    \n    \n      3\n      3100203\n      Abaeté\n      -19.15510\n      -45.4444\n      0\n      31\n      4003\n      37\n      America/Sao_Paulo\n    \n    \n      4\n      1500107\n      Abaetetuba\n      -1.72183\n      -48.8788\n      0\n      15\n      401\n      91\n      America/Sao_Paulo\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      5565\n      2933604\n      Xique-Xique\n      -10.82300\n      -42.7245\n      0\n      29\n      3971\n      74\n      America/Sao_Paulo\n    \n    \n      5566\n      2517407\n      Zabelê\n      -8.07901\n      -37.1057\n      0\n      25\n      542\n      83\n      America/Sao_Paulo\n    \n    \n      5567\n      3557154\n      Zacarias\n      -21.05060\n      -50.0552\n      0\n      35\n      2973\n      18\n      America/Sao_Paulo\n    \n    \n      5568\n      2114007\n      Zé Doca\n      -3.27014\n      -45.6553\n      0\n      21\n      1287\n      98\n      America/Sao_Paulo\n    \n    \n      5569\n      4219853\n      Zortéa\n      -27.45210\n      -51.5520\n      0\n      42\n      950\n      49\n      America/Sao_Paulo\n    \n  \n\n5570 rows × 9 columns\n\n\n\n\n\nSelecionando colunas\n\ncols_muns = [\n  'codigo_ibge',\n  'nome',\n  'capital',\n  'codigo_uf',\n  'latitude',\n  'longitude',\n]\n\n\ndf_muns = df_muns[cols_muns]\ndf_muns\n\n\n\n\n\n  \n    \n      \n      codigo_ibge\n      nome\n      capital\n      codigo_uf\n      latitude\n      longitude\n    \n  \n  \n    \n      0\n      5200050\n      Abadia de Goiás\n      0\n      52\n      -16.75730\n      -49.4412\n    \n    \n      1\n      3100104\n      Abadia dos Dourados\n      0\n      31\n      -18.48310\n      -47.3916\n    \n    \n      2\n      5200100\n      Abadiânia\n      0\n      52\n      -16.19700\n      -48.7057\n    \n    \n      3\n      3100203\n      Abaeté\n      0\n      31\n      -19.15510\n      -45.4444\n    \n    \n      4\n      1500107\n      Abaetetuba\n      0\n      15\n      -1.72183\n      -48.8788\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      5565\n      2933604\n      Xique-Xique\n      0\n      29\n      -10.82300\n      -42.7245\n    \n    \n      5566\n      2517407\n      Zabelê\n      0\n      25\n      -8.07901\n      -37.1057\n    \n    \n      5567\n      3557154\n      Zacarias\n      0\n      35\n      -21.05060\n      -50.0552\n    \n    \n      5568\n      2114007\n      Zé Doca\n      0\n      21\n      -3.27014\n      -45.6553\n    \n    \n      5569\n      4219853\n      Zortéa\n      0\n      42\n      -27.45210\n      -51.5520\n    \n  \n\n5570 rows × 6 columns"
  },
  {
    "objectID": "sections/database_municipios.html#unidades-federativas",
    "href": "sections/database_municipios.html#unidades-federativas",
    "title": "Municípios",
    "section": "Unidades Federativas",
    "text": "Unidades Federativas\nFonte Unidades Federativas\n\nCarregando tabela\n\nurl_ufs = 'https://sistemasweb.agricultura.gov.br/manuais/Manual_PGA_WS/322CodigoIBGESigladaUnidadeFeder.html'\ndf_ufs = pd.read_html(url_ufs)[0]\ndf_ufs.columns = ['codigo_uf', 'Sigla']\ndf_ufs\n\n\n\n\n\n  \n    \n      \n      codigo_uf\n      Sigla\n    \n  \n  \n    \n      0\n      11\n      RO\n    \n    \n      1\n      12\n      AC\n    \n    \n      2\n      13\n      AM\n    \n    \n      3\n      14\n      RR\n    \n    \n      4\n      15\n      PA\n    \n    \n      5\n      16\n      AP\n    \n    \n      6\n      17\n      TO\n    \n    \n      7\n      21\n      MA\n    \n    \n      8\n      22\n      PI\n    \n    \n      9\n      23\n      CE\n    \n    \n      10\n      24\n      RN\n    \n    \n      11\n      25\n      PB\n    \n    \n      12\n      26\n      PE\n    \n    \n      13\n      27\n      AL\n    \n    \n      14\n      28\n      SE\n    \n    \n      15\n      29\n      BA\n    \n    \n      16\n      31\n      MG\n    \n    \n      17\n      32\n      ES\n    \n    \n      18\n      33\n      RJ\n    \n    \n      19\n      35\n      SP\n    \n    \n      20\n      41\n      PR\n    \n    \n      21\n      42\n      SC\n    \n    \n      22\n      43\n      RS\n    \n    \n      23\n      50\n      MS\n    \n    \n      24\n      51\n      MT\n    \n    \n      25\n      52\n      GO\n    \n    \n      26\n      53\n      DF\n    \n    \n      27\n      99\n      BR"
  },
  {
    "objectID": "sections/database_municipios.html#regiões-do-brasil",
    "href": "sections/database_municipios.html#regiões-do-brasil",
    "title": "Municípios",
    "section": "Regiões do Brasil",
    "text": "Regiões do Brasil\nFonte Regiões do Brasil\n\nCarregando tabela\n\nurl_regs = 'https://www.estadosecapitaisdobrasil.com/'\ndf_regs = pd.read_html(url_regs)[0]\ndf_regs\n\n\n\n\n\n  \n    \n      \n      Bandeira\n      Estado\n      Sigla\n      Capital\n      Região\n    \n  \n  \n    \n      0\n      NaN\n      Acre\n      AC\n      Rio Branco\n      Norte\n    \n    \n      1\n      NaN\n      Alagoas\n      AL\n      Maceió\n      Nordeste\n    \n    \n      2\n      NaN\n      Amapá\n      AP\n      Macapá\n      Norte\n    \n    \n      3\n      NaN\n      Amazonas\n      AM\n      Manaus\n      Norte\n    \n    \n      4\n      NaN\n      Bahia\n      BA\n      Salvador\n      Nordeste\n    \n    \n      5\n      NaN\n      Ceará\n      CE\n      Fortaleza\n      Nordeste\n    \n    \n      6\n      NaN\n      Distrito Federal\n      DF\n      Brasília\n      Centro-Oeste\n    \n    \n      7\n      NaN\n      Espírito Santo\n      ES\n      Vitória\n      Sudeste\n    \n    \n      8\n      NaN\n      Goiás\n      GO\n      Goiânia\n      Centro-Oeste\n    \n    \n      9\n      NaN\n      Maranhão\n      MA\n      São Luís\n      Nordeste\n    \n    \n      10\n      NaN\n      Mato Grosso\n      MT\n      Cuiabá\n      Centro-Oeste\n    \n    \n      11\n      NaN\n      Mato Grosso do Sul\n      MS\n      Campo Grande\n      Centro-Oeste\n    \n    \n      12\n      NaN\n      Minas Gerais\n      MG\n      Belo Horizonte\n      Sudeste\n    \n    \n      13\n      NaN\n      Pará\n      PA\n      Belém\n      Norte\n    \n    \n      14\n      NaN\n      Paraíba\n      PB\n      João Pessoa\n      Nordeste\n    \n    \n      15\n      NaN\n      Paraná\n      PR\n      Curitiba\n      Sul\n    \n    \n      16\n      NaN\n      Pernambuco\n      PE\n      Recife\n      Nordeste\n    \n    \n      17\n      NaN\n      Piauí\n      PI\n      Teresina\n      Nordeste\n    \n    \n      18\n      NaN\n      Rio de Janeiro\n      RJ\n      Rio de Janeiro\n      Sudeste\n    \n    \n      19\n      NaN\n      Rio Grande do Norte\n      RN\n      Natal\n      Nordeste\n    \n    \n      20\n      NaN\n      Rio Grande do Sul\n      RS\n      Porto Alegre\n      Sul\n    \n    \n      21\n      NaN\n      Rondônia\n      RO\n      Porto Velho\n      Norte\n    \n    \n      22\n      NaN\n      Roraima\n      RR\n      Boa Vista\n      Norte\n    \n    \n      23\n      NaN\n      Santa Catarina\n      SC\n      Florianópolis\n      Sul\n    \n    \n      24\n      NaN\n      São Paulo\n      SP\n      São Paulo\n      Sudeste\n    \n    \n      25\n      NaN\n      Sergipe\n      SE\n      Aracaju\n      Nordeste\n    \n    \n      26\n      NaN\n      Tocantins\n      TO\n      Palmas\n      Norte\n    \n  \n\n\n\n\n\n\nSelecionando colunas\n\ncols_regs = [\n  'Sigla',\n  'Estado',\n  'Região',\n]\n\n\ndf_regs = df_regs[cols_regs]\ndf_regs\n\n\n\n\n\n  \n    \n      \n      Sigla\n      Estado\n      Região\n    \n  \n  \n    \n      0\n      AC\n      Acre\n      Norte\n    \n    \n      1\n      AL\n      Alagoas\n      Nordeste\n    \n    \n      2\n      AP\n      Amapá\n      Norte\n    \n    \n      3\n      AM\n      Amazonas\n      Norte\n    \n    \n      4\n      BA\n      Bahia\n      Nordeste\n    \n    \n      5\n      CE\n      Ceará\n      Nordeste\n    \n    \n      6\n      DF\n      Distrito Federal\n      Centro-Oeste\n    \n    \n      7\n      ES\n      Espírito Santo\n      Sudeste\n    \n    \n      8\n      GO\n      Goiás\n      Centro-Oeste\n    \n    \n      9\n      MA\n      Maranhão\n      Nordeste\n    \n    \n      10\n      MT\n      Mato Grosso\n      Centro-Oeste\n    \n    \n      11\n      MS\n      Mato Grosso do Sul\n      Centro-Oeste\n    \n    \n      12\n      MG\n      Minas Gerais\n      Sudeste\n    \n    \n      13\n      PA\n      Pará\n      Norte\n    \n    \n      14\n      PB\n      Paraíba\n      Nordeste\n    \n    \n      15\n      PR\n      Paraná\n      Sul\n    \n    \n      16\n      PE\n      Pernambuco\n      Nordeste\n    \n    \n      17\n      PI\n      Piauí\n      Nordeste\n    \n    \n      18\n      RJ\n      Rio de Janeiro\n      Sudeste\n    \n    \n      19\n      RN\n      Rio Grande do Norte\n      Nordeste\n    \n    \n      20\n      RS\n      Rio Grande do Sul\n      Sul\n    \n    \n      21\n      RO\n      Rondônia\n      Norte\n    \n    \n      22\n      RR\n      Roraima\n      Norte\n    \n    \n      23\n      SC\n      Santa Catarina\n      Sul\n    \n    \n      24\n      SP\n      São Paulo\n      Sudeste\n    \n    \n      25\n      SE\n      Sergipe\n      Nordeste\n    \n    \n      26\n      TO\n      Tocantins\n      Norte"
  },
  {
    "objectID": "sections/database_municipios.html#unindo-tabelas",
    "href": "sections/database_municipios.html#unindo-tabelas",
    "title": "Municípios",
    "section": "Unindo tabelas",
    "text": "Unindo tabelas\nMerge\n\ndf_munic = df_muns.copy()\ndf_munic['codigo_ibge'] = df_munic['codigo_ibge'].apply(lambda x: int(str(x)[:6]))\ndf_munic = df_munic.merge(df_ufs, how='left', on='codigo_uf')\ndf_munic = df_munic.merge(df_regs, how='left', on='Sigla')\ndf_munic\n\n\n\n\n\n  \n    \n      \n      codigo_ibge\n      nome\n      capital\n      codigo_uf\n      latitude\n      longitude\n      Sigla\n      Estado\n      Região\n    \n  \n  \n    \n      0\n      520005\n      Abadia de Goiás\n      0\n      52\n      -16.75730\n      -49.4412\n      GO\n      Goiás\n      Centro-Oeste\n    \n    \n      1\n      310010\n      Abadia dos Dourados\n      0\n      31\n      -18.48310\n      -47.3916\n      MG\n      Minas Gerais\n      Sudeste\n    \n    \n      2\n      520010\n      Abadiânia\n      0\n      52\n      -16.19700\n      -48.7057\n      GO\n      Goiás\n      Centro-Oeste\n    \n    \n      3\n      310020\n      Abaeté\n      0\n      31\n      -19.15510\n      -45.4444\n      MG\n      Minas Gerais\n      Sudeste\n    \n    \n      4\n      150010\n      Abaetetuba\n      0\n      15\n      -1.72183\n      -48.8788\n      PA\n      Pará\n      Norte\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      5565\n      293360\n      Xique-Xique\n      0\n      29\n      -10.82300\n      -42.7245\n      BA\n      Bahia\n      Nordeste\n    \n    \n      5566\n      251740\n      Zabelê\n      0\n      25\n      -8.07901\n      -37.1057\n      PB\n      Paraíba\n      Nordeste\n    \n    \n      5567\n      355715\n      Zacarias\n      0\n      35\n      -21.05060\n      -50.0552\n      SP\n      São Paulo\n      Sudeste\n    \n    \n      5568\n      211400\n      Zé Doca\n      0\n      21\n      -3.27014\n      -45.6553\n      MA\n      Maranhão\n      Nordeste\n    \n    \n      5569\n      421985\n      Zortéa\n      0\n      42\n      -27.45210\n      -51.5520\n      SC\n      Santa Catarina\n      Sul\n    \n  \n\n5570 rows × 9 columns"
  },
  {
    "objectID": "sections/database_municipios.html#ajustando-colunas",
    "href": "sections/database_municipios.html#ajustando-colunas",
    "title": "Municípios",
    "section": "Ajustando Colunas",
    "text": "Ajustando Colunas\n\ncols_munic = {\n  'codigo_ibge': 'cod_municipio',\n  'nome': 'nome_municipio',\n  'capital': 'capital',\n  'Sigla': 'uf',\n  'codigo_uf': 'cod_uf',\n  'Estado': 'nome_uf',\n  'Região': 'regiao',\n  'latitude': 'latitude',\n  'longitude': 'longitude',\n}\n\n\ndf_munic = df_munic[list(cols_munic)]\ndf_munic = df_munic.rename(columns=cols_munic)\ndf_munic\n\n\n\n\n\n  \n    \n      \n      cod_municipio\n      nome_municipio\n      capital\n      uf\n      cod_uf\n      nome_uf\n      regiao\n      latitude\n      longitude\n    \n  \n  \n    \n      0\n      520005\n      Abadia de Goiás\n      0\n      GO\n      52\n      Goiás\n      Centro-Oeste\n      -16.75730\n      -49.4412\n    \n    \n      1\n      310010\n      Abadia dos Dourados\n      0\n      MG\n      31\n      Minas Gerais\n      Sudeste\n      -18.48310\n      -47.3916\n    \n    \n      2\n      520010\n      Abadiânia\n      0\n      GO\n      52\n      Goiás\n      Centro-Oeste\n      -16.19700\n      -48.7057\n    \n    \n      3\n      310020\n      Abaeté\n      0\n      MG\n      31\n      Minas Gerais\n      Sudeste\n      -19.15510\n      -45.4444\n    \n    \n      4\n      150010\n      Abaetetuba\n      0\n      PA\n      15\n      Pará\n      Norte\n      -1.72183\n      -48.8788\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      5565\n      293360\n      Xique-Xique\n      0\n      BA\n      29\n      Bahia\n      Nordeste\n      -10.82300\n      -42.7245\n    \n    \n      5566\n      251740\n      Zabelê\n      0\n      PB\n      25\n      Paraíba\n      Nordeste\n      -8.07901\n      -37.1057\n    \n    \n      5567\n      355715\n      Zacarias\n      0\n      SP\n      35\n      São Paulo\n      Sudeste\n      -21.05060\n      -50.0552\n    \n    \n      5568\n      211400\n      Zé Doca\n      0\n      MA\n      21\n      Maranhão\n      Nordeste\n      -3.27014\n      -45.6553\n    \n    \n      5569\n      421985\n      Zortéa\n      0\n      SC\n      42\n      Santa Catarina\n      Sul\n      -27.45210\n      -51.5520\n    \n  \n\n5570 rows × 9 columns"
  },
  {
    "objectID": "sections/database_sih.html",
    "href": "sections/database_sih.html",
    "title": "SIH",
    "section": "",
    "text": "from utils import get_path, data_load\nfrom datatable import dt, f, by"
  },
  {
    "objectID": "sections/database_sih.html#filtro-de-colunas",
    "href": "sections/database_sih.html#filtro-de-colunas",
    "title": "SIH",
    "section": "Filtro de Colunas",
    "text": "Filtro de Colunas\n\ncols_sih = {\n  'res_codigo_adotado': 'origem',\n  'int_codigo_adotado': 'destino',\n  'CNES': 'cnes',\n  'ano_internacao': 'ano',\n  'PROC_REA': 'procedimento',\n  # 'def_procedimento_realizado': 'tipo_parto',\n  'def_idade_anos': 'idade',\n}"
  },
  {
    "objectID": "sections/database_sih.html#filtro-de-linhas",
    "href": "sections/database_sih.html#filtro-de-linhas",
    "title": "SIH",
    "section": "Filtro de Linhas",
    "text": "Filtro de Linhas\n\ndef filter_sih(df, cols, procs_partos):\n  cols = list(cols.values())[:-1]\n  cols = [c for c in cols if c in df.names]\n  df_filtered = df[\n    (\n      (f['ano'] > 2009) & (f['ano'] < 2020)\n    ) & (\n      (f['idade'] > 9) & (f['idade'] < 50)\n    ) & (\n      ((f['origem'] != None) & (f['destino'] != None))\n    ) & (\n      (f['cnes'] != None)\n    ) & (\n      (\n        f['procedimento'] == procs_partos[0]\n      ) | (\n        f['procedimento'] == procs_partos[1]\n      ) | (\n        f['procedimento'] == procs_partos[2]\n      ) | (\n        f['procedimento'] == procs_partos[3]\n      ) | (\n        f['procedimento'] == procs_partos[4]\n      ) | (\n        f['procedimento'] == procs_partos[5]\n      ) | (\n        f['procedimento'] == procs_partos[6]\n      )\n    ), cols]\n  return df_filtered\n\n\nprocs_partos = {\n  411010034: 'PARTO CESARIANO',\n  411010042: 'PARTO CESARIANO C/ LAQUEADURA TUBARINA',\n  411010026: 'PARTO CESARIANO EM GESTACAO DE ALTO RISCO',\n  310010039: 'PARTO NORMAL',\n  310010055: 'PARTO NORMAL EM CENTRO DE PARTO NORMAL (CPN)',\n  310010047: 'PARTO NORMAL EM GESTACAO DE ALTO RISCO',\n  310010012: 'ASSISTÊNCIA AO PARTO SEM DISTOCIA',\n}"
  },
  {
    "objectID": "sections/database_sih.html#carregando-tabela",
    "href": "sections/database_sih.html#carregando-tabela",
    "title": "SIH",
    "section": "Carregando tabela",
    "text": "Carregando tabela\n\n# path_zip_sih = '/Volumes/SanDisk/Databases/SIH/SIHSUS.zip'\npath_zip_sih = get_path('SIH', 'SIHSUS.zip')\n# path_zip_sih = input('Qual o caminho para o arquivo zip da base de dados SIHSUS?')\n\n\ndf_sih = data_load(path_zip_sih, cols_sih, filter_sih, procs_partos)\ndf_sih\n\n100%|██████████| 4400/4400 [23:30<00:00,  3.12it/s]  \n\n\n\n\n  \n  \n    origemdestinocnesanoprocedimentocount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000126794772010310010039141\n    11100011100012679477201041101003449\n    21100011100012679477201131001003995\n    31100011100012679477201141101003431\n    41100011100012679477201231001003973\n    51100011100012679477201241101003428\n    61100011100012679477201331001003967\n    71100011100012679477201341101003425\n    81100011100012679477201431001003946\n    91100011100012679477201441101003457\n    101100011100012679477201531001003936\n    111100011100012679477201541101003457\n    121100011100012679477201631001003947\n    131100011100012679477201641101003433\n    141100011100012679477201731001003947\n    ⋮⋮⋮⋮⋮⋮⋮\n    608,89853001053001057175152018411010034737\n    608,8995300105300105717515201841101004211\n    608,900530010530010571751520193100100391086\n    608,90153001053001057175152019411010034839\n    608,9025300105300105717515201941101004222\n  \n  \n  \n    608,903 rows × 6 columns\n  \n\n\n\nSSD Externo:\n100%|██████████| 4400/4400 [20:32<00:00, 3.57it/s]\nSSD Interno:\n100%|██████████| 4400/4400 [15:51<00:00, 4.63it/s]\nSSD Interno (c/ 7 procedimentos):\n100%|██████████| 4400/4400 [23:30<00:00, 3.12it/s]"
  },
  {
    "objectID": "sections/deslc_uf.html",
    "href": "sections/deslc_uf.html",
    "title": "Deslocamento de Gestantes",
    "section": "",
    "text": "output_counts = get_path('GESTANTES', 'contagens.csv.gzip')\n# df_counts = dt.fread(output_counts)\ndf_counts = pd.read_csv(output_counts, dtype={'identificador': str})\ndf_counts\n\n\n\n\n\n  \n    \n      \n      bienio\n      parto_normal\n      codigo\n      escala\n      nome\n      identificador\n      criticidade\n      count\n      total\n      percent\n    \n  \n  \n    \n      0\n      0\n      0\n      CO\n      regiao\n      Centro-Oeste\n      CO\n      0\n      85068\n      445888\n      19.078334\n    \n    \n      1\n      1\n      0\n      CO\n      regiao\n      Centro-Oeste\n      CO\n      0\n      100995\n      445888\n      22.650307\n    \n    \n      2\n      0\n      1\n      CO\n      regiao\n      Centro-Oeste\n      CO\n      0\n      141604\n      445888\n      31.757751\n    \n    \n      3\n      1\n      1\n      CO\n      regiao\n      Centro-Oeste\n      CO\n      0\n      118221\n      445888\n      26.513609\n    \n    \n      4\n      0\n      0\n      CO\n      regiao\n      Centro-Oeste\n      CO\n      1\n      8372\n      51491\n      16.259152\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      93060\n      1\n      0\n      SL/SC/42016/421870/2491710\n      cnes\n      NaN\n      2491710\n      2\n      59\n      207\n      28.502415\n    \n    \n      93061\n      0\n      1\n      SL/SC/42016/421870/2491710\n      cnes\n      NaN\n      2491710\n      2\n      14\n      207\n      6.763285\n    \n    \n      93062\n      1\n      1\n      SL/SC/42016/421870/2491710\n      cnes\n      NaN\n      2491710\n      2\n      125\n      207\n      60.386473\n    \n    \n      93063\n      1\n      1\n      SL/SC/42016/421870/2491710\n      cnes\n      NaN\n      2491710\n      3\n      2\n      2\n      100.000000\n    \n    \n      93064\n      1\n      1\n      SL/SC/42016/421870/2491710\n      cnes\n      NaN\n      2491710\n      4\n      2\n      2\n      100.000000\n    \n  \n\n93065 rows × 10 columns\n\n\n\n\ndf_counts[df_counts['codigo'].str.contains('/RJ')]\n\n\n\n\n\n  \n    \n      \n      bienio\n      parto_normal\n      codigo\n      escala\n      nome\n      identificador\n      criticidade\n      count\n      total\n      percent\n    \n  \n  \n    \n      530\n      0\n      0\n      SD/RJ\n      uf\n      Rio de Janeiro\n      RJ\n      0\n      31475\n      338465\n      9.299337\n    \n    \n      531\n      1\n      0\n      SD/RJ\n      uf\n      Rio de Janeiro\n      RJ\n      0\n      64571\n      338465\n      19.077600\n    \n    \n      532\n      0\n      1\n      SD/RJ\n      uf\n      Rio de Janeiro\n      RJ\n      0\n      126306\n      338465\n      37.317300\n    \n    \n      533\n      1\n      1\n      SD/RJ\n      uf\n      Rio de Janeiro\n      RJ\n      0\n      116113\n      338465\n      34.305763\n    \n    \n      534\n      0\n      0\n      SD/RJ\n      uf\n      Rio de Janeiro\n      RJ\n      1\n      7153\n      73487\n      9.733694\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      84206\n      0\n      0\n      SD/RJ/33009/330590/3584968\n      cnes\n      HOSPITAL FRANCISCO LIMONGI\n      3584968\n      0\n      4\n      49\n      8.163265\n    \n    \n      84207\n      0\n      1\n      SD/RJ/33009/330590/3584968\n      cnes\n      HOSPITAL FRANCISCO LIMONGI\n      3584968\n      0\n      39\n      49\n      79.591837\n    \n    \n      84208\n      1\n      1\n      SD/RJ/33009/330590/3584968\n      cnes\n      HOSPITAL FRANCISCO LIMONGI\n      3584968\n      0\n      6\n      49\n      12.244898\n    \n    \n      84209\n      1\n      1\n      SD/RJ/33009/330590/3584968\n      cnes\n      HOSPITAL FRANCISCO LIMONGI\n      3584968\n      1\n      1\n      1\n      100.000000\n    \n    \n      84210\n      1\n      1\n      SD/RJ/33009/330590/3584968\n      cnes\n      HOSPITAL FRANCISCO LIMONGI\n      3584968\n      2\n      1\n      1\n      100.000000\n    \n  \n\n2376 rows × 10 columns"
  },
  {
    "objectID": "sections/result_dist.html",
    "href": "sections/result_dist.html",
    "title": "Distância percorrida",
    "section": "",
    "text": "import sys\nimport numpy as np\nimport pandas as pd\nimport plotly.graph_objects as go\n\nfrom tqdm import tqdm\nfrom datatable import dt, f, by\n\nfrom itables import init_notebook_mode\ninit_notebook_mode(all_interactive=True)\n\nfrom plotly import express as px, io as pio\npd.options.plotting.backend = 'plotly'\npio.renderers.default = 'plotly_mimetype+notebook_connected'\n\nfrom utils import get_path, data_load\nsys.path.insert(0, '../')\nfrom secret import API_KEY"
  },
  {
    "objectID": "sections/result_dist.html#procedimentos",
    "href": "sections/result_dist.html#procedimentos",
    "title": "Distância percorrida",
    "section": "Procedimentos",
    "text": "Procedimentos\n\nCarregando tabela\n\npath_proc = get_path('GESTANTES', f'procs.csv.gzip')\ndf_proc = df_proc_bienio = pd.read_csv(path_proc)\n# df_proc = df_proc.fillna(0)\ndf_proc\n\n\n\n\n\n    \n      \n      bienio\n      parto_normal\n      codigo_origem\n      codigo_destino\n      origem\n      destino\n      distance (osm)\n      duration (osm)\n      distance (gmaps)\n      duration (gmaps)\n      duration_traffic (gmaps)\n      criticidade\n      capitais\n      socioecon\n      origem_latitude\n      origem_longitude\n      destino_latitude\n      destino_longitude\n      count\n    \n  Loading... (need help?)"
  },
  {
    "objectID": "sections/result_dist.html#contagens",
    "href": "sections/result_dist.html#contagens",
    "title": "Distância percorrida",
    "section": "Contagens",
    "text": "Contagens\n\nCarregando tabela\n\npath_counts = get_path('GESTANTES', 'contagens.csv.gzip')\ndf_counts = pd.read_csv(path_counts, low_memory=False)\ndf_counts\n\n\n\n\n\n    \n      \n      parto_normal\n      bienio\n      escala\n      codigo\n      identificador\n      nome\n      criticidade\n      count\n      total\n      percent\n    \n  Loading... (need help?)"
  },
  {
    "objectID": "sections/result_dist.html#média-ponderada",
    "href": "sections/result_dist.html#média-ponderada",
    "title": "Distância percorrida",
    "section": "Média ponderada",
    "text": "Média ponderada"
  },
  {
    "objectID": "sections/result_geoplot.html",
    "href": "sections/result_geoplot.html",
    "title": "Network Geoplot",
    "section": "",
    "text": "import sys\nimport numpy as np\nimport pandas as pd\nimport plotly.graph_objects as go\n\nfrom tqdm import tqdm\nfrom datatable import dt, f, by\n\nfrom itables import init_notebook_mode\ninit_notebook_mode(all_interactive=True)\n\nfrom plotly import express as px, io as pio\npd.options.plotting.backend = 'plotly'\npio.renderers.default = 'plotly_mimetype+notebook_connected'\n\nfrom utils import get_path, data_load\nsys.path.insert(0, '../')\nfrom secret import API_KEY"
  },
  {
    "objectID": "sections/result_geoplot.html#procedimentos",
    "href": "sections/result_geoplot.html#procedimentos",
    "title": "Network Geoplot",
    "section": "Procedimentos",
    "text": "Procedimentos\n\nColunas\n\ncols_proc = [\n  'bienio', 'parto_normal', 'criticidade',\n  'origem_latitude', 'origem_longitude',\n  'destino_latitude', 'destino_longitude',\n  'count',\n]\n\n\n\nCarregando tabela\n\npath_proc = get_path('GESTANTES', f'procs.csv.gzip')\ndf_proc = df_proc_bienio = pd.read_csv(path_proc)\ndf_proc = df_proc[cols_proc]\ndf_proc = df_proc[df_proc['criticidade'] > 0]\ndf_proc = df_proc.drop('criticidade', axis=1)\ndf_proc = df_proc.groupby(\n  by=list(df_proc.columns[:-1]),\n  as_index=False\n).sum()\ndf_proc\n\n\n\n\n\n    \n      \n      bienio\n      parto_normal\n      origem_latitude\n      origem_longitude\n      destino_latitude\n      destino_longitude\n      count\n    \n  Loading... (need help?)"
  },
  {
    "objectID": "sections/result_occurences.html",
    "href": "sections/result_occurences.html",
    "title": "Ocorrências",
    "section": "",
    "text": "import sys\nimport numpy as np\nimport pandas as pd\nimport plotly.graph_objects as go\n\nfrom datatable import dt, f, by\n\nfrom itables import init_notebook_mode\ninit_notebook_mode(all_interactive=True)\n\nfrom plotly import express as px, io as pio\npd.options.plotting.backend = 'plotly'\npio.renderers.default = 'plotly_mimetype+notebook_connected'\n\nfrom utils import get_path, data_load\nsys.path.insert(0, '../')\nfrom secret import API_KEY"
  },
  {
    "objectID": "sections/result_occurences.html#procedimentos",
    "href": "sections/result_occurences.html#procedimentos",
    "title": "Ocorrências",
    "section": "Procedimentos",
    "text": "Procedimentos\n\nCarregando tabela\n\npath_proc = get_path('GESTANTES', f'procs.csv.gzip')\ndf_proc_bienio = pd.read_csv(path_proc)\ndf_proc_bienio\n\n\n\n\n\n    \n      \n      bienio\n      parto_normal\n      codigo_origem\n      codigo_destino\n      origem\n      destino\n      mode\n      traffic_model\n      hour\n      distance\n      distancia (km)\n      tempo (min)\n      criticidade\n      capitais\n      socioecon\n      origem_latitude\n      origem_longitude\n      destino_latitude\n      destino_longitude\n      count\n    \n  Loading... (need help?)"
  },
  {
    "objectID": "sections/result_occurences.html#localidades",
    "href": "sections/result_occurences.html#localidades",
    "title": "Ocorrências",
    "section": "Localidades",
    "text": "Localidades\n\nCarregando tabela\n\npath_locs = get_path('LOCALIDADES', 'localidades.csv.gzip')\ndf_locs = pd.read_csv(path_locs)\ndf_locs\n\n\n\n\n\n    \n      \n      codigo\n      cod_municipio\n      nome_municipio\n      capital\n      cod_regiao_saude\n      nome_regiao_saude\n      cod_uf\n      uf\n      nome_uf\n      sigla_regiao\n      nome_regiao\n      socioecon\n      latitude\n      longitude\n    \n  Loading... (need help?)"
  },
  {
    "objectID": "sections/result_occurences.html#agrupando-brasil",
    "href": "sections/result_occurences.html#agrupando-brasil",
    "title": "Ocorrências",
    "section": "Agrupando Brasil",
    "text": "Agrupando Brasil\n\ndef group_brasil(df):\n  df_brasil = df.copy()\n  df_brasil['Localidade'] = 'BRASIL'\n  df_brasil = df_brasil.groupby(\n    by=list(df_brasil.columns)[:-1], as_index=False).sum()\n  df_brasil = pd.concat([df, df_brasil])\n  return df_brasil"
  },
  {
    "objectID": "sections/result_occurences.html#selecionar-e-agrupar",
    "href": "sections/result_occurences.html#selecionar-e-agrupar",
    "title": "Ocorrências",
    "section": "Selecionar e agrupar",
    "text": "Selecionar e agrupar\n\ndef select_and_group(df_proc, df_locs, cols, loc='nome_regiao', ref='codigo_origem'):\n  cols_proc = cols.copy()\n  cols_proc.insert(-1, ref)\n  cols_locs = ['codigo', loc]\n  df = df_proc[cols_proc].merge(df_locs[cols_locs], left_on=ref, right_on='codigo', how='left')\n  cols_proc.insert(-1, loc)\n  df = df[cols_proc]\n  df = df.drop(ref, axis=1)\n  df = df.groupby(by=list(df.columns)[:-1], as_index=False).sum()\n  df['bienio'] = df['bienio'].map(\n    {0: '2010-2011', 1: '2018-2019'})\n  df['parto_normal'] = df['parto_normal'].map(\n    {0: 'Parto Cesárea', 1: 'Parto Normal'})\n  df = df.rename(columns={\n    'bienio': 'Biênio',\n    'parto_normal': 'Parto',\n    'criticidade': 'Criticidade',\n    loc: 'Localidade',\n    'count': 'Procedimentos',\n  })\n  df = group_brasil(df)\n  df = df.pivot_table('Procedimentos', list(df.columns)[1:-1], 'Biênio', sort=True)\n  df = df.reset_index(level=df.index.names)\n  df = pd.DataFrame(df.to_dict())\n  return df"
  },
  {
    "objectID": "sections/result_occurences.html#somando-ambos-tipos-de-parto",
    "href": "sections/result_occurences.html#somando-ambos-tipos-de-parto",
    "title": "Ocorrências",
    "section": "Somando ambos tipos de parto",
    "text": "Somando ambos tipos de parto\n\ndef add_total(df):\n  df_total = df[list(df.columns)[1:]]\n  df_total = df_total.groupby(by='Localidade', as_index=False).sum()\n  df_total['Parto'] = 'Ambos'\n  df = pd.concat([df, df_total])\n  df = df.sort_values(by=['Localidade', 'Parto'])\n  df = df.reset_index(drop=True)\n  return df"
  },
  {
    "objectID": "sections/result_occurences.html#criticidade",
    "href": "sections/result_occurences.html#criticidade",
    "title": "Ocorrências",
    "section": "Criticidade",
    "text": "Criticidade\n\ndef critic(df, critic_level=1):\n  df_num = df[df['Criticidade'] >= critic_level].copy()\n  df_den = df[df['Criticidade'] >= critic_level - 1].copy()\n  def group(df):\n      df = df.drop('Criticidade', axis=1)\n      df = df.groupby(\n        by=list(df.columns)[:-2],\n        as_index=False\n      ).sum()\n      return df\n  df_num = group(df_num)\n  df_den = group(df_den)\n  df_critic = pd.merge(\n    df_num, df_den,\n    how='left', on=list(df_num.columns)[:-2],\n    suffixes=['_num', '_den'])\n  df_critic = add_total(df_critic)\n  df_critic['2010-2011'] = round(df_critic['2010-2011_num'] / df_critic['2010-2011_den'] * 100, 2)\n  df_critic['2018-2019'] = round(df_critic['2018-2019_num'] / df_critic['2018-2019_den'] * 100, 2)\n  df_critic = df_critic.sort_values(by=['Localidade', 'Parto'])\n  return df_critic"
  },
  {
    "objectID": "sections/result_occurences.html#gerar-figura-plot-barras",
    "href": "sections/result_occurences.html#gerar-figura-plot-barras",
    "title": "Ocorrências",
    "section": "Gerar figura plot barras",
    "text": "Gerar figura plot barras\n\ndef fig_count_partos(df):\n  fig = go.Figure()\n  colors = ['#31A885','#DD6F1C']\n  items = ['2010-2011','2018-2019']\n  for item, color in zip(items, colors):\n      fig.add_trace(\n        go.Bar(\n          x=df['Parto'], y=df[item],\n          marker_color=color,\n          # text=df[item], textposition='auto',\n          name=item,))\n  buttons = []\n  for loc in df['Localidade'].unique():\n      buttons.append(dict(\n        method='update',\n        label=loc,\n        args=[{\n          'y': df[df['Localidade'] == loc][items].T.values\n        }]))\n  # button_brasil = dict(\n  #   method='update',\n  #   label='Brasil',\n  #   args=[{'y': df[items].T.values}])\n  buttons = sorted(buttons, key=lambda d: d['label'])\n  # buttons.insert(0, button_brasil)\n  updatemenu=[]\n  your_menu=dict()\n  updatemenu.append(your_menu)\n  updatemenu[0]['buttons']=buttons\n  updatemenu[0]['direction']='down'\n  updatemenu[0]['active']=-1\n  updatemenu[0]['showactive']=True\n  fig.update_layout(\n    title='Número total de partos realizados no SUS',\n    legend_title='Biênio',\n    updatemenus=updatemenu)\n  return fig"
  },
  {
    "objectID": "sections/result_occurences.html#partos-no-sus",
    "href": "sections/result_occurences.html#partos-no-sus",
    "title": "Ocorrências",
    "section": "Partos no SUS",
    "text": "Partos no SUS\n\ncols_proc = ['bienio', 'parto_normal', 'count']\n\n\nLocalidade: Região\n\nDatatable\n\ndf_regiao = add_total(\n  select_and_group(\n    df_proc_bienio, df_locs, cols_proc, loc='nome_regiao'))\ndf_regiao\n\n\n\n\n\n    \n      \n      Parto\n      Localidade\n      2010-2011\n      2018-2019\n    \n  Loading... (need help?)\n\n\n\n\n\n\nBarplot\n\nfig_regiao = fig_count_partos(df_regiao)\nfig_regiao.show()\n\n\n                                                \n\n\n\n\n\nLocalidade: Unidade Federativa\n\nDatatable\n\ndf_uf = add_total(\n  select_and_group(\n    df_proc_bienio, df_locs, cols_proc, loc='nome_uf'))\ndf_uf\n\n\n\n\n\n    \n      \n      Parto\n      Localidade\n      2010-2011\n      2018-2019\n    \n  Loading... (need help?)\n\n\n\n\n\n\nBarplot\n\nfig_uf = fig_count_partos(df_uf)\nfig_uf.show()"
  },
  {
    "objectID": "sections/result_occurences.html#deslocamento-município",
    "href": "sections/result_occurences.html#deslocamento-município",
    "title": "Ocorrências",
    "section": "Deslocamento % (município)",
    "text": "Deslocamento % (município)\n\nnumerador= município diferente entre residência e hospital\ndenominador= todos os procedimentos\n\n\ncols_critic = ['bienio', 'parto_normal', 'criticidade', 'count']\n\n\nLocalidade: Região\n\nDatatable\n\ndf_mun_regiao = critic(\n  select_and_group(df_proc_bienio, df_locs, cols_critic),\n  critic_level=1)\ndf_mun_regiao\n\n\n\n\n\n    \n      \n      Parto\n      Localidade\n      2010-2011_num\n      2018-2019_num\n      2010-2011_den\n      2018-2019_den\n      2010-2011\n      2018-2019\n    \n  Loading... (need help?)\n\n\n\n\n\n\nBarplot\n\nfig_mun_regiao = fig_count_partos(df_mun_regiao)\nfig_mun_regiao.show()\n\n\n                                                \n\n\n\n\n\nLocalidade: Unidade Federativa\n\nDatatable\n\ndf_mun_uf = critic(\n  select_and_group(df_proc_bienio, df_locs, cols_critic, loc='nome_uf'),\n  critic_level=1)\ndf_mun_uf\n\n\n\n\n\n    \n      \n      Parto\n      Localidade\n      2010-2011_num\n      2018-2019_num\n      2010-2011_den\n      2018-2019_den\n      2010-2011\n      2018-2019\n    \n  Loading... (need help?)\n\n\n\n\n\n\nBarplot\n\nfig_mun_uf = fig_count_partos(df_mun_uf)\nfig_mun_uf.show()"
  },
  {
    "objectID": "sections/result_occurences.html#deslocamento-região-de-saúde",
    "href": "sections/result_occurences.html#deslocamento-região-de-saúde",
    "title": "Ocorrências",
    "section": "Deslocamento % (região de saúde)",
    "text": "Deslocamento % (região de saúde)\n\nnumerador= região de saúde diferente entre residência e hospital\ndenominador= município diferente entre residência e hospital\n\n\nLocalidade: Região\n\nDatatable\n\ndf_regsau_regiao = critic(\n  select_and_group(df_proc_bienio, df_locs, cols_critic),\n  critic_level=2)\ndf_regsau_regiao\n\n\n\n\n\n    \n      \n      Parto\n      Localidade\n      2010-2011_num\n      2018-2019_num\n      2010-2011_den\n      2018-2019_den\n      2010-2011\n      2018-2019\n    \n  Loading... (need help?)\n\n\n\n\n\n\nBarplot\n\nfig_regsau_regiao = fig_count_partos(df_regsau_regiao)\nfig_regsau_regiao.show()\n\n\n                                                \n\n\n\n\n\nLocalidade: Unidade Federativa\n\nDatatable\n\ndf_critic_uf = critic(\n  select_and_group(df_proc_bienio, df_locs, cols_critic, loc='nome_uf'),\n  critic_level=2)\ndf_critic_uf\n\n\n\n\n\n    \n      \n      Parto\n      Localidade\n      2010-2011_num\n      2018-2019_num\n      2010-2011_den\n      2018-2019_den\n      2010-2011\n      2018-2019\n    \n  Loading... (need help?)\n\n\n\n\n\n\nBarplot\n\nfig_critic_uf = fig_count_partos(df_critic_uf)\nfig_critic_uf.show()"
  },
  {
    "objectID": "sections/result_osm_gmaps.html",
    "href": "sections/result_osm_gmaps.html",
    "title": "OSM vs Google Maps",
    "section": "",
    "text": "import sys\nimport numpy as np\nimport pandas as pd\n\nfrom datatable import dt, f, by\n\nfrom itables import init_notebook_mode\ninit_notebook_mode(all_interactive=True)\n\nfrom plotly import express as px, io as pio\npd.options.plotting.backend = 'plotly'\npio.renderers.default = 'plotly_mimetype+notebook_connected'\n\nfrom utils import get_path, data_load\nsys.path.insert(0, '../')\nfrom secret import API_KEY"
  },
  {
    "objectID": "sections/result_osm_gmaps.html#rotas-sih",
    "href": "sections/result_osm_gmaps.html#rotas-sih",
    "title": "OSM vs Google Maps",
    "section": "Rotas SIH",
    "text": "Rotas SIH\n\nColunas\n\ncols_sih = {\n  'cod_municipio': 'origem',\n  'hosp_cod_municipio': 'destino',\n}\n\n\n\nCarregando tabela\n\npath_sih = get_path('SIH', 'sih.jay')\ndf_sih = dt.fread(path_sih, columns=cols_sih)\ndf_sih.names = cols_sih\ndf_sih = df_sih[:, list(cols_sih.values())]\ndf_sih = df_sih[f.origem != f.destino, :]\ndf_sih['count'] = 1\ndf_sih = df_sih[:, dt.sum(f.count), by('origem', 'destino')]\ndf_sih = df_sih.sort(-f.count)\ndf_sih\n\n\n\n  \n  \n    origemdestinocount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    051084051034022807\n    131546031062017147\n    226079026116016012\n    352125053001015461\n    428048028003015090\n    533035033028514875\n    623037023044014545\n    732050032053014543\n    815008015014014521\n    943230043149014273\n    1052002553001013577\n    1135150035528013106\n    1252014052087012745\n    1341004041069012717\n    1452218553001012112\n    ⋮⋮⋮⋮\n    68,5685300105213081\n    68,5695300105217701\n    68,5705300105220001\n    68,5715300105220201\n    68,5725300105220451\n  \n  \n  \n    68,573 rows × 3 columns"
  },
  {
    "objectID": "sections/result_osm_gmaps.html#rotas-osm",
    "href": "sections/result_osm_gmaps.html#rotas-osm",
    "title": "OSM vs Google Maps",
    "section": "Rotas OSM",
    "text": "Rotas OSM\n\nCarregando tabela\n\npath_osm = get_path('DISTANCIAS', f'deslocamentos.csv.gzip')\ndf_osm = pd.read_csv(path_osm)\ndf_osm\n\n\n\n\n\n    \n      \n      origem\n      destino\n      distancia (km)\n      tempo (min)\n      count\n    \n  Loading... (need help?)"
  },
  {
    "objectID": "sections/result_osm_gmaps.html#rotas-gmaps",
    "href": "sections/result_osm_gmaps.html#rotas-gmaps",
    "title": "OSM vs Google Maps",
    "section": "Rotas Gmaps",
    "text": "Rotas Gmaps\n\nColunas\n\ncols_gmaps = [\n  'origem', 'destino', 'count',\n  'distance (value)', 'duration (value)',\n  'duration_in_traffic (value)',\n]\n\n\n\nCarregando tabela\n\npath_routes = get_path('GESTANTES', f'gmaps/routes.csv.gzip')\ndf_files = pd.read_csv(path_routes)\ndf_files\n\n\n\n\n\n    \n      \n      status\n      origem\n      destino\n      origin_addresses\n      destination_addresses\n      origem_latitude\n      origem_longitude\n      destino_latitude\n      destino_longitude\n      hour\n      departure_time\n      mode\n      traffic_model\n      distance (value)\n      distance (text)\n      duration (value)\n      duration (text)\n      duration_in_traffic (value)\n      duration_in_traffic (text)\n      count\n    \n  Loading... (need help?)\n\n\n\n\n\n\nSelecionando\ndriving pessimistic at 6pm\n\nstatus = df_files['status'] == 'OK'\nmode = df_files['mode'] == 'driving'\ntraffic_model = df_files['traffic_model'] == 'pessimistic'\nhour = df_files['hour'] == 18\ndf_gmaps = df_files[status & mode & traffic_model & hour]\ndf_gmaps = df_gmaps.sort_values(by='count', ascending=False).reset_index(drop=True)\ndf_gmaps = df_gmaps[cols_gmaps]\ndf_gmaps\n\n\n\n\n\n    \n      \n      origem\n      destino\n      count\n      distance (value)\n      duration (value)\n      duration_in_traffic (value)\n    \n  Loading... (need help?)"
  },
  {
    "objectID": "sections/result_osm_gmaps.html#completude",
    "href": "sections/result_osm_gmaps.html#completude",
    "title": "OSM vs Google Maps",
    "section": "Completude",
    "text": "Completude\n\ndf_routes_nan = df_sih_osm.merge(df_sih_gmaps, on=['origem', 'destino', 'count'], how='left')\ndf_routes_valid = df_routes_nan[~df_routes_nan['distance (value)'].isna()]\ndf_routes_nan = df_routes_nan[df_routes_nan['distance (value)'].isna()]\ndf_routes_nan\n\n\n\n\n\n    \n      \n      origem\n      destino\n      count\n      distancia (km)\n      tempo (min)\n      distance (value)\n      duration (value)\n      duration_in_traffic (value)\n    \n  Loading... (need help?)\n\n\n\n\n\ndf_routes_nan[df_routes_nan['count'] > 1]\n\n\n\n\n\n    \n      \n      origem\n      destino\n      count\n      distancia (km)\n      tempo (min)\n      distance (value)\n      duration (value)\n      duration_in_traffic (value)\n    \n  Loading... (need help?)\n\n\n\n\n\nnan = df_routes_nan['count'].sum()\nvalid = df_routes_valid['count'].sum()\n\n\nFaltantes\n\npx.bar(x=['nan', 'valid'], y=[nan, valid])\n\n\n                                                \n\n\n\npx.histogram(df_routes_nan, x='count')#, range_x=[-.3, .45])"
  },
  {
    "objectID": "sections/result_osm_gmaps.html#diferença-entre-osm-e-gmaps",
    "href": "sections/result_osm_gmaps.html#diferença-entre-osm-e-gmaps",
    "title": "OSM vs Google Maps",
    "section": "Diferença entre OSM e Gmaps",
    "text": "Diferença entre OSM e Gmaps\n\nDistância\n\nHistograma\n\npx.histogram(df_rotas, x='dist_diff', range_x=[-.3, .45])\n\n\n                                                \n\n\n\n\nScatter\n\n# px.scatter(df_rotas, x='dist_diff', y=, range_x=[-.3, .45])\n\n\n\n\nTempo (padrão)\n\nHistograma\n\npx.histogram(df_rotas, x='tempo_diff', range_x=[-.75, 1])\n\n\n                                                \n\n\n\n\nScatter\n\npx.scatter(\n  df_rotas,\n  x='tempo_diff', y='distancia (km)',\n  opacity=.75, size='distance (value)',\n  log_x=True, log_y=True,\n)\n\n\n                                                \n\n\n\n\n\nTempo (tráfego)\n\nHistograma\n\npx.histogram(df_rotas, x='tempo_traffic_diff', range_x=[-.6, 1.5])\n\n\n                                                \n\n\n\n\nScatter\n\npx.scatter(\n  df_rotas,\n  x='tempo_traffic_diff', y='distancia (km)',\n  opacity=.75, size='distance (value)',\n  log_x=True, log_y=True,\n)"
  },
  {
    "objectID": "sections/table_flux.html",
    "href": "sections/table_flux.html",
    "title": "Fluxos",
    "section": "",
    "text": "import pandas as pd\nfrom utils import get_path, group_cols\nfrom datatable import dt, f, by"
  },
  {
    "objectID": "sections/table_flux.html#procedimentos",
    "href": "sections/table_flux.html#procedimentos",
    "title": "Fluxos",
    "section": "Procedimentos",
    "text": "Procedimentos\n\npath_proc = get_path('GESTANTES', 'procs_bienio.csv.gzip')\ndf_proc = dt.fread(path_proc)\ndf_proc\n\n\n\n  \n  \n    bienioparto_normalorigemdestinodistancia (km)tempo (min)dist_pondtempo_pondcriticidadecapitais…origem_latitudeorigem_longitudedestino_latitudedestino_longitudecount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    000CO/DF/53001/530010CO/DF/53001/530010/0010464000001_1…−15.7795−47.9297−15.7795−47.9297260\n    100CO/DF/53001/530010CO/DF/53001/530010/0010472000001_1…−15.7795−47.9297−15.7795−47.9297282\n    200CO/DF/53001/530010CO/DF/53001/530010/0010480000001_1…−15.7795−47.9297−15.7795−47.92973323\n    300CO/DF/53001/530010CO/DF/53001/530010/0010499000001_1…−15.7795−47.9297−15.7795−47.92973368\n    400CO/DF/53001/530010CO/DF/53001/530010/0010502000001_1…−15.7795−47.9297−15.7795−47.9297964\n    500CO/DF/53001/530010CO/DF/53001/530010/0010510000001_1…−15.7795−47.9297−15.7795−47.9297832\n    600CO/DF/53001/530010CO/DF/53001/530010/0010529000001_1…−15.7795−47.9297−15.7795−47.92971831\n    700CO/DF/53001/530010CO/DF/53001/530010/0010537000001_1…−15.7795−47.9297−15.7795−47.92973707\n    800CO/DF/53001/530010CO/DF/53001/530010/0010545000001_1…−15.7795−47.9297−15.7795−47.9297728\n    900CO/DF/53001/530010CO/DF/53001/530010/0010561000001_1…−15.7795−47.9297−15.7795−47.92971\n    1000CO/DF/53001/530010CO/DF/53001/530010/2645157000001_1…−15.7795−47.9297−15.7795−47.92972251\n    1100CO/DF/53001/530010CO/DF/53001/530010/2672197000001_1…−15.7795−47.9297−15.7795−47.92971561\n    1200CO/DF/53001/530010CO/DF/53001/530010/5717515000001_1…−15.7795−47.9297−15.7795−47.92971798\n    1300CO/DF/53001/530010CO/GO/52011/520110/2361787152.625132.723305.25265.44731_0…−15.7795−47.9297−16.3281−48.9534\n    1400CO/DF/53001/530010ND/BA/29002/290320/3972925630.949466.705630.949466.70541_0…−15.7795−47.9297−12.1439−44.99681\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    167,21111SL/SC/42016/421870SL/SC/42007/420540/3157245138.477104.94138.477104.9420_1…−28.4713−49.0144−27.5945−48.54771\n    167,21211SL/SC/42016/421870SL/SC/42015/420460/259427754.62149.316754.62149.316720_0…−28.4713−49.0144−28.6723−49.37291\n    167,21311SL/SC/42016/421870SL/SC/42016/420280/266588335.543937.493371.087874.986710_0…−28.4713−49.0144−28.2681−49.17012\n    167,21411SL/SC/42016/421870SL/SC/42016/420730/238588053.96145.353353.96145.353310_0…−28.4713−49.0144−28.2284−48.66591\n    167,21511SL/SC/42016/421870SL/SC/42016/421870/2491710000000_0…−28.4713−49.0144−28.4713−49.0144441\n  \n  \n  \n    167,216 rows × 16 columns"
  },
  {
    "objectID": "sections/table_flux.html#cnes",
    "href": "sections/table_flux.html#cnes",
    "title": "Fluxos",
    "section": "CNES",
    "text": "CNES\n\ncols_cnes = {\n  'CNES': 'id_destino',\n  'Nome Fantasia': 'nome_destino',\n}\n\n\npath_cnes = get_path('LOCALIDADES', 'cnes.csv.gzip')\ndf_cnes = pd.read_csv(path_cnes, dtype={'CNES': str})\ndf_cnes = df_cnes.rename(columns=cols_cnes)[cols_cnes.values()]\ndf_cnes = dt.Frame(df_cnes)\ndf_cnes\n\n\n\n  \n  \n    id_destinonome_destino\n    ▪▪▪▪▪▪▪▪\n  \n  \n    00002232HOSPITAL E MATERNIDADE SANTA IZABEL\n    13151794MATERNIDADE DE REFERENCIA ANA BRAGA\n    22323397MATERNIDADE DONA EVANGELINA ROSA\n    32311682HOSPITAL SANTA HELENA\n    40026794HOSPITAL SOFIA FELDMAN\n    52020068SES AP HOSPITAL DA MULHER\n    66627595INSTITUTO DA MULHER DONA LINDU\n    72799278HOSPITAL INACIA PINTO DOS SANTOS\n    80010480HOSPITAL REGIONAL DE CEILANDIA\n    92077388HOSPITAL AMPARO MATERNAL\n    107011857SES RJ COMPLEXO REG DE MESQUITA MATERNID E CLINICA…\n    116303153HOSPITAL NOSSA SENHORA DA GUIA\n    122755165HOSPITAL DOM ORIONE DE ARAGUAINA\n    132344882HOSPITAL DO TRICENTENARIO\n    142079186HOSP MUN MAT ESC DR MARIO DE MORAES A SILVA\n    ⋮⋮⋮\n    39237320175HOSPITAL SAO MIGUEL ARCANJO\n    39247603029HOSPITAL MUNICIPAL LENILDE OLIVEIRA\n    39257621442HOSPITAL ESTADUAL DE URGENCIA E EMERGENCIA\n    39267704364HOSPITAL DE URGENCIA E EMERGENCIA REGIONAL DE CACO…\n    39277743068HOSPITAL ESTADUAL DE URGENCIAS GOV OTAVIO LAG SIQU…\n  \n  \n  \n    3928 rows × 2 columns"
  },
  {
    "objectID": "sections/table_flux.html#regsau---cnes",
    "href": "sections/table_flux.html#regsau---cnes",
    "title": "Fluxos",
    "section": "REGSAU -> CNES",
    "text": "REGSAU -> CNES\n\nscale_origin = 'regiao_saude'\nscale_destin = 'cnes'\ndf_regsau_cnes = get_flux_table(scale_origin, scale_destin)\ndf_regsau_cnes\n\n\n\n  \n  \n    bienioparto_normalorigemdestinoescala_origemescala_destinoid_origemid_destinonome_origemnome_destino…countdist_pondtempo_pondtotalpercent\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    000CO/DF/53001CO/DF/53001/530010/0010464regiao_saudecnes530010010464Distrito FederalHRAN…26000260100\n    110CO/DF/53001CO/DF/53001/530010/0010464regiao_saudecnes530010010464Distrito FederalHRAN…1954001954100\n    201CO/DF/53001CO/DF/53001/530010/0010464regiao_saudecnes530010010464Distrito FederalHRAN…2171002171100\n    311CO/DF/53001CO/DF/53001/530010/0010464regiao_saudecnes530010010464Distrito FederalHRAN…2521002521100\n    400CO/DF/53001CO/DF/53001/530010/0010472regiao_saudecnes530010010472Distrito FederalHRG…28200282100\n    510CO/DF/53001CO/DF/53001/530010/0010472regiao_saudecnes530010010472Distrito FederalHRG…65000650100\n    601CO/DF/53001CO/DF/53001/530010/0010472regiao_saudecnes530010010472Distrito FederalHRG…2739002739100\n    711CO/DF/53001CO/DF/53001/530010/0010472regiao_saudecnes530010010472Distrito FederalHRG…1981001981100\n    800CO/DF/53001CO/DF/53001/530010/0010480regiao_saudecnes530010010480Distrito FederalHOSPITAL REGIONAL DE CEILANDIA…3323003323100\n    910CO/DF/53001CO/DF/53001/530010/0010480regiao_saudecnes530010010480Distrito FederalHOSPITAL REGIONAL DE CEILANDIA…2840002840100\n    1001CO/DF/53001CO/DF/53001/530010/0010480regiao_saudecnes530010010480Distrito FederalHOSPITAL REGIONAL DE CEILANDIA…8418008418100\n    1111CO/DF/53001CO/DF/53001/530010/0010480regiao_saudecnes530010010480Distrito FederalHOSPITAL REGIONAL DE CEILANDIA…6629006629100\n    1200CO/DF/53001CO/DF/53001/530010/0010499regiao_saudecnes530010010499Distrito FederalHRT HOSPITAL REGIONAL DE TAGUATINGA…3368003368100\n    1310CO/DF/53001CO/DF/53001/530010/0010499regiao_saudecnes530010010499Distrito FederalHRT HOSPITAL REGIONAL DE TAGUATINGA…2294002294100\n    1401CO/DF/53001CO/DF/53001/530010/0010499regiao_saudecnes530010010499Distrito FederalHRT HOSPITAL REGIONAL DE TAGUATINGA…4404004404100\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    52,41411SL/SC/42016SL/SC/42016/421870/2491710regiao_saudecnes420162491710LagunaNA…44100112739.1304\n    52,41500SL/SC/42016SL/SC/42016/421870/2491710regiao_saudecnes420162491710LagunaNA…511238.141184.610349.5146\n    52,41610SL/SC/42016SL/SC/42016/421870/2491710regiao_saudecnes420162491710LagunaNA…3019023.528390.2649161.3035\n    52,41701SL/SC/42016SL/SC/42016/421870/2491710regiao_saudecnes420162491710LagunaNA…2766539.276254.2154750.457\n    52,41811SL/SC/42016SL/SC/42016/421870/2491710regiao_saudecnes420162491710LagunaNA…68619590.917936.8112760.8696\n  \n  \n  \n    52,419 rows × 16 columns\n  \n\n\n\n\nApenas RJ\n\ndef filter_rj(df):\n  return ['SD/RJ' in c for c in df['origem'].to_list()[0]]\n\n\ndf_regsau_cnes[filter_rj(df_regsau_cnes), :]\n\n\n\n  \n  \n    bienioparto_normalorigemdestinoescala_origemescala_destinoid_origemid_destinonome_origemnome_destino…countdist_pondtempo_pondtotalpercent\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011SD/RJ/33001ND/PB/25012/250690/6644996regiao_saudecnes330016644996Baia da Ilha GrandeHOSPITAL REGIONAL DE ITABAIANA…12485.741898.21100\n    111SD/RJ/33001ND/PI/22005/220770/8015899regiao_saudecnes330018015899Baia da Ilha GrandeHOSPITAL ESTADUAL DIRCEU ARCOVERDE…13067.572331.661100\n    200SD/RJ/33001SD/ES/32002/320245/2448203regiao_saudecnes330012448203Baia da Ilha GrandeHOSPITAL DE IBATIBA…21229.23919.5372100\n    311SD/RJ/33001SD/ES/32002/320245/2448203regiao_saudecnes330012448203Baia da Ilha GrandeHOSPITAL DE IBATIBA…1704.828573.2271100\n    400SD/RJ/33001SD/RJ/33001/330010/2280868regiao_saudecnes330012280868Baia da Ilha GrandeHOSPITAL E MATERNIDADE DE ANGRA DOS REIS HMAR…5330053899.0706\n    510SD/RJ/33001SD/RJ/33001/330010/2280868regiao_saudecnes330012280868Baia da Ilha GrandeHOSPITAL E MATERNIDADE DE ANGRA DOS REIS HMAR…169800174397.4182\n    601SD/RJ/33001SD/RJ/33001/330010/2280868regiao_saudecnes330012280868Baia da Ilha GrandeHOSPITAL E MATERNIDADE DE ANGRA DOS REIS HMAR…145700149097.7852\n    711SD/RJ/33001SD/RJ/33001/330010/2280868regiao_saudecnes330012280868Baia da Ilha GrandeHOSPITAL E MATERNIDADE DE ANGRA DOS REIS HMAR…178100182297.7497\n    800SD/RJ/33001SD/RJ/33001/330010/2280868regiao_saudecnes330012280868Baia da Ilha GrandeHOSPITAL E MATERNIDADE DE ANGRA DOS REIS HMAR…5323.197312.4225380.929368\n    910SD/RJ/33001SD/RJ/33001/330010/2280868regiao_saudecnes330012280868Baia da Ilha GrandeHOSPITAL E MATERNIDADE DE ANGRA DOS REIS HMAR…452415.212358.0717432.58176\n    1001SD/RJ/33001SD/RJ/33001/330010/2280868regiao_saudecnes330012280868Baia da Ilha GrandeHOSPITAL E MATERNIDADE DE ANGRA DOS REIS HMAR…332109.552015.8314902.21477\n    1111SD/RJ/33001SD/RJ/33001/330010/2280868regiao_saudecnes330012280868Baia da Ilha GrandeHOSPITAL E MATERNIDADE DE ANGRA DOS REIS HMAR…412720.872700.3218222.25027\n    1200SD/RJ/33001SD/RJ/33001/330010/2281384regiao_saudecnes330012281384Baia da Ilha GrandeHOSPITAL DE PRAIA BRAVA…1160012791.3386\n    1310SD/RJ/33001SD/RJ/33001/330010/2281384regiao_saudecnes330012281384Baia da Ilha GrandeHOSPITAL DE PRAIA BRAVA…77007997.4684\n    1401SD/RJ/33001SD/RJ/33001/330010/2281384regiao_saudecnes330012281384Baia da Ilha GrandeHOSPITAL DE PRAIA BRAVA…3260035292.6136\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    162601SD/RJ/33009SD/RJ/33009/330590/3584968regiao_saudecnes330093584968SerranaHOSPITAL FRANCISCO LIMONGI…390039100\n    162711SD/RJ/33009SD/RJ/33009/330590/3584968regiao_saudecnes330093584968SerranaHOSPITAL FRANCISCO LIMONGI…600785.7143\n    162811SD/RJ/33009SD/RJ/33009/330590/3584968regiao_saudecnes330093584968SerranaHOSPITAL FRANCISCO LIMONGI…130.30532.1633714.2857\n    162910SD/RJ/33009SD/SP/35011/351830/2773333regiao_saudecnes330092773333SerranaSANTA CASA DE GUARAREMA…1404.5312.9151100\n    163011SD/RJ/33009SD/SP/35072/350950/2022621regiao_saudecnes330092022621SerranaMATERNIDADE DE CAMPINAS…1507.879389.5731100\n  \n  \n  \n    1631 rows × 16 columns"
  },
  {
    "objectID": "sections/table_flux.html#regsau---município-rj",
    "href": "sections/table_flux.html#regsau---município-rj",
    "title": "Fluxos",
    "section": "REGSAU -> Município (RJ)",
    "text": "REGSAU -> Município (RJ)\n\nscale_origin = 'regiao_saude'\nscale_destin = 'municipio'\ndf_regsau_mun = get_flux_table(scale_origin, scale_destin)\ndf_regsau_mun[filter_rj(df_regsau_mun), :]\n\n\n\n  \n  \n    bienioparto_normalorigemdestinoescala_origemescala_destinoid_origemid_destinonome_origemnome_destino…countdist_pondtempo_pondtotalpercent\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011SD/RJ/33001ND/PB/25012/250690regiao_saudemunicipio33001250690Baia da Ilha GrandeItabaiana…12485.741898.21100\n    111SD/RJ/33001ND/PI/22005/220770regiao_saudemunicipio33001220770Baia da Ilha GrandeParnaíba…13067.572331.661100\n    200SD/RJ/33001SD/ES/32002/320245regiao_saudemunicipio33001320245Baia da Ilha GrandeIbatiba…21229.23919.5372100\n    311SD/RJ/33001SD/ES/32002/320245regiao_saudemunicipio33001320245Baia da Ilha GrandeIbatiba…1704.828573.2271100\n    400SD/RJ/33001SD/RJ/33001/330010regiao_saudemunicipio33001330010Baia da Ilha GrandeAngra dos Reis…6490066597.594\n    510SD/RJ/33001SD/RJ/33001/330010regiao_saudemunicipio33001330010Baia da Ilha GrandeAngra dos Reis…177500182297.4204\n    601SD/RJ/33001SD/RJ/33001/330010regiao_saudemunicipio33001330010Baia da Ilha GrandeAngra dos Reis…178300184296.797\n    711SD/RJ/33001SD/RJ/33001/330010regiao_saudemunicipio33001330010Baia da Ilha GrandeAngra dos Reis…186300190597.7953\n    800SD/RJ/33001SD/RJ/33001/330010regiao_saudemunicipio33001330010Baia da Ilha GrandeAngra dos Reis…161379.671676.666652.40602\n    910SD/RJ/33001SD/RJ/33001/330010regiao_saudemunicipio33001330010Baia da Ilha GrandeAngra dos Reis…472607.32606.1218222.57958\n    1001SD/RJ/33001SD/RJ/33001/330010regiao_saudemunicipio33001330010Baia da Ilha GrandeAngra dos Reis…594606.665240.3918423.20304\n    1111SD/RJ/33001SD/RJ/33001/330010regiao_saudemunicipio33001330010Baia da Ilha GrandeAngra dos Reis…422816.922824.3419052.20472\n    1200SD/RJ/33001SD/RJ/33001/330260regiao_saudemunicipio33001330260Baia da Ilha GrandeMangaratiba…18300183100\n    1310SD/RJ/33001SD/RJ/33001/330260regiao_saudemunicipio33001330260Baia da Ilha GrandeMangaratiba…32400324100\n    1401SD/RJ/33001SD/RJ/33001/330260regiao_saudemunicipio33001330260Baia da Ilha GrandeMangaratiba…58900589100\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    119001SD/RJ/33009SD/RJ/33009/330590regiao_saudemunicipio33009330590SerranaTrajano de Moraes…390039100\n    119111SD/RJ/33009SD/RJ/33009/330590regiao_saudemunicipio33009330590SerranaTrajano de Moraes…600785.7143\n    119211SD/RJ/33009SD/RJ/33009/330590regiao_saudemunicipio33009330590SerranaTrajano de Moraes…130.30532.1633714.2857\n    119310SD/RJ/33009SD/SP/35011/351830regiao_saudemunicipio33009351830SerranaGuararema…1404.5312.9151100\n    119411SD/RJ/33009SD/SP/35072/350950regiao_saudemunicipio33009350950SerranaCampinas…1507.879389.5731100\n  \n  \n  \n    1195 rows × 16 columns"
  },
  {
    "objectID": "sections/table_flux.html#regsau---regsau-rj",
    "href": "sections/table_flux.html#regsau---regsau-rj",
    "title": "Fluxos",
    "section": "REGSAU -> REGSAU (RJ)",
    "text": "REGSAU -> REGSAU (RJ)\n\nscale_origin = 'regiao_saude'\nscale_destin = 'regiao_saude'\ndf_regsau_regsau = get_flux_table(scale_origin, scale_destin)\ndf_regsau_regsau[filter_rj(df_regsau_regsau), :]\n\n\n\n  \n  \n    bienioparto_normalorigemdestinoescala_origemescala_destinoid_origemid_destinonome_origemnome_destino…countdist_pondtempo_pondtotalpercent\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011SD/RJ/33001ND/PB/25012regiao_sauderegiao_saude3300125012Baia da Ilha Grande12ª Região…12485.741898.21100\n    111SD/RJ/33001ND/PI/22005regiao_sauderegiao_saude3300122005Baia da Ilha GrandePlanície Litorânea…13067.572331.661100\n    200SD/RJ/33001SD/ES/32002regiao_sauderegiao_saude3300132002Baia da Ilha GrandeMetropolitana…21229.23919.5372100\n    311SD/RJ/33001SD/ES/32002regiao_sauderegiao_saude3300132002Baia da Ilha GrandeMetropolitana…1704.828573.2271100\n    400SD/RJ/33001SD/RJ/33001regiao_sauderegiao_saude3300133001Baia da Ilha GrandeBaia da Ilha Grande…9230093998.2961\n    510SD/RJ/33001SD/RJ/33001regiao_sauderegiao_saude3300133001Baia da Ilha GrandeBaia da Ilha Grande…244500250097.8\n    601SD/RJ/33001SD/RJ/33001regiao_sauderegiao_saude3300133001Baia da Ilha GrandeBaia da Ilha Grande…271400277397.8723\n    711SD/RJ/33001SD/RJ/33001regiao_sauderegiao_saude3300133001Baia da Ilha GrandeBaia da Ilha Grande…256400261897.9374\n    800SD/RJ/33001SD/RJ/33001regiao_sauderegiao_saude3300133001Baia da Ilha GrandeBaia da Ilha Grande…161379.671676.669391.70394\n    910SD/RJ/33001SD/RJ/33001regiao_sauderegiao_saude3300133001Baia da Ilha GrandeBaia da Ilha Grande…553375.643598.2925002.2\n    1001SD/RJ/33001SD/RJ/33001regiao_sauderegiao_saude3300133001Baia da Ilha GrandeBaia da Ilha Grande…594606.665240.3927732.12766\n    1111SD/RJ/33001SD/RJ/33001regiao_sauderegiao_saude3300133001Baia da Ilha GrandeBaia da Ilha Grande…543930.184235.6826182.06264\n    1210SD/RJ/33001SD/RJ/33002regiao_sauderegiao_saude3300133002Baia da Ilha GrandeBaixada Litorânea…41213.221003.064100\n    1311SD/RJ/33001SD/RJ/33002regiao_sauderegiao_saude3300133002Baia da Ilha GrandeBaixada Litorânea…2370.711333.3172100\n    1401SD/RJ/33001SD/RJ/33003regiao_sauderegiao_saude3300133003Baia da Ilha GrandeCentro-Sul…5342.334276.0925100\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    48110SD/RJ/33009SD/RJ/33009regiao_sauderegiao_saude3300933009SerranaSerrana…3119304.381017057295.42852\n    48201SD/RJ/33009SD/RJ/33009regiao_sauderegiao_saude3300933009SerranaSerrana…1546426.086418.9974622.06379\n    48311SD/RJ/33009SD/RJ/33009regiao_sauderegiao_saude3300933009SerranaSerrana…28010701.311439.166404.21687\n    48410SD/RJ/33009SD/SP/35011regiao_sauderegiao_saude3300935011SerranaAlto do Tietê…1404.5312.9151100\n    48511SD/RJ/33009SD/SP/35072regiao_sauderegiao_saude3300935072SerranaRegião Metropolitana de Campinas…1507.879389.5731100\n  \n  \n  \n    486 rows × 16 columns"
  },
  {
    "objectID": "sections/table_flux.html#município---município-rj",
    "href": "sections/table_flux.html#município---município-rj",
    "title": "Fluxos",
    "section": "Município -> Município (RJ)",
    "text": "Município -> Município (RJ)\n\nscale_origin = 'municipio'\nscale_destin = 'municipio'\ndf_mun_mun = get_flux_table(scale_origin, scale_destin)\ndf_mun_mun_rj = df_mun_mun[filter_rj(df_mun_mun), :]\ndf_mun_mun_rj\n\n\n\n  \n  \n    bienioparto_normalorigemdestinoescala_origemescala_destinoid_origemid_destinonome_origemnome_destino…countdist_pondtempo_pondtotalpercent\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011SD/RJ/33001/330010ND/PI/22005/220770municipiomunicipio330010220770Angra dos ReisParnaíba…13067.572331.661100\n    100SD/RJ/33001/330010SD/ES/32002/320245municipiomunicipio330010320245Angra dos ReisIbatiba…21229.23919.5372100\n    200SD/RJ/33001/330010SD/RJ/33001/330010municipiomunicipio330010330010Angra dos ReisAngra dos Reis…64900649100\n    310SD/RJ/33001/330010SD/RJ/33001/330010municipiomunicipio330010330010Angra dos ReisAngra dos Reis…1775001775100\n    401SD/RJ/33001/330010SD/RJ/33001/330010municipiomunicipio330010330010Angra dos ReisAngra dos Reis…1783001783100\n    511SD/RJ/33001/330010SD/RJ/33001/330010municipiomunicipio330010330010Angra dos ReisAngra dos Reis…1863001863100\n    611SD/RJ/33001/330010SD/RJ/33001/330260municipiomunicipio330010330260Angra dos ReisMangaratiba…156.788547.11100\n    710SD/RJ/33001/330010SD/RJ/33001/330380municipiomunicipio330010330380Angra dos ReisParaty…8768.343992.1738100\n    811SD/RJ/33001/330010SD/RJ/33001/330380municipiomunicipio330010330380Angra dos ReisParaty…111056.471364.2411100\n    910SD/RJ/33001/330010SD/RJ/33002/330023municipiomunicipio330010330023Angra dos ReisArmação dos Búzios…1317.318254.0321100\n    1010SD/RJ/33001/330010SD/RJ/33002/330130municipiomunicipio330010330130Angra dos ReisCasimiro de Abreu…1279.628216.7981100\n    1110SD/RJ/33001/330010SD/RJ/33002/330550municipiomunicipio330010330550Angra dos ReisSaquarema…1237.112204.4921100\n    1211SD/RJ/33001/330010SD/RJ/33004/330040municipiomunicipio330010330040Angra dos ReisBarra Mansa…195.8852115.6581100\n    1301SD/RJ/33001/330010SD/RJ/33004/330400municipiomunicipio330010330400Angra dos ReisPiraí…2266.772211.4772100\n    1410SD/RJ/33001/330010SD/RJ/33004/330411municipiomunicipio330010330411Angra dos ReisPorto Real…3355.744397.873100\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    248100SD/RJ/33009/330590SD/RJ/33009/330460municipiomunicipio330590330460Trajano de MoraesSanta Maria Madalena…5151.525160.8175100\n    248201SD/RJ/33009/330590SD/RJ/33009/330460municipiomunicipio330590330460Trajano de MoraesSanta Maria Madalena…15454.575482.4515100\n    248300SD/RJ/33009/330590SD/RJ/33009/330590municipiomunicipio330590330590Trajano de MoraesTrajano de Moraes…4004100\n    248401SD/RJ/33009/330590SD/RJ/33009/330590municipiomunicipio330590330590Trajano de MoraesTrajano de Moraes…390039100\n    248511SD/RJ/33009/330590SD/RJ/33009/330590municipiomunicipio330590330590Trajano de MoraesTrajano de Moraes…6006100\n  \n  \n  \n    2486 rows × 16 columns"
  },
  {
    "objectID": "sections/table_flux.html#uf---região",
    "href": "sections/table_flux.html#uf---região",
    "title": "Fluxos",
    "section": "UF -> Região",
    "text": "UF -> Região\n\nscale_origin = 'uf'\nscale_destin = 'regiao'\ndf_uf_regsau = get_flux_table(scale_origin, scale_destin)\n# df_uf_regsau[filter_rj(df_uf_regsau), :]\ndf_uf_regsau\n\n\n\n  \n  \n    bienioparto_normalorigemdestinoescala_origemescala_destinoid_origemid_destinonome_origemnome_destino…countdist_pondtempo_pondtotalpercent\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    000CO/DFCOufregiaoDFCODistrito FederalCentro-Oeste…20906002091099.9809\n    110CO/DFCOufregiaoDFCODistrito FederalCentro-Oeste…19949001999099.7949\n    201CO/DFCOufregiaoDFCODistrito FederalCentro-Oeste…40969004098199.9707\n    311CO/DFCOufregiaoDFCODistrito FederalCentro-Oeste…33309003335199.8741\n    400CO/DFCOufregiaoDFCODistrito FederalCentro-Oeste…4305.25265.447209100.0191296\n    510CO/DFCOufregiaoDFCODistrito FederalCentro-Oeste…418201.446862.07199900.205103\n    601CO/DFCOufregiaoDFCODistrito FederalCentro-Oeste…123103.872606.93409810.0292819\n    711CO/DFCOufregiaoDFCODistrito FederalCentro-Oeste…426997.036154.23333510.125933\n    800CO/DFNDufregiaoDFNDDistrito FederalNordeste…22535.681909.42100\n    910CO/DFNDufregiaoDFNDDistrito FederalNordeste…5798911.674126.857100\n    1001CO/DFNDufregiaoDFNDDistrito FederalNordeste…812993.49598.68100\n    1111CO/DFNDufregiaoDFNDDistrito FederalNordeste…8313942110465783100\n    1201CO/DFNTufregiaoDFNTDistrito FederalNorte…45378.799122.134100\n    1311CO/DFNTufregiaoDFNTDistrito FederalNorte…23625.383392.122100\n    1400CO/DFSDufregiaoDFSDDistrito FederalSudeste…83365.922773.148100\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    77911SL/SCSLufregiaoSCSLSanta CatarinaSul…126179730.676301.6600252.10079\n    78000SL/SCSLufregiaoSCSLSanta CatarinaSul…1069261.438267.82407650.260027\n    78110SL/SCSLufregiaoSCSLSanta CatarinaSul…13627813.824446.8388470.350091\n    78201SL/SCSLufregiaoSCSLSanta CatarinaSul…16213621.911980.6598260.270785\n    78311SL/SCSLufregiaoSCSLSanta CatarinaSul…15838894.434123.3600250.263224\n  \n  \n  \n    784 rows × 16 columns"
  },
  {
    "objectID": "sections/table_locs.html",
    "href": "sections/table_locs.html",
    "title": "Localidades",
    "section": "",
    "text": "import pandas as pd\nfrom utils import get_path, group_cols\nfrom datatable import dt, f, by"
  },
  {
    "objectID": "sections/table_locs.html#cnes",
    "href": "sections/table_locs.html#cnes",
    "title": "Localidades",
    "section": "CNES",
    "text": "CNES\n\nColunas\n\ncols_cnes = {\n  'CNES': 'identificador',\n  'Nome Fantasia': 'nome',\n}\n\n\n\nCarregando tabela\n\npath_cnes = get_path('LOCALIDADES', 'cnes.csv.gzip')\ndf_cnes = pd.read_csv(path_cnes, dtype={'CNES': str})\ndf_cnes = df_cnes.rename(columns=cols_cnes)[cols_cnes.values()]\ndf_cnes = dt.Frame(df_cnes)\ndf_cnes\n\n\n\n  \n  \n    identificadornome\n    ▪▪▪▪▪▪▪▪\n  \n  \n    00002232HOSPITAL E MATERNIDADE SANTA IZABEL\n    13151794MATERNIDADE DE REFERENCIA ANA BRAGA\n    22323397MATERNIDADE DONA EVANGELINA ROSA\n    32311682HOSPITAL SANTA HELENA\n    40026794HOSPITAL SOFIA FELDMAN\n    52020068SES AP HOSPITAL DA MULHER\n    66627595INSTITUTO DA MULHER DONA LINDU\n    72799278HOSPITAL INACIA PINTO DOS SANTOS\n    80010480HOSPITAL REGIONAL DE CEILANDIA\n    92077388HOSPITAL AMPARO MATERNAL\n    107011857SES RJ COMPLEXO REG DE MESQUITA MATERNID E CLINICA DA MULHER\n    116303153HOSPITAL NOSSA SENHORA DA GUIA\n    122755165HOSPITAL DOM ORIONE DE ARAGUAINA\n    132344882HOSPITAL DO TRICENTENARIO\n    142079186HOSP MUN MAT ESC DR MARIO DE MORAES A SILVA\n    ⋮⋮⋮\n    39237320175HOSPITAL SAO MIGUEL ARCANJO\n    39247603029HOSPITAL MUNICIPAL LENILDE OLIVEIRA\n    39257621442HOSPITAL ESTADUAL DE URGENCIA E EMERGENCIA\n    39267704364HOSPITAL DE URGENCIA E EMERGENCIA REGIONAL DE CACOAL HEURO\n    39277743068HOSPITAL ESTADUAL DE URGENCIAS GOV OTAVIO LAG SIQUEIRA HUGOL\n  \n  \n  \n    3928 rows × 2 columns"
  },
  {
    "objectID": "sections/table_locs.html#procedimentos",
    "href": "sections/table_locs.html#procedimentos",
    "title": "Localidades",
    "section": "Procedimentos",
    "text": "Procedimentos\n\nCarregando tabela\n\npath_proc = get_path('GESTANTES', 'procs.csv.gzip')\ndf_proc = pd.read_csv(path_proc)\ndf_proc\n\n\n\n\n\n  \n    \n      \n      origem\n      destino\n      origem_nomeclatura\n      destino_nomeclatura\n      ano\n      procedimento\n      km (osm)\n      min (osm)\n      criticidade\n      capitais\n      socioecon\n      count\n    \n  \n  \n    \n      0\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2010\n      N_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      141\n    \n    \n      1\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2010\n      C_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      49\n    \n    \n      2\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2011\n      N_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      95\n    \n    \n      3\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2011\n      C_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      31\n    \n    \n      4\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2012\n      N_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      73\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      608898\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2018\n      C_\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      737\n    \n    \n      608899\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2018\n      C_L\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      11\n    \n    \n      608900\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2019\n      N_\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      1086\n    \n    \n      608901\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2019\n      C_\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      839\n    \n    \n      608902\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2019\n      C_L\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      22\n    \n  \n\n608903 rows × 12 columns\n\n\n\n\n\nNomeclaturas\n\nset_orig =  set(df_proc['origem_nomeclatura'])\nset_dest =  set(df_proc['destino_nomeclatura'])\ncodigos = set(set_orig).union(set_dest)\nnomeclaturas = set()\nfor cod in codigos:\n  siglas = [c for c in cod.split('/') if len(c) > 1]\n  for i in range(len(siglas)):\n    n = '/' + '/'.join(siglas[:i+1]) + '/'\n    if len(n) > 1:\n      nomeclaturas.add(n)\nnomeclaturas = {'nomeclaturas': list(nomeclaturas)}\ndf_nom = pd.DataFrame(nomeclaturas)\ndf_nom['escala'] = df_nom['nomeclaturas'].apply(\n  lambda x: x.count('/') - 2)\ncols = ['escala', 'nomeclaturas']\ndf_nom = df_nom.sort_values(by=cols)[cols]\ndf_nom\n\n\n\n\n\n  \n    \n      \n      escala\n      nomeclaturas\n    \n  \n  \n    \n      8521\n      0\n      /BR/\n    \n    \n      4590\n      1\n      /BR/CO/\n    \n    \n      2654\n      1\n      /BR/ND/\n    \n    \n      6859\n      1\n      /BR/NT/\n    \n    \n      2329\n      1\n      /BR/SD/\n    \n    \n      ...\n      ...\n      ...\n    \n    \n      9455\n      5\n      /BR/SL/SC/42016/420940/2558017/\n    \n    \n      1944\n      5\n      /BR/SL/SC/42016/421490/2386038/\n    \n    \n      3162\n      5\n      /BR/SL/SC/42016/421710/2550881/\n    \n    \n      5085\n      5\n      /BR/SL/SC/42016/421840/2778858/\n    \n    \n      5627\n      5\n      /BR/SL/SC/42016/421870/2491710/\n    \n  \n\n10194 rows × 2 columns"
  },
  {
    "objectID": "sections/table_locs.html#escalas",
    "href": "sections/table_locs.html#escalas",
    "title": "Localidades",
    "section": "Escalas",
    "text": "Escalas\n\nGeográficas\n\npath_locs = get_path('LOCALIDADES', 'nomeclaturas.csv.gzip')\nscales = ['pais', 'regiao', 'uf', 'regiao_saude', 'municipio'] #, 'cnes']\ndf_noms = dt.Frame(pd.DataFrame({\n  'nomeclatura': df_proc['origem_nomeclatura'].unique()}))\ndf_geos = dt.rbind(*[\n  rank_locs(df_noms, path_locs, scale) for scale in scales])\ndf_geos\n\n\n\n  \n  \n    nomeclaturanomeidentificadorescala\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0/BR/BrasilBRpais\n    1/BR/CO/Centro-OesteCOregiao\n    2/BR/ND/NordesteNDregiao\n    3/BR/NT/NorteNTregiao\n    4/BR/SD/SudesteSDregiao\n    5/BR/SL/SulSLregiao\n    6/BR/CO/DF/Distrito FederalDFuf\n    7/BR/CO/GO/GoiásGOuf\n    8/BR/CO/MS/Mato Grosso do SulMSuf\n    9/BR/CO/MT/Mato GrossoMTuf\n    10/BR/ND/AL/AlagoasALuf\n    11/BR/ND/BA/BahiaBAuf\n    12/BR/ND/CE/CearáCEuf\n    13/BR/ND/MA/MaranhãoMAuf\n    14/BR/ND/PB/ParaíbaPBuf\n    ⋮⋮⋮⋮⋮\n    6036/BR/SL/SC/42016/421560/Santa Rosa de Lima421560municipio\n    6037/BR/SL/SC/42016/421700/São Ludgero421700municipio\n    6038/BR/SL/SC/42016/421710/São Martinho421710municipio\n    6039/BR/SL/SC/42016/421840/Treze de Maio421840municipio\n    6040/BR/SL/SC/42016/421870/Tubarão421870municipio\n  \n  \n  \n    6041 rows × 4 columns\n  \n\n\n\n\n\nHospital\n\ndf_hosp = dt.Frame(pd.DataFrame({\n  'nomeclatura': df_proc['destino_nomeclatura'].unique()}))\ndf_hosp['identificador'] = dt.Frame([\n  c.split('/')[-2]\n    for c in df_hosp['nomeclatura'].to_list()[0]])\ndf_hosp['escala'] = 'hospital'\ndf_cnes.key = 'identificador'\ndf_hosp = df_hosp[:, :, dt.join(df_cnes)]\ndf_hosp\n\n\n\n  \n  \n    nomeclaturaidentificadorescalanome\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0/BR/NT/RO/11005/110001/2679477/2679477hospitalHOSPITAL MUNICIPAL VANESSA E VANIA FUZARI\n    1/BR/NT/RO/11001/110002/2494299/2494299hospitalHOSPITAL REGIONAL DE ARIQUEMES\n    2/BR/NT/RO/11002/110004/2496046/2496046hospitalHOSPITAL MUNICIPAL MATERNO INFANTIL CACOAL\n    3/BR/NT/RO/11006/110006/2808544/2808544hospitalHOSPITAL MUNICIPAL DR PEDRO GRANGEIRO XAVIER\n    4/BR/NT/RO/11002/110009/2808587/2808587hospitalHOSPITAL MUNICIPAL ANGELINA GEORGETTI\n    5/BR/NT/RO/11003/110012/2495279/2495279hospitalHOSPITAL DR CLAUDIONOR COUTO RORIZ\n    6/BR/NT/RO/11001/110013/2808617/2808617hospitalHOSPITAL MUNICIPAL DE MACHADINHO DOESTE\n    7/BR/NT/RO/11003/110015/2496879/2496879hospitalHOSPITAL MUNICIPAL DRA LAURA MARIA BRAGA\n    8/BR/NT/RO/11002/110018/2496534/2496534hospitalHOSPITAL E MATERNIDADE MUNICIPAL ANA NETA PIMENTA BUENO\n    9/BR/NT/RO/11004/110020/3970442/3970442hospitalHOSPITAL MATERNIDADE MAE ESPERANCA\n    10/BR/NT/RO/11004/110020/4001303/4001303hospitalHOSPITAL DE BASE PORTO VELHO\n    11/BR/NT/RO/11003/110025/2495414/2495414hospitalHOSPITAL E MATERNIDADE EUFRASIA MARIA DA CONCEICAO\n    12/BR/NT/RO/11005/110028/2495228/2495228hospitalHOSPITAL MUNICIPAL JOAO AMELIO DA SILVA\n    13/BR/NT/RO/11006/110030/2798484/2798484hospitalHOSPITAL REGIONAL ADAMASTOR TEIXEIRA DE OLIVEIRA\n    14/BR/NT/RO/11007/110149/7218656/7218656hospitalNA\n    ⋮⋮⋮⋮⋮\n    4148/BR/CO/GO/52004/521975/2437627/2437627hospitalHOSPITAL MUN DOM LUIZ FERNANDES SANTO ANTONIO DO DESCOBERTO\n    4149/BR/CO/GO/52010/522010/2442671/2442671hospitalHOSPITAL MONTES BELOS SAO LUIS DE MONTES BELOS\n    4150/BR/CO/GO/52001/522140/2570084/2570084hospitalHOSPITAL DE TRINDADE\n    4151/BR/CO/GO/52014/522160/9813349/9813349hospitalHOSPITAL SERRA DA MESA HSM\n    4152/BR/CO/DF/53001/530010/0010561/0010561hospitalHFA\n  \n  \n  \n    4153 rows × 4 columns"
  },
  {
    "objectID": "sections/table_locs.html#mesclando-escalas",
    "href": "sections/table_locs.html#mesclando-escalas",
    "title": "Localidades",
    "section": "Mesclando escalas",
    "text": "Mesclando escalas\nTodas numa só tabela\n\ndf_locs = dt.rbind(*[df_geos, df_hosp])\ndf_locs\n\n\n\n  \n  \n    nomeclaturanomeidentificadorescala\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0/BR/BrasilBRpais\n    1/BR/CO/Centro-OesteCOregiao\n    2/BR/ND/NordesteNDregiao\n    3/BR/NT/NorteNTregiao\n    4/BR/SD/SudesteSDregiao\n    5/BR/SL/SulSLregiao\n    6/BR/CO/DF/Distrito FederalDFuf\n    7/BR/CO/GO/GoiásGOuf\n    8/BR/CO/MS/Mato Grosso do SulMSuf\n    9/BR/CO/MT/Mato GrossoMTuf\n    10/BR/ND/AL/AlagoasALuf\n    11/BR/ND/BA/BahiaBAuf\n    12/BR/ND/CE/CearáCEuf\n    13/BR/ND/MA/MaranhãoMAuf\n    14/BR/ND/PB/ParaíbaPBuf\n    ⋮⋮⋮⋮⋮\n    10,189/BR/CO/GO/52004/521975/2437627/HOSPITAL MUN DOM LUIZ FERNANDES SANTO ANTONIO DO DESCOBERTO2437627hospital\n    10,190/BR/CO/GO/52010/522010/2442671/HOSPITAL MONTES BELOS SAO LUIS DE MONTES BELOS2442671hospital\n    10,191/BR/CO/GO/52001/522140/2570084/HOSPITAL DE TRINDADE2570084hospital\n    10,192/BR/CO/GO/52014/522160/9813349/HOSPITAL SERRA DA MESA HSM9813349hospital\n    10,193/BR/CO/DF/53001/530010/0010561/HFA0010561hospital\n  \n  \n  \n    10,194 rows × 4 columns\n  \n\n\n\n\nOrdem colunas\n\ncols_order = [\n  'escala',\n  'nomeclatura',\n  'identificador',\n  'nome',\n]\n\n\ndf_locs = df_locs[:, cols_order]\ndf_locs\n\n\n\n  \n  \n    escalanomeclaturaidentificadornome\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0pais/BR/BRBrasil\n    1regiao/BR/CO/COCentro-Oeste\n    2regiao/BR/ND/NDNordeste\n    3regiao/BR/NT/NTNorte\n    4regiao/BR/SD/SDSudeste\n    5regiao/BR/SL/SLSul\n    6uf/BR/CO/DF/DFDistrito Federal\n    7uf/BR/CO/GO/GOGoiás\n    8uf/BR/CO/MS/MSMato Grosso do Sul\n    9uf/BR/CO/MT/MTMato Grosso\n    10uf/BR/ND/AL/ALAlagoas\n    11uf/BR/ND/BA/BABahia\n    12uf/BR/ND/CE/CECeará\n    13uf/BR/ND/MA/MAMaranhão\n    14uf/BR/ND/PB/PBParaíba\n    ⋮⋮⋮⋮⋮\n    10,189hospital/BR/CO/GO/52004/521975/2437627/2437627HOSPITAL MUN DOM LUIZ FERNANDES SANTO ANTONIO DO DESCOBERTO\n    10,190hospital/BR/CO/GO/52010/522010/2442671/2442671HOSPITAL MONTES BELOS SAO LUIS DE MONTES BELOS\n    10,191hospital/BR/CO/GO/52001/522140/2570084/2570084HOSPITAL DE TRINDADE\n    10,192hospital/BR/CO/GO/52014/522160/9813349/9813349HOSPITAL SERRA DA MESA HSM\n    10,193hospital/BR/CO/DF/53001/530010/0010561/0010561HFA\n  \n  \n  \n    10,194 rows × 4 columns"
  },
  {
    "objectID": "sections/table_nomes.html",
    "href": "sections/table_nomes.html",
    "title": "Nomeclaturas",
    "section": "",
    "text": "from utils import get_path\nfrom datatable import dt, f as dtf, by, as_type"
  },
  {
    "objectID": "sections/table_nomes.html#municípios",
    "href": "sections/table_nomes.html#municípios",
    "title": "Nomeclaturas",
    "section": "Municípios",
    "text": "Municípios\n\nColunas da tabela\n\npath_munic = get_path('LOCALIDADES', 'municipios.csv.gzip')\ndf_munic = dt.fread(path_munic, columns={'regiao': 'nome_regiao'})\ndf_munic\n\n\n\n  \n  \n    cod_municipionome_municipiocapitalufcod_ufnome_ufnome_regiaolatitudelongitude\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0520005Abadia de Goiás0GO52GoiásCentro-Oeste−16.7573−49.4412\n    1310010Abadia dos Dourados0MG31Minas GeraisSudeste−18.4831−47.3916\n    2520010Abadiânia0GO52GoiásCentro-Oeste−16.197−48.7057\n    3310020Abaeté0MG31Minas GeraisSudeste−19.1551−45.4444\n    4150010Abaetetuba0PA15ParáNorte−1.72183−48.8788\n    5230010Abaiara0CE23CearáNordeste−7.34588−39.0416\n    6290010Abaíra0BA29BahiaNordeste−13.2488−41.6619\n    7290020Abaré0BA29BahiaNordeste−8.72073−39.1162\n    8410010Abatiá0PR41ParanáSul−23.3049−50.3133\n    9420005Abdon Batista0SC42Santa CatarinaSul−27.6126−51.0233\n    10150013Abel Figueiredo0PA15ParáNorte−4.95333−48.3933\n    11420010Abelardo Luz0SC42Santa CatarinaSul−26.5716−52.3229\n    12310030Abre Campo0MG31Minas GeraisSudeste−20.2996−42.4743\n    13260005Abreu e Lima0PE26PernambucoNordeste−7.90072−34.8984\n    14170025Abreulândia0TO17TocantinsNorte−9.62101−49.1518\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    5565293360Xique-Xique0BA29BahiaNordeste−10.823−42.7245\n    5566251740Zabelê0PB25ParaíbaNordeste−8.07901−37.1057\n    5567355715Zacarias0SP35São PauloSudeste−21.0506−50.0552\n    5568211400Zé Doca0MA21MaranhãoNordeste−3.27014−45.6553\n    5569421985Zortéa0SC42Santa CatarinaSul−27.4521−51.552\n  \n  \n  \n    5570 rows × 9 columns"
  },
  {
    "objectID": "sections/table_nomes.html#indicadores",
    "href": "sections/table_nomes.html#indicadores",
    "title": "Nomeclaturas",
    "section": "Indicadores",
    "text": "Indicadores\n\nColunas da tabela\n\ncols_indc = {\n  'CÓDIGO': 'codigo',\n  'Tipo Localidade': 'tipo',\n  'CIR': 'nome_regiao_saude',\n  'Grupos de Regiões de Saúde segundo Condições Socioeconômicas e de Saúde - 2016': 'socioecon',\n  ...: None\n}\n\n\npath_indc = path_indc = get_path('INDICADORES', 'indicadores.csv.gzip')\ndf_indc = dt.fread(path_indc, columns=cols_indc)\ndf_indc = df_indc.to_pandas()\ndf_indc\n\n\n\n\n\n  \n    \n      \n      codigo\n      tipo\n      nome_regiao_saude\n      socioecon\n    \n  \n  \n    \n      0\n      15.001\n      REGSAU\n      Araguaia\n      1\n    \n    \n      1\n      15.002\n      REGSAU\n      Baixo Amazonas\n      1\n    \n    \n      2\n      15.003\n      REGSAU\n      Carajás\n      2\n    \n    \n      3\n      15.004\n      REGSAU\n      Lago de Tucuruí\n      1\n    \n    \n      4\n      15.013\n      REGSAU\n      Marajó I\n      1\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      6003\n      171.780\n      MUNIC\n      Sudeste\n      1\n    \n    \n      6004\n      171.800\n      MUNIC\n      Sudeste\n      1\n    \n    \n      6005\n      171.865\n      MUNIC\n      Sudeste\n      1\n    \n    \n      6006\n      172.090\n      MUNIC\n      Sudeste\n      1\n    \n    \n      6007\n      172.093\n      MUNIC\n      Sudeste\n      1\n    \n  \n\n6008 rows × 4 columns\n\n\n\n\n\nIndicadores por município\n\ndf_mun = df_indc.loc[df_indc['tipo'] == 'MUNIC'].copy()\ndf_mun.drop(columns=['tipo'], inplace=True)\ndf_mun['codigo'] = df_mun['codigo'].apply(lambda x: (str(x).replace('.', '') + '00')[:6])\ndf_mun['prefix'] = df_mun['codigo'].apply(lambda x: str(x)[:2])\ndf_mun = df_mun.rename(columns={'codigo': 'cod_municipio'})\ndf_mun\n\n\n\n\n\n  \n    \n      \n      cod_municipio\n      nome_regiao_saude\n      socioecon\n      prefix\n    \n  \n  \n    \n      13\n      310600\n      João Monlevade\n      3\n      31\n    \n    \n      14\n      313620\n      João Monlevade\n      3\n      31\n    \n    \n      15\n      314470\n      João Monlevade\n      3\n      31\n    \n    \n      16\n      315570\n      João Monlevade\n      3\n      31\n    \n    \n      17\n      316100\n      João Monlevade\n      3\n      31\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      6003\n      171780\n      Sudeste\n      1\n      17\n    \n    \n      6004\n      171800\n      Sudeste\n      1\n      17\n    \n    \n      6005\n      171865\n      Sudeste\n      1\n      17\n    \n    \n      6006\n      172090\n      Sudeste\n      1\n      17\n    \n    \n      6007\n      172093\n      Sudeste\n      1\n      17\n    \n  \n\n5570 rows × 4 columns\n\n\n\n\n\nIndicadores por Região de Saúde\n\ndf_regsau = df_indc[df_indc['tipo'] == 'REGSAU'].copy()\ndf_regsau.drop(columns=['tipo', 'socioecon'], inplace=True)\ndf_regsau['codigo'] = df_regsau['codigo'].apply(lambda x: (str(x).replace('.', '') + '0')[:5])\ndf_regsau['prefix'] = df_regsau['codigo'].apply(lambda x: str(x)[:2])\ndf_regsau = df_regsau.rename(columns={'codigo': 'cod_regiao_saude'})\ndf_regsau\n\n\n\n\n\n  \n    \n      \n      cod_regiao_saude\n      nome_regiao_saude\n      prefix\n    \n  \n  \n    \n      0\n      15001\n      Araguaia\n      15\n    \n    \n      1\n      15002\n      Baixo Amazonas\n      15\n    \n    \n      2\n      15003\n      Carajás\n      15\n    \n    \n      3\n      15004\n      Lago de Tucuruí\n      15\n    \n    \n      4\n      15013\n      Marajó I\n      15\n    \n    \n      ...\n      ...\n      ...\n      ...\n    \n    \n      5431\n      17001\n      Médio Norte Araguaia\n      17\n    \n    \n      5432\n      28005\n      Nossa Senhora da Glória\n      28\n    \n    \n      5433\n      28006\n      Nossa Senhora do Socorro\n      28\n    \n    \n      5434\n      28007\n      Propriá\n      28\n    \n    \n      5435\n      17003\n      Sudeste\n      17\n    \n  \n\n438 rows × 3 columns\n\n\n\n\n\nMerge\n\ndf_indc = df_mun.merge(df_regsau, how='left', left_on=['prefix', 'nome_regiao_saude'], right_on=['prefix', 'nome_regiao_saude'])\ndf_indc = dt.Frame(df_indc)\ndf_indc[:, 'cod_municipio'] = df_indc[:, dt.as_type(dtf.cod_municipio, int)]\ndf_indc\n\n\n\n  \n  \n    cod_municipionome_regiao_saudesocioeconprefixcod_regiao_saude\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0310600João Monlevade33131035\n    1313620João Monlevade33131035\n    2314470João Monlevade33131035\n    3315570João Monlevade33131035\n    4316100João Monlevade33131035\n    5310855João Pinheiro23131036\n    6313630João Pinheiro23131036\n    7313753João Pinheiro23131036\n    8310280Juiz de Fora Lima Duarte Bom Jardim Min53131037\n    9310360Juiz de Fora Lima Duarte Bom Jardim Min53131037\n    10310610Juiz de Fora Lima Duarte Bom Jardim Min53131037\n    11310680Juiz de Fora Lima Duarte Bom Jardim Min53131037\n    12310720Juiz de Fora Lima Duarte Bom Jardim Min53131037\n    13310750Juiz de Fora Lima Duarte Bom Jardim Min53131037\n    14311590Juiz de Fora Lima Duarte Bom Jardim Min53131037\n    ⋮⋮⋮⋮⋮⋮\n    5565171780Sudeste11717003\n    5566171800Sudeste11717003\n    5567171865Sudeste11717003\n    5568172090Sudeste11717003\n    5569172093Sudeste11717003\n  \n  \n  \n    5570 rows × 5 columns"
  },
  {
    "objectID": "sections/table_nomes.html#juntando-com-outras",
    "href": "sections/table_nomes.html#juntando-com-outras",
    "title": "Nomeclaturas",
    "section": "Juntando com outras",
    "text": "Juntando com outras\n\nJuntando com Indicadores\n\ndf_indc.key = 'cod_municipio'\ndf_locs = df_munic[:, :, dt.join(df_indc)]\ndf_locs\n\n\n\n  \n  \n    cod_municipionome_municipiocapitalufcod_ufnome_ufnome_regiaolatitudelongitudenome_regiao_saudesocioeconprefixcod_regiao_saude\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0520005Abadia de Goiás0GO52GoiásCentro-Oeste−16.7573−49.4412Central55252001\n    1310010Abadia dos Dourados0MG31Minas GeraisSudeste−18.4831−47.3916Patrocínio Monte Carmelo23131052\n    2520010Abadiânia0GO52GoiásCentro-Oeste−16.197−48.7057Pirineus35252011\n    3310020Abaeté0MG31Minas GeraisSudeste−19.1551−45.4444Sete Lagoas33131067\n    4150010Abaetetuba0PA15ParáNorte−1.72183−48.8788Tocantins11515011\n    5230010Abaiara0CE23CearáNordeste−7.34588−39.041619ª Região Brejo Santo12323019\n    6290010Abaíra0BA29BahiaNordeste−13.2488−41.6619Seabra12929023\n    7290020Abaré0BA29BahiaNordeste−8.72073−39.1162Paulo Afonso12929017\n    8410010Abatiá0PR41ParanáSul−23.3049−50.313318ª RS Cornélio Procópio34141018\n    9420005Abdon Batista0SC42Santa CatarinaSul−27.6126−51.0233Meio Oeste34242008\n    10150013Abel Figueiredo0PA15ParáNorte−4.95333−48.3933Carajás21515003\n    11420010Abelardo Luz0SC42Santa CatarinaSul−26.5716−52.3229Xanxerê34242003\n    12310030Abre Campo0MG31Minas GeraisSudeste−20.2996−42.4743Manhuaçu13131041\n    13260005Abreu e Lima0PE26PernambucoNordeste−7.90072−34.8984Recife52626010\n    14170025Abreulândia0TO17TocantinsNorte−9.62101−49.1518Cantão21717007\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    5565293360Xique-Xique0BA29BahiaNordeste−10.823−42.7245Irecê12929010\n    5566251740Zabelê0PB25ParaíbaNordeste−8.07901−37.10575ª Região12525005\n    5567355715Zacarias0SP35São PauloSudeste−21.0506−50.0552José Bonifácio33535156\n    5568211400Zé Doca0MA21MaranhãoNordeste−3.27014−45.6553Zé Doca12121019\n    5569421985Zortéa0SC42Santa CatarinaSul−27.4521−51.552Meio Oeste34242008\n  \n  \n  \n    5570 rows × 13 columns"
  },
  {
    "objectID": "sections/table_nomes.html#sigla-região",
    "href": "sections/table_nomes.html#sigla-região",
    "title": "Nomeclaturas",
    "section": "Sigla Região",
    "text": "Sigla Região\n\nsigla_regioes = {\n  'Norte': 'NT',\n  'Nordeste': 'ND',\n  'Centro-Oeste': 'CO',\n  'Sudeste': 'SD',\n  'Sul': 'SL',\n}\n\n\nsiglas_regs = df_locs[:, 'nome_regiao'].to_pandas()['nome_regiao'].map(sigla_regioes)\ndf_locs[:, 'sigla_regiao'] = siglas_regs\ndf_locs\n\n\n\n  \n  \n    cod_municipionome_municipiocapitalufcod_ufnome_ufnome_regiaolatitudelongitudenome_regiao_saudesocioeconprefixcod_regiao_saudesigla_regiao\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0520005Abadia de Goiás0GO52GoiásCentro-Oeste−16.7573−49.4412Central55252001CO\n    1310010Abadia dos Dourados0MG31Minas GeraisSudeste−18.4831−47.3916Patrocínio Monte Carmelo23131052SD\n    2520010Abadiânia0GO52GoiásCentro-Oeste−16.197−48.7057Pirineus35252011CO\n    3310020Abaeté0MG31Minas GeraisSudeste−19.1551−45.4444Sete Lagoas33131067SD\n    4150010Abaetetuba0PA15ParáNorte−1.72183−48.8788Tocantins11515011NT\n    5230010Abaiara0CE23CearáNordeste−7.34588−39.041619ª Região Brejo Santo12323019ND\n    6290010Abaíra0BA29BahiaNordeste−13.2488−41.6619Seabra12929023ND\n    7290020Abaré0BA29BahiaNordeste−8.72073−39.1162Paulo Afonso12929017ND\n    8410010Abatiá0PR41ParanáSul−23.3049−50.313318ª RS Cornélio Procópio34141018SL\n    9420005Abdon Batista0SC42Santa CatarinaSul−27.6126−51.0233Meio Oeste34242008SL\n    10150013Abel Figueiredo0PA15ParáNorte−4.95333−48.3933Carajás21515003NT\n    11420010Abelardo Luz0SC42Santa CatarinaSul−26.5716−52.3229Xanxerê34242003SL\n    12310030Abre Campo0MG31Minas GeraisSudeste−20.2996−42.4743Manhuaçu13131041SD\n    13260005Abreu e Lima0PE26PernambucoNordeste−7.90072−34.8984Recife52626010ND\n    14170025Abreulândia0TO17TocantinsNorte−9.62101−49.1518Cantão21717007NT\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    5565293360Xique-Xique0BA29BahiaNordeste−10.823−42.7245Irecê12929010ND\n    5566251740Zabelê0PB25ParaíbaNordeste−8.07901−37.10575ª Região12525005ND\n    5567355715Zacarias0SP35São PauloSudeste−21.0506−50.0552José Bonifácio33535156SD\n    5568211400Zé Doca0MA21MaranhãoNordeste−3.27014−45.6553Zé Doca12121019ND\n    5569421985Zortéa0SC42Santa CatarinaSul−27.4521−51.552Meio Oeste34242008SL\n  \n  \n  \n    5570 rows × 14 columns"
  },
  {
    "objectID": "sections/table_nomes.html#criando-código-concatenado",
    "href": "sections/table_nomes.html#criando-código-concatenado",
    "title": "Nomeclaturas",
    "section": "Criando código concatenado",
    "text": "Criando código concatenado\n\n\ncodigos = list()\ndf_locs_pd = df_locs.to_pandas()\nfor i, row in df_locs_pd.iterrows():\n  codigo = f\"/BR/{row['sigla_regiao']}/{row['uf']}/{row['cod_regiao_saude']}/{row['cod_municipio']}/\"\n  codigos.append(codigo)\ndf_locs_pd['codigo'] = codigos\ndf_locs_pd['sigla_pais'] = 'BR'\ndf_locs_pd['nome_pais'] = 'Brasil'\ndf_locs_pd = df_locs_pd.rename(columns={'codigo': 'nomeclatura'})\ndf_locs = dt.Frame(df_locs_pd)\ndf_locs\n\n\n\n  \n  \n    cod_municipionome_municipiocapitalufcod_ufnome_ufnome_regiaolatitudelongitudenome_regiao_saude…cod_regiao_saudesigla_regiaonomeclaturasigla_paisnome_pais\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0520005Abadia de Goiás0GO52GoiásCentro-Oeste−16.7573−49.4412Central…52001CO/BR/CO/GO/52001/520005/BRBrasil\n    1310010Abadia dos Dourados0MG31Minas GeraisSudeste−18.4831−47.3916Patrocínio Monte Carmelo…31052SD/BR/SD/MG/31052/310010/BRBrasil\n    2520010Abadiânia0GO52GoiásCentro-Oeste−16.197−48.7057Pirineus…52011CO/BR/CO/GO/52011/520010/BRBrasil\n    3310020Abaeté0MG31Minas GeraisSudeste−19.1551−45.4444Sete Lagoas…31067SD/BR/SD/MG/31067/310020/BRBrasil\n    4150010Abaetetuba0PA15ParáNorte−1.72183−48.8788Tocantins…15011NT/BR/NT/PA/15011/150010/BRBrasil\n    5230010Abaiara0CE23CearáNordeste−7.34588−39.041619ª Região Brejo Santo…23019ND/BR/ND/CE/23019/230010/BRBrasil\n    6290010Abaíra0BA29BahiaNordeste−13.2488−41.6619Seabra…29023ND/BR/ND/BA/29023/290010/BRBrasil\n    7290020Abaré0BA29BahiaNordeste−8.72073−39.1162Paulo Afonso…29017ND/BR/ND/BA/29017/290020/BRBrasil\n    8410010Abatiá0PR41ParanáSul−23.3049−50.313318ª RS Cornélio Procópio…41018SL/BR/SL/PR/41018/410010/BRBrasil\n    9420005Abdon Batista0SC42Santa CatarinaSul−27.6126−51.0233Meio Oeste…42008SL/BR/SL/SC/42008/420005/BRBrasil\n    10150013Abel Figueiredo0PA15ParáNorte−4.95333−48.3933Carajás…15003NT/BR/NT/PA/15003/150013/BRBrasil\n    11420010Abelardo Luz0SC42Santa CatarinaSul−26.5716−52.3229Xanxerê…42003SL/BR/SL/SC/42003/420010/BRBrasil\n    12310030Abre Campo0MG31Minas GeraisSudeste−20.2996−42.4743Manhuaçu…31041SD/BR/SD/MG/31041/310030/BRBrasil\n    13260005Abreu e Lima0PE26PernambucoNordeste−7.90072−34.8984Recife…26010ND/BR/ND/PE/26010/260005/BRBrasil\n    14170025Abreulândia0TO17TocantinsNorte−9.62101−49.1518Cantão…17007NT/BR/NT/TO/17007/170025/BRBrasil\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    5565293360Xique-Xique0BA29BahiaNordeste−10.823−42.7245Irecê…29010ND/BR/ND/BA/29010/293360/BRBrasil\n    5566251740Zabelê0PB25ParaíbaNordeste−8.07901−37.10575ª Região…25005ND/BR/ND/PB/25005/251740/BRBrasil\n    5567355715Zacarias0SP35São PauloSudeste−21.0506−50.0552José Bonifácio…35156SD/BR/SD/SP/35156/355715/BRBrasil\n    5568211400Zé Doca0MA21MaranhãoNordeste−3.27014−45.6553Zé Doca…21019ND/BR/ND/MA/21019/211400/BRBrasil\n    5569421985Zortéa0SC42Santa CatarinaSul−27.4521−51.552Meio Oeste…42008SL/BR/SL/SC/42008/421985/BRBrasil\n  \n  \n  \n    5570 rows × 17 columns"
  },
  {
    "objectID": "sections/table_nomes.html#ajustando-colunas",
    "href": "sections/table_nomes.html#ajustando-colunas",
    "title": "Nomeclaturas",
    "section": "Ajustando colunas",
    "text": "Ajustando colunas\n\ncols_order = [\n  'nomeclatura',\n  'cod_municipio',\n  'nome_municipio',\n  'capital',\n  'cod_regiao_saude',\n  'nome_regiao_saude',\n  'cod_uf',\n  'uf',\n  'nome_uf',\n  'sigla_regiao',\n  'nome_regiao',\n  'sigla_pais',\n  'nome_pais',\n  'socioecon',\n  'latitude',\n  'longitude',\n]\n\n\ndf_locs = df_locs[:, cols_order]\ndf_locs\n\n\n\n  \n  \n    nomeclaturacod_municipionome_municipiocapitalcod_regiao_saudenome_regiao_saudecod_ufufnome_ufsigla_regiao…sigla_paisnome_paissocioeconlatitudelongitude\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0/BR/CO/GO/52001/520005/520005Abadia de Goiás052001Central52GOGoiásCO…BRBrasil5−16.7573−49.4412\n    1/BR/SD/MG/31052/310010/310010Abadia dos Dourados031052Patrocínio Monte Carmelo31MGMinas GeraisSD…BRBrasil2−18.4831−47.3916\n    2/BR/CO/GO/52011/520010/520010Abadiânia052011Pirineus52GOGoiásCO…BRBrasil3−16.197−48.7057\n    3/BR/SD/MG/31067/310020/310020Abaeté031067Sete Lagoas31MGMinas GeraisSD…BRBrasil3−19.1551−45.4444\n    4/BR/NT/PA/15011/150010/150010Abaetetuba015011Tocantins15PAParáNT…BRBrasil1−1.72183−48.8788\n    5/BR/ND/CE/23019/230010/230010Abaiara02301919ª Região Brejo Santo23CECearáND…BRBrasil1−7.34588−39.0416\n    6/BR/ND/BA/29023/290010/290010Abaíra029023Seabra29BABahiaND…BRBrasil1−13.2488−41.6619\n    7/BR/ND/BA/29017/290020/290020Abaré029017Paulo Afonso29BABahiaND…BRBrasil1−8.72073−39.1162\n    8/BR/SL/PR/41018/410010/410010Abatiá04101818ª RS Cornélio Procópio41PRParanáSL…BRBrasil3−23.3049−50.3133\n    9/BR/SL/SC/42008/420005/420005Abdon Batista042008Meio Oeste42SCSanta CatarinaSL…BRBrasil3−27.6126−51.0233\n    10/BR/NT/PA/15003/150013/150013Abel Figueiredo015003Carajás15PAParáNT…BRBrasil2−4.95333−48.3933\n    11/BR/SL/SC/42003/420010/420010Abelardo Luz042003Xanxerê42SCSanta CatarinaSL…BRBrasil3−26.5716−52.3229\n    12/BR/SD/MG/31041/310030/310030Abre Campo031041Manhuaçu31MGMinas GeraisSD…BRBrasil1−20.2996−42.4743\n    13/BR/ND/PE/26010/260005/260005Abreu e Lima026010Recife26PEPernambucoND…BRBrasil5−7.90072−34.8984\n    14/BR/NT/TO/17007/170025/170025Abreulândia017007Cantão17TOTocantinsNT…BRBrasil2−9.62101−49.1518\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    5565/BR/ND/BA/29010/293360/293360Xique-Xique029010Irecê29BABahiaND…BRBrasil1−10.823−42.7245\n    5566/BR/ND/PB/25005/251740/251740Zabelê0250055ª Região25PBParaíbaND…BRBrasil1−8.07901−37.1057\n    5567/BR/SD/SP/35156/355715/355715Zacarias035156José Bonifácio35SPSão PauloSD…BRBrasil3−21.0506−50.0552\n    5568/BR/ND/MA/21019/211400/211400Zé Doca021019Zé Doca21MAMaranhãoND…BRBrasil1−3.27014−45.6553\n    5569/BR/SL/SC/42008/421985/421985Zortéa042008Meio Oeste42SCSanta CatarinaSL…BRBrasil3−27.4521−51.552\n  \n  \n  \n    5570 rows × 16 columns"
  },
  {
    "objectID": "sections/table_procs.html",
    "href": "sections/table_procs.html",
    "title": "Procedimentos",
    "section": "",
    "text": "import pandas as pd\nfrom utils import get_path, group_cols\nfrom datatable import dt, f, by, join, as_type"
  },
  {
    "objectID": "sections/table_procs.html#localidades",
    "href": "sections/table_procs.html#localidades",
    "title": "Procedimentos",
    "section": "Localidades",
    "text": "Localidades\n\npath_locs = get_path('LOCALIDADES', 'localidades.csv.gzip')\ndf_locs = dt.fread(path_locs)\ndf_locs\n\n\n\n  \n  \n    nomeclaturacod_municipionome_municipiocapitalcod_regiao_saudenome_regiao_saudecod_ufufnome_ufsigla_regiaonome_regiaosocioeconlatitudelongitude\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0/BR/CO/GO/52001/520005/520005Abadia de Goiás052001Central52GOGoiásCOCentro-Oeste5−16.7573−49.4412\n    1/BR/SD/MG/31052/310010/310010Abadia dos Dourados031052Patrocínio Monte Carmelo31MGMinas GeraisSDSudeste2−18.4831−47.3916\n    2/BR/CO/GO/52011/520010/520010Abadiânia052011Pirineus52GOGoiásCOCentro-Oeste3−16.197−48.7057\n    3/BR/SD/MG/31067/310020/310020Abaeté031067Sete Lagoas31MGMinas GeraisSDSudeste3−19.1551−45.4444\n    4/BR/NT/PA/15011/150010/150010Abaetetuba015011Tocantins15PAParáNTNorte1−1.72183−48.8788\n    5/BR/ND/CE/23019/230010/230010Abaiara02301919ª Região Brejo Santo23CECearáNDNordeste1−7.34588−39.0416\n    6/BR/ND/BA/29023/290010/290010Abaíra029023Seabra29BABahiaNDNordeste1−13.2488−41.6619\n    7/BR/ND/BA/29017/290020/290020Abaré029017Paulo Afonso29BABahiaNDNordeste1−8.72073−39.1162\n    8/BR/SL/PR/41018/410010/410010Abatiá04101818ª RS Cornélio Procópio41PRParanáSLSul3−23.3049−50.3133\n    9/BR/SL/SC/42008/420005/420005Abdon Batista042008Meio Oeste42SCSanta CatarinaSLSul3−27.6126−51.0233\n    10/BR/NT/PA/15003/150013/150013Abel Figueiredo015003Carajás15PAParáNTNorte2−4.95333−48.3933\n    11/BR/SL/SC/42003/420010/420010Abelardo Luz042003Xanxerê42SCSanta CatarinaSLSul3−26.5716−52.3229\n    12/BR/SD/MG/31041/310030/310030Abre Campo031041Manhuaçu31MGMinas GeraisSDSudeste1−20.2996−42.4743\n    13/BR/ND/PE/26010/260005/260005Abreu e Lima026010Recife26PEPernambucoNDNordeste5−7.90072−34.8984\n    14/BR/NT/TO/17007/170025/170025Abreulândia017007Cantão17TOTocantinsNTNorte2−9.62101−49.1518\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    5565/BR/ND/BA/29010/293360/293360Xique-Xique029010Irecê29BABahiaNDNordeste1−10.823−42.7245\n    5566/BR/ND/PB/25005/251740/251740Zabelê0250055ª Região25PBParaíbaNDNordeste1−8.07901−37.1057\n    5567/BR/SD/SP/35156/355715/355715Zacarias035156José Bonifácio35SPSão PauloSDSudeste3−21.0506−50.0552\n    5568/BR/ND/MA/21019/211400/211400Zé Doca021019Zé Doca21MAMaranhãoNDNordeste1−3.27014−45.6553\n    5569/BR/SL/SC/42008/421985/421985Zortéa042008Meio Oeste42SCSanta CatarinaSLSul3−27.4521−51.552\n  \n  \n  \n    5570 rows × 14 columns"
  },
  {
    "objectID": "sections/table_procs.html#distâncias",
    "href": "sections/table_procs.html#distâncias",
    "title": "Procedimentos",
    "section": "Distâncias",
    "text": "Distâncias\n\ncols_dist = {\n  'origem': 'origem',\n  'destino': 'destino',\n  'km (osm)': 'km (osm)',\n  'min (osm)': 'min (osm)',\n  ...: None,\n}\n\n\npath_dist = get_path('GESTANTES', f'gmaps/routes_osm_gmaps.csv.gzip')\ndf_dist = dt.fread(path_dist, columns=cols_dist)\ndf_dist\n\n\n\n  \n  \n    origemdestinokm (osm)min (osm)\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000100\n    1110001110002309.05370.143\n    211000111000481.2011115.065\n    3110001110006353.417332.393\n    4110001110009145.678140.76\n    5110001110012130.77152.868\n    6110001110013357.511427.84\n    7110001110015172.926191.055\n    8110001110018114.061112.283\n    9110001110020505.856549.908\n    1011000111002596.6065119.132\n    1111000111002848.609950.14\n    12110001110030297.455283.118\n    13110001110149217.355220.427\n    14110001110150153.337170.73\n    ⋮⋮⋮⋮⋮\n    76,533530010522020515.668411.118\n    76,534530010522045207.413183.168\n    76,535530010522068255.555200.28\n    76,536530010522200161.729141.36\n    76,53753001053001000\n  \n  \n  \n    76,538 rows × 4 columns"
  },
  {
    "objectID": "sections/table_procs.html#sih",
    "href": "sections/table_procs.html#sih",
    "title": "Procedimentos",
    "section": "SIH",
    "text": "SIH\n\npath_sih = get_path('SIH', 'sih.jay')\ndf_sih = dt.fread(path_sih)\ndf_sih\n\n\n\n  \n  \n    origemdestinocnesanoprocedimentocount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000126794772010310010039141\n    11100011100012679477201041101003449\n    21100011100012679477201131001003995\n    31100011100012679477201141101003431\n    41100011100012679477201231001003973\n    51100011100012679477201241101003428\n    61100011100012679477201331001003967\n    71100011100012679477201341101003425\n    81100011100012679477201431001003946\n    91100011100012679477201441101003457\n    101100011100012679477201531001003936\n    111100011100012679477201541101003457\n    121100011100012679477201631001003947\n    131100011100012679477201641101003433\n    141100011100012679477201731001003947\n    ⋮⋮⋮⋮⋮⋮⋮\n    608,89853001053001057175152018411010034737\n    608,8995300105300105717515201841101004211\n    608,900530010530010571751520193100100391086\n    608,90153001053001057175152019411010034839\n    608,9025300105300105717515201941101004222\n  \n  \n  \n    608,903 rows × 6 columns\n  \n\n\n\n\nAtualizando variável parto normal\n\nprocs_partos = {\n  411010034: 'C_', # 'PARTO CESARIANO',\n  411010042: 'C_L', # 'PARTO CESARIANO C/ LAQUEADURA TUBARINA',\n  411010026: 'C_R', # 'PARTO CESARIANO EM GESTACAO DE ALTO RISCO',\n  310010039: 'N_', # 'PARTO NORMAL',\n  310010055: 'N_C', # 'PARTO NORMAL EM CENTRO DE PARTO NORMAL (CPN)',\n  310010047: 'N_R', # 'PARTO NORMAL EM GESTACAO DE ALTO RISCO',\n  310010012: 'N_A', # 'ASSISTÊNCIA AO PARTO SEM DISTOCIA',\n}\n\n\ndf_sih = df_sih.to_pandas()\ndf_sih['procedimento'] = df_sih['procedimento'].map(procs_partos)\ndf_sih\n\n\n\n\n\n  \n    \n      \n      origem\n      destino\n      cnes\n      ano\n      procedimento\n      count\n    \n  \n  \n    \n      0\n      110001\n      110001\n      2679477\n      2010\n      N_\n      141\n    \n    \n      1\n      110001\n      110001\n      2679477\n      2010\n      C_\n      49\n    \n    \n      2\n      110001\n      110001\n      2679477\n      2011\n      N_\n      95\n    \n    \n      3\n      110001\n      110001\n      2679477\n      2011\n      C_\n      31\n    \n    \n      4\n      110001\n      110001\n      2679477\n      2012\n      N_\n      73\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      608898\n      530010\n      530010\n      5717515\n      2018\n      C_\n      737\n    \n    \n      608899\n      530010\n      530010\n      5717515\n      2018\n      C_L\n      11\n    \n    \n      608900\n      530010\n      530010\n      5717515\n      2019\n      N_\n      1086\n    \n    \n      608901\n      530010\n      530010\n      5717515\n      2019\n      C_\n      839\n    \n    \n      608902\n      530010\n      530010\n      5717515\n      2019\n      C_L\n      22\n    \n  \n\n608903 rows × 6 columns\n\n\n\n\ndf_sih['procedimento'].value_counts()\n\nN_     243181\nC_     218671\nC_R     66250\nN_R     47923\nC_L     30955\nN_C      1923\nName: procedimento, dtype: int64"
  },
  {
    "objectID": "sections/table_procs.html#colunas-origem-destino",
    "href": "sections/table_procs.html#colunas-origem-destino",
    "title": "Procedimentos",
    "section": "Colunas origem & destino",
    "text": "Colunas origem & destino\n\ndef add_info_cols(df, cols, ref):\n  df_codes = df[:, cols]\n  df_codes.names = {cols[0]: ref}\n  df_codes.names = {c: f'{ref}_{c}' for c in cols[1:]}\n  df_codes.key = ref\n  return df_codes\n\n\ncols = ['cod_municipio', 'nomeclatura', 'socioecon', 'capital', 'latitude', 'longitude']\ndf_origem = add_info_cols(df_locs, cols, 'origem')\ndf_destino = add_info_cols(df_locs, cols, 'destino')\n\n\ndf_proc = dt.Frame(df_sih)[:, :, join(df_origem)]\ndf_proc = df_proc[:, :, join(df_destino)]\ndf_proc\n\n\n\n  \n  \n    origemdestinocnesanoprocedimentocountorigem_nomeclaturaorigem_socioeconorigem_capitalorigem_latitude…destino_nomeclaturadestino_socioecondestino_capitaldestino_latitudedestino_longitude\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000126794772010N_141/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    111000111000126794772010C_49/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    211000111000126794772011N_95/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    311000111000126794772011C_31/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    411000111000126794772012N_73/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    511000111000126794772012C_28/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    611000111000126794772013N_67/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    711000111000126794772013C_25/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    811000111000126794772014N_46/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    911000111000126794772014C_57/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    1011000111000126794772015N_36/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    1111000111000126794772015C_57/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    1211000111000126794772016N_47/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    1311000111000126794772016C_33/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    1411000111000126794772017N_47/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/10−11.9283−61.9953\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    608,89853001053001057175152018C_737/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/51−15.7795−47.9297\n    608,89953001053001057175152018C_L11/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/51−15.7795−47.9297\n    608,90053001053001057175152019N_1086/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/51−15.7795−47.9297\n    608,90153001053001057175152019C_839/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/51−15.7795−47.9297\n    608,90253001053001057175152019C_L22/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/51−15.7795−47.9297\n  \n  \n  \n    608,903 rows × 16 columns"
  },
  {
    "objectID": "sections/table_procs.html#cnes-concatenado-ao-destino",
    "href": "sections/table_procs.html#cnes-concatenado-ao-destino",
    "title": "Procedimentos",
    "section": "CNES concatenado ao destino",
    "text": "CNES concatenado ao destino\n\ndf_proc['cnes'] = df_proc[:, as_type(f.cnes, str)]\ndf_proc[:, dt.update(cnes= ('0000000' + f.cnes)[-7:])]\ndf_proc[:, dt.update(destino_nomeclatura = f.destino_nomeclatura + f.cnes + '/')]\ndf_proc\n\n\n\n  \n  \n    origemdestinocnesanoprocedimentocountorigem_nomeclaturaorigem_socioeconorigem_capitalorigem_latitude…destino_nomeclaturadestino_socioecondestino_capitaldestino_latitudedestino_longitude\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000126794772010N_141/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    111000111000126794772010C_49/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    211000111000126794772011N_95/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    311000111000126794772011C_31/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    411000111000126794772012N_73/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    511000111000126794772012C_28/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    611000111000126794772013N_67/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    711000111000126794772013C_25/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    811000111000126794772014N_46/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    911000111000126794772014C_57/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    1011000111000126794772015N_36/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    1111000111000126794772015C_57/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    1211000111000126794772016N_47/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    1311000111000126794772016C_33/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    1411000111000126794772017N_47/BR/NT/RO/11005/110001/10−11.9283…/BR/NT/RO/11005/110001/2679477/10−11.9283−61.9953\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    608,89853001053001057175152018C_737/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/5717515/51−15.7795−47.9297\n    608,89953001053001057175152018C_L11/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/5717515/51−15.7795−47.9297\n    608,90053001053001057175152019N_1086/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/5717515/51−15.7795−47.9297\n    608,90153001053001057175152019C_839/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/5717515/51−15.7795−47.9297\n    608,90253001053001057175152019C_L22/BR/CO/DF/53001/530010/51−15.7795…/BR/CO/DF/53001/530010/5717515/51−15.7795−47.9297\n  \n  \n  \n    608,903 rows × 16 columns"
  },
  {
    "objectID": "sections/table_procs.html#colunas-de-distância-e-tempo",
    "href": "sections/table_procs.html#colunas-de-distância-e-tempo",
    "title": "Procedimentos",
    "section": "Colunas de distância e tempo",
    "text": "Colunas de distância e tempo\n\ndf_dist.key = ['origem', 'destino']\ndf_proc = df_proc[:, :, dt.join(df_dist)]\ndf_proc\n\n\n\n  \n  \n    origemdestinocnesanoprocedimentocountorigem_nomeclaturaorigem_socioeconorigem_capitalorigem_latitude…destino_capitaldestino_latitudedestino_longitudekm (osm)min (osm)\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000126794772010N_141/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    111000111000126794772010C_49/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    211000111000126794772011N_95/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    311000111000126794772011C_31/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    411000111000126794772012N_73/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    511000111000126794772012C_28/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    611000111000126794772013N_67/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    711000111000126794772013C_25/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    811000111000126794772014N_46/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    911000111000126794772014C_57/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    1011000111000126794772015N_36/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    1111000111000126794772015C_57/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    1211000111000126794772016N_47/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    1311000111000126794772016C_33/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    1411000111000126794772017N_47/BR/NT/RO/11005/110001/10−11.9283…0−11.9283−61.995300\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    608,89853001053001057175152018C_737/BR/CO/DF/53001/530010/51−15.7795…1−15.7795−47.929700\n    608,89953001053001057175152018C_L11/BR/CO/DF/53001/530010/51−15.7795…1−15.7795−47.929700\n    608,90053001053001057175152019N_1086/BR/CO/DF/53001/530010/51−15.7795…1−15.7795−47.929700\n    608,90153001053001057175152019C_839/BR/CO/DF/53001/530010/51−15.7795…1−15.7795−47.929700\n    608,90253001053001057175152019C_L22/BR/CO/DF/53001/530010/51−15.7795…1−15.7795−47.929700\n  \n  \n  \n    608,903 rows × 18 columns"
  },
  {
    "objectID": "sections/table_procs.html#coluna-socioecon",
    "href": "sections/table_procs.html#coluna-socioecon",
    "title": "Procedimentos",
    "section": "Coluna socioecon",
    "text": "Coluna socioecon\n\ndf_proc['origem_socioecon'] = df_proc[:, as_type(f.origem_socioecon, str)]\ndf_proc['destino_socioecon'] = df_proc[:, as_type(f.destino_socioecon, str)]\ndf_proc[:, dt.update(socioecon = f.origem_socioecon + '_' + f.destino_socioecon)]\ndf_proc\n\n\n\n  \n  \n    origemdestinocnesanoprocedimentocountorigem_nomeclaturaorigem_socioeconorigem_capitalorigem_latitude…destino_latitudedestino_longitudekm (osm)min (osm)socioecon\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000126794772010N_141/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    111000111000126794772010C_49/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    211000111000126794772011N_95/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    311000111000126794772011C_31/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    411000111000126794772012N_73/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    511000111000126794772012C_28/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    611000111000126794772013N_67/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    711000111000126794772013C_25/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    811000111000126794772014N_46/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    911000111000126794772014C_57/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    1011000111000126794772015N_36/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    1111000111000126794772015C_57/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    1211000111000126794772016N_47/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    1311000111000126794772016C_33/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    1411000111000126794772017N_47/BR/NT/RO/11005/110001/10−11.9283…−11.9283−61.9953001_1\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    608,89853001053001057175152018C_737/BR/CO/DF/53001/530010/51−15.7795…−15.7795−47.9297005_5\n    608,89953001053001057175152018C_L11/BR/CO/DF/53001/530010/51−15.7795…−15.7795−47.9297005_5\n    608,90053001053001057175152019N_1086/BR/CO/DF/53001/530010/51−15.7795…−15.7795−47.9297005_5\n    608,90153001053001057175152019C_839/BR/CO/DF/53001/530010/51−15.7795…−15.7795−47.9297005_5\n    608,90253001053001057175152019C_L22/BR/CO/DF/53001/530010/51−15.7795…−15.7795−47.9297005_5\n  \n  \n  \n    608,903 rows × 19 columns"
  },
  {
    "objectID": "sections/table_procs.html#coluna-capitais",
    "href": "sections/table_procs.html#coluna-capitais",
    "title": "Procedimentos",
    "section": "Coluna capitais",
    "text": "Coluna capitais\n\ndf_proc['origem_capital'] = df_proc[:, as_type(f.origem_capital, int)]\ndf_proc['origem_capital'] = df_proc[:, as_type(f.origem_capital, str)]\ndf_proc['destino_capital'] = df_proc[:, as_type(f.destino_capital, int)]\ndf_proc['destino_capital'] = df_proc[:, as_type(f.destino_capital, str)]\ndf_proc[:, dt.update(capitais = f.origem_capital + '_' + f.destino_capital)]\ndf_proc\n\n\n\n  \n  \n    origemdestinocnesanoprocedimentocountorigem_nomeclaturaorigem_socioeconorigem_capitalorigem_latitude…destino_longitudekm (osm)min (osm)socioeconcapitais\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000126794772010N_141/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    111000111000126794772010C_49/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    211000111000126794772011N_95/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    311000111000126794772011C_31/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    411000111000126794772012N_73/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    511000111000126794772012C_28/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    611000111000126794772013N_67/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    711000111000126794772013C_25/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    811000111000126794772014N_46/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    911000111000126794772014C_57/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    1011000111000126794772015N_36/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    1111000111000126794772015C_57/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    1211000111000126794772016N_47/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    1311000111000126794772016C_33/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    1411000111000126794772017N_47/BR/NT/RO/11005/110001/10−11.9283…−61.9953001_10_0\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    608,89853001053001057175152018C_737/BR/CO/DF/53001/530010/51−15.7795…−47.9297005_51_1\n    608,89953001053001057175152018C_L11/BR/CO/DF/53001/530010/51−15.7795…−47.9297005_51_1\n    608,90053001053001057175152019N_1086/BR/CO/DF/53001/530010/51−15.7795…−47.9297005_51_1\n    608,90153001053001057175152019C_839/BR/CO/DF/53001/530010/51−15.7795…−47.9297005_51_1\n    608,90253001053001057175152019C_L22/BR/CO/DF/53001/530010/51−15.7795…−47.9297005_51_1\n  \n  \n  \n    608,903 rows × 20 columns"
  },
  {
    "objectID": "sections/table_procs.html#coluna-criticidade",
    "href": "sections/table_procs.html#coluna-criticidade",
    "title": "Procedimentos",
    "section": "Coluna criticidade",
    "text": "Coluna criticidade\n\ncrits = list()\norigins = df_proc[:, 'origem_nomeclatura'].to_list()[0]\ndestins = df_proc[:, 'destino_nomeclatura'].to_list()[0]\nfor ori, des in zip(origins, destins):\n  critic = 0\n  trim = ori\n  while trim not in des:\n    critic += 1\n    tr = [t for t in trim.split('/') if len(t) > 1]\n    trim = '/' + '/'.join(tr[:-1]) + '/'\n  crits.append(critic)\ndf_proc['criticidade'] = dt.Frame(crits)\ndf_proc\n\n\n\n  \n  \n    origemdestinocnesanoprocedimentocountorigem_nomeclaturaorigem_socioeconorigem_capitalorigem_latitude…km (osm)min (osm)socioeconcapitaiscriticidade\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    011000111000126794772010N_141/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    111000111000126794772010C_49/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    211000111000126794772011N_95/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    311000111000126794772011C_31/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    411000111000126794772012N_73/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    511000111000126794772012C_28/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    611000111000126794772013N_67/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    711000111000126794772013C_25/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    811000111000126794772014N_46/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    911000111000126794772014C_57/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    1011000111000126794772015N_36/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    1111000111000126794772015C_57/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    1211000111000126794772016N_47/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    1311000111000126794772016C_33/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    1411000111000126794772017N_47/BR/NT/RO/11005/110001/10−11.9283…001_10_00\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋱⋮⋮⋮⋮⋮\n    608,89853001053001057175152018C_737/BR/CO/DF/53001/530010/51−15.7795…005_51_10\n    608,89953001053001057175152018C_L11/BR/CO/DF/53001/530010/51−15.7795…005_51_10\n    608,90053001053001057175152019N_1086/BR/CO/DF/53001/530010/51−15.7795…005_51_10\n    608,90153001053001057175152019C_839/BR/CO/DF/53001/530010/51−15.7795…005_51_10\n    608,90253001053001057175152019C_L22/BR/CO/DF/53001/530010/51−15.7795…005_51_10\n  \n  \n  \n    608,903 rows × 21 columns"
  },
  {
    "objectID": "sections/table_procs.html#ajustando-colunas",
    "href": "sections/table_procs.html#ajustando-colunas",
    "title": "Procedimentos",
    "section": "Ajustando colunas",
    "text": "Ajustando colunas\n\ncols_order = [\n  'origem',\n  'destino',\n  'origem_nomeclatura',\n  'destino_nomeclatura',\n  'ano',\n  'procedimento',\n  'km (osm)',\n  'min (osm)',\n  # 'dist_pond',\n  # 'tempo_pond',\n  'criticidade',\n  'capitais',\n  'socioecon',\n  # 'origem_latitude',\n  # 'origem_longitude',\n  # 'destino_latitude',\n  # 'destino_longitude',\n  'count',\n]\n\n\ndf_proc = df_proc[:, cols_order]\ndf_proc\n\n\n\n  \n  \n    origemdestinoorigem_nomeclaturadestino_nomeclaturaanoprocedimentokm (osm)min (osm)criticidadecapitaissocioeconcount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2010N_0000_01_1141\n    1110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2010C_0000_01_149\n    2110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2011N_0000_01_195\n    3110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2011C_0000_01_131\n    4110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2012N_0000_01_173\n    5110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2012C_0000_01_128\n    6110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2013N_0000_01_167\n    7110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2013C_0000_01_125\n    8110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2014N_0000_01_146\n    9110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2014C_0000_01_157\n    10110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2015N_0000_01_136\n    11110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2015C_0000_01_157\n    12110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2016N_0000_01_147\n    13110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2016C_0000_01_133\n    14110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2017N_0000_01_147\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    608,898530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2018C_0001_15_5737\n    608,899530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2018C_L0001_15_511\n    608,900530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2019N_0001_15_51086\n    608,901530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2019C_0001_15_5839\n    608,902530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2019C_L0001_15_522\n  \n  \n  \n    608,903 rows × 12 columns"
  },
  {
    "objectID": "sections/table_procs.html#filtrando-os-anos",
    "href": "sections/table_procs.html#filtrando-os-anos",
    "title": "Procedimentos",
    "section": "Filtrando os anos",
    "text": "Filtrando os anos\n\ndf_proc_bienio = df_proc[\n  (f.ano == 2010) | (f.ano == 2011) | (f.ano == 2018) |(f.ano == 2019)\n, :]\ndf_proc_bienio\n\n\n\n  \n  \n    origemdestinoorigem_nomeclaturadestino_nomeclaturaanoprocedimentokm (osm)min (osm)criticidadecapitaissocioeconcount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2010N_0000_01_1141\n    1110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2010C_0000_01_149\n    2110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2011N_0000_01_195\n    3110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2011C_0000_01_131\n    4110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2018N_0000_01_150\n    5110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2018C_0000_01_177\n    6110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2019N_0000_01_128\n    7110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2019C_0000_01_149\n    8110001110002/BR/NT/RO/11005/110001//BR/NT/RO/11001/110002/2494299/2010N_309.05370.14320_01_11\n    9110001110004/BR/NT/RO/11005/110001//BR/NT/RO/11002/110004/2496046/2019N_81.2011115.06520_01_31\n    10110001110004/BR/NT/RO/11005/110001//BR/NT/RO/11002/110004/2496046/2019C_81.2011115.06520_01_32\n    11110001110006/BR/NT/RO/11005/110001//BR/NT/RO/11006/110006/2808544/2019N_353.417332.39320_01_21\n    12110001110009/BR/NT/RO/11005/110001//BR/NT/RO/11002/110009/2808587/2019N_145.678140.7620_01_32\n    13110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/2010C_130.77152.86820_01_22\n    14110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/2011N_130.77152.86820_01_21\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    247,017530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2018C_0001_15_5737\n    247,018530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2018C_L0001_15_511\n    247,019530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2019N_0001_15_51086\n    247,020530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2019C_0001_15_5839\n    247,021530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2019C_L0001_15_522\n  \n  \n  \n    247,022 rows × 12 columns"
  },
  {
    "objectID": "sections/table_procs.html#atualizando-variável-ano-biênio",
    "href": "sections/table_procs.html#atualizando-variável-ano-biênio",
    "title": "Procedimentos",
    "section": "Atualizando variável ano (biênio)",
    "text": "Atualizando variável ano (biênio)\nValor da variável bienio:\n\n0 (False) = 2010/11\n1 (True) = 2018/19\n\n\ndf_proc_bienio[:, dt.update(ano = (f.ano == 2018) | (f.ano == 2019))]\ndf_proc_bienio.names = {'ano': 'bienio'}\ndf_proc_bienio\n\n\n\n  \n  \n    origemdestinoorigem_nomeclaturadestino_nomeclaturabienioprocedimentokm (osm)min (osm)criticidadecapitaissocioeconcount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/0N_0000_01_1141\n    1110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/0C_0000_01_149\n    2110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/0N_0000_01_195\n    3110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/0C_0000_01_131\n    4110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/1N_0000_01_150\n    5110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/1C_0000_01_177\n    6110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/1N_0000_01_128\n    7110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/1C_0000_01_149\n    8110001110002/BR/NT/RO/11005/110001//BR/NT/RO/11001/110002/2494299/0N_309.05370.14320_01_11\n    9110001110004/BR/NT/RO/11005/110001//BR/NT/RO/11002/110004/2496046/1N_81.2011115.06520_01_31\n    10110001110004/BR/NT/RO/11005/110001//BR/NT/RO/11002/110004/2496046/1C_81.2011115.06520_01_32\n    11110001110006/BR/NT/RO/11005/110001//BR/NT/RO/11006/110006/2808544/1N_353.417332.39320_01_21\n    12110001110009/BR/NT/RO/11005/110001//BR/NT/RO/11002/110009/2808587/1N_145.678140.7620_01_32\n    13110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/0C_130.77152.86820_01_22\n    14110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/0N_130.77152.86820_01_21\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    247,017530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1C_0001_15_5737\n    247,018530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1C_L0001_15_511\n    247,019530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1N_0001_15_51086\n    247,020530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1C_0001_15_5839\n    247,021530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1C_L0001_15_522\n  \n  \n  \n    247,022 rows × 12 columns\n  \n\n\n\n\nTabela agrupada\n\ndf_proc_bienio = df_proc_bienio[:, dt.sum(f.count), by(df_proc_bienio.names[:-1])]\ndf_proc_bienio\n\n\n\n  \n  \n    origemdestinoorigem_nomeclaturadestino_nomeclaturabienioprocedimentokm (osm)min (osm)criticidadecapitaissocioeconcount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/0C_0000_01_180\n    1110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/0N_0000_01_1236\n    2110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/1C_0000_01_1126\n    3110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/1N_0000_01_178\n    4110001110002/BR/NT/RO/11005/110001//BR/NT/RO/11001/110002/2494299/0N_309.05370.14320_01_11\n    5110001110004/BR/NT/RO/11005/110001//BR/NT/RO/11002/110004/2496046/1C_81.2011115.06520_01_32\n    6110001110004/BR/NT/RO/11005/110001//BR/NT/RO/11002/110004/2496046/1N_81.2011115.06520_01_31\n    7110001110006/BR/NT/RO/11005/110001//BR/NT/RO/11006/110006/2808544/1N_353.417332.39320_01_21\n    8110001110009/BR/NT/RO/11005/110001//BR/NT/RO/11002/110009/2808587/1N_145.678140.7620_01_32\n    9110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/0C_130.77152.86820_01_26\n    10110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/0N_130.77152.86820_01_21\n    11110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/1C_130.77152.86820_01_21\n    12110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/1N_130.77152.86820_01_23\n    13110001110013/BR/NT/RO/11005/110001//BR/NT/RO/11001/110013/2808617/0C_357.511427.8420_01_11\n    14110001110013/BR/NT/RO/11005/110001//BR/NT/RO/11001/110013/2808617/0N_357.511427.8420_01_12\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    165,023530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/0C_L0001_15_537\n    165,024530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/0N_0001_15_53449\n    165,025530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1C_0001_15_51576\n    165,026530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1C_L0001_15_533\n    165,027530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1N_0001_15_51919\n  \n  \n  \n    165,028 rows × 12 columns"
  },
  {
    "objectID": "sections/table_procs.html#ano",
    "href": "sections/table_procs.html#ano",
    "title": "Procedimentos",
    "section": "Ano",
    "text": "Ano\n\noutput_proc = get_path('GESTANTES', 'procs.csv.gzip')\ndf_proc.to_csv(output_proc)\n\n\ndt.fread(output_proc)\n\n\n\n  \n  \n    origemdestinoorigem_nomeclaturadestino_nomeclaturaanoprocedimentokm (osm)min (osm)criticidadecapitaissocioeconcount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2010N_0000_01_1141\n    1110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2010C_0000_01_149\n    2110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2011N_0000_01_195\n    3110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2011C_0000_01_131\n    4110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2012N_0000_01_173\n    5110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2012C_0000_01_128\n    6110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2013N_0000_01_167\n    7110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2013C_0000_01_125\n    8110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2014N_0000_01_146\n    9110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2014C_0000_01_157\n    10110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2015N_0000_01_136\n    11110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2015C_0000_01_157\n    12110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2016N_0000_01_147\n    13110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2016C_0000_01_133\n    14110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/2017N_0000_01_147\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    608,898530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2018C_0001_15_5737\n    608,899530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2018C_L0001_15_511\n    608,900530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2019N_0001_15_51086\n    608,901530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2019C_0001_15_5839\n    608,902530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/2019C_L0001_15_522\n  \n  \n  \n    608,903 rows × 12 columns"
  },
  {
    "objectID": "sections/table_procs.html#biênio",
    "href": "sections/table_procs.html#biênio",
    "title": "Procedimentos",
    "section": "Biênio",
    "text": "Biênio\n\noutput_proc_bienio = get_path('GESTANTES', 'procs_bienio.csv.gzip')\ndf_proc_bienio.to_csv(output_proc_bienio)\n\n\ndt.fread(output_proc_bienio)\n\n\n\n  \n  \n    origemdestinoorigem_nomeclaturadestino_nomeclaturabienioprocedimentokm (osm)min (osm)criticidadecapitaissocioeconcount\n    ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪\n  \n  \n    0110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/0C_0000_01_180\n    1110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/0N_0000_01_1236\n    2110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/1C_0000_01_1126\n    3110001110001/BR/NT/RO/11005/110001//BR/NT/RO/11005/110001/2679477/1N_0000_01_178\n    4110001110002/BR/NT/RO/11005/110001//BR/NT/RO/11001/110002/2494299/0N_309.05370.14320_01_11\n    5110001110004/BR/NT/RO/11005/110001//BR/NT/RO/11002/110004/2496046/1C_81.2011115.06520_01_32\n    6110001110004/BR/NT/RO/11005/110001//BR/NT/RO/11002/110004/2496046/1N_81.2011115.06520_01_31\n    7110001110006/BR/NT/RO/11005/110001//BR/NT/RO/11006/110006/2808544/1N_353.417332.39320_01_21\n    8110001110009/BR/NT/RO/11005/110001//BR/NT/RO/11002/110009/2808587/1N_145.678140.7620_01_32\n    9110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/0C_130.77152.86820_01_26\n    10110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/0N_130.77152.86820_01_21\n    11110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/1C_130.77152.86820_01_21\n    12110001110012/BR/NT/RO/11005/110001//BR/NT/RO/11003/110012/2495279/1N_130.77152.86820_01_23\n    13110001110013/BR/NT/RO/11005/110001//BR/NT/RO/11001/110013/2808617/0C_357.511427.8420_01_11\n    14110001110013/BR/NT/RO/11005/110001//BR/NT/RO/11001/110013/2808617/0N_357.511427.8420_01_12\n    ⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮⋮\n    165,023530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/0C_L0001_15_537\n    165,024530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/0N_0001_15_53449\n    165,025530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1C_0001_15_51576\n    165,026530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1C_L0001_15_533\n    165,027530010530010/BR/CO/DF/53001/530010//BR/CO/DF/53001/530010/5717515/1N_0001_15_51919\n  \n  \n  \n    165,028 rows × 12 columns"
  },
  {
    "objectID": "sections/table_trend.html",
    "href": "sections/table_trend.html",
    "title": "Tendências",
    "section": "",
    "text": "import numpy as np\nimport pandas as pd\nfrom tqdm import tqdm\nfrom utils import get_path, group_cols\nfrom datatable import dt, f, by\nfrom sklearn.linear_model import LinearRegression"
  },
  {
    "objectID": "sections/table_trend.html#localidades",
    "href": "sections/table_trend.html#localidades",
    "title": "Tendências",
    "section": "Localidades",
    "text": "Localidades\n\npath_locs = get_path('GESTANTES', 'localidades.csv.gzip')\ndf_locs = pd.read_csv(path_locs)\ndf_locs\n\n\n\n\n\n  \n    \n      \n      escala\n      nomeclatura\n      identificador\n      nome\n    \n  \n  \n    \n      0\n      pais\n      /BR/\n      BR\n      Brasil\n    \n    \n      1\n      regiao\n      /BR/CO/\n      CO\n      Centro-Oeste\n    \n    \n      2\n      regiao\n      /BR/ND/\n      ND\n      Nordeste\n    \n    \n      3\n      regiao\n      /BR/NT/\n      NT\n      Norte\n    \n    \n      4\n      regiao\n      /BR/SD/\n      SD\n      Sudeste\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      10189\n      hospital\n      /BR/CO/GO/52004/521975/2437627/\n      2437627\n      HOSPITAL MUN DOM LUIZ FERNANDES SANTO ANTONIO ...\n    \n    \n      10190\n      hospital\n      /BR/CO/GO/52010/522010/2442671/\n      2442671\n      HOSPITAL MONTES BELOS SAO LUIS DE MONTES BELOS\n    \n    \n      10191\n      hospital\n      /BR/CO/GO/52001/522140/2570084/\n      2570084\n      HOSPITAL DE TRINDADE\n    \n    \n      10192\n      hospital\n      /BR/CO/GO/52014/522160/9813349/\n      9813349\n      HOSPITAL SERRA DA MESA HSM\n    \n    \n      10193\n      hospital\n      /BR/CO/DF/53001/530010/0010561/\n      0010561\n      HFA\n    \n  \n\n10194 rows × 4 columns"
  },
  {
    "objectID": "sections/table_trend.html#procedimentos",
    "href": "sections/table_trend.html#procedimentos",
    "title": "Tendências",
    "section": "Procedimentos",
    "text": "Procedimentos\n\npath_proc = get_path('GESTANTES', 'procs.csv.gzip')\ndf_proc = pd.read_csv(path_proc)\ndf_proc\n\n\n\n\n\n  \n    \n      \n      origem\n      destino\n      origem_nomeclatura\n      destino_nomeclatura\n      ano\n      procedimento\n      km (osm)\n      min (osm)\n      criticidade\n      capitais\n      socioecon\n      count\n    \n  \n  \n    \n      0\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2010\n      N_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      141\n    \n    \n      1\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2010\n      C_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      49\n    \n    \n      2\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2011\n      N_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      95\n    \n    \n      3\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2011\n      C_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      31\n    \n    \n      4\n      110001\n      110001\n      /BR/NT/RO/11005/110001/\n      /BR/NT/RO/11005/110001/2679477/\n      2012\n      N_\n      0.0\n      0.0\n      0\n      0_0\n      1_1\n      73\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      608898\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2018\n      C_\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      737\n    \n    \n      608899\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2018\n      C_L\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      11\n    \n    \n      608900\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2019\n      N_\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      1086\n    \n    \n      608901\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2019\n      C_\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      839\n    \n    \n      608902\n      530010\n      530010\n      /BR/CO/DF/53001/530010/\n      /BR/CO/DF/53001/530010/5717515/\n      2019\n      C_L\n      0.0\n      0.0\n      0\n      1_1\n      5_5\n      22\n    \n  \n\n608903 rows × 12 columns"
  },
  {
    "objectID": "sections/table_trend.html#funções-auxiliares",
    "href": "sections/table_trend.html#funções-auxiliares",
    "title": "Tendências",
    "section": "Funções Auxiliares",
    "text": "Funções Auxiliares\n\nCálculos\n\ndef calc_total_percent(df):\n  df['total'] = df['count'].sum()\n  df['percent'] = df['count'] / df['total'] * 100\n  return df\n\n\ndef calc_bienios(df, ano_bienio=2010):\n  ano1 = ano_bienio if ano_bienio % 2 == 0 else ano_bienio - 1\n  ano2 = ano_bienio + 1\n  df_flt = df[(df['ano'] == ano1) | (df['ano'] == ano2)]\n  cols_flt = df_flt.columns[1:-1]\n  df_flt = df_flt[cols_flt].groupby(\n    by=list(cols_flt[:-2]), as_index=False).sum()\n  df_flt['percent'] = df_flt['count'] / df_flt['total'] * 100\n  if len(df_flt) == 0:\n    df_flt['count'] = [0]\n    df_flt['percent'] = [0]\n  return df_flt\n\n\n\nInformação\n\ndef get_linreg_params(y):\n  X = np.array([i + 1 for i, _ in enumerate(y)]).reshape(-1, 1)\n  y = np.array(y)\n  reg = LinearRegression().fit(X, y)\n  angle = reg.coef_[0]\n  intercept = reg.intercept_\n  return angle, intercept\n\n\ndef dict_info(df, nome, proc, categ_name, categ_val):\n  mean = df['percent'].mean()\n  angle, intercept = get_linreg_params(df['percent'])\n  df_bie_10 = calc_bienios(df)\n  df_bie_18 = calc_bienios(df, 2018)\n  return {\n    'Nomeclatura': nome,\n    'Tipo Parto': proc,\n    'Categorização': categ_name,\n    'Categoria': categ_val,\n    'Procedimentos': df['count'].sum(),\n    'Count Biênio 2010-11': df_bie_10['count'].values[0],\n    'Count Biênio 2018-19': df_bie_18['count'].values[0],\n    '% Biênio 2010-11': df_bie_10['percent'].values[0],\n    '% Biênio 2018-19': df_bie_18['percent'].values[0],\n    'Média Década 2010': mean,\n    'Interceptação no Eixo Y': intercept,\n    'Ângulo de Tendência': angle,\n  }\n\n\n\nFiltragem\n\ndef filter_by_nomeclatura(df, nome, ref='origem'):\n  if (ref == 'origem') or (ref == 'destino'):\n    df_filt = df[df[f'{ref}_nomeclatura'].str.contains(nome)]\n  else:\n    df_filt = df[(\n      df['origem_nomeclatura'].str.contains(nome)\n    ) | (\n      df['destino_nomeclatura'].str.contains(nome))]\n  return df_filt.copy()\n\n\ndef filter_by_procedimento(df, proc):\n  return df[df['procedimento'] == proc].copy()\n\n\ndef filter_by_ano(df, ano):\n  return df[(df['ano'] == ano)].copy()\n\n\n\nIteração\n\ndef iter_anos(df):\n  dfs_anos = list()\n  for ano in df['ano'].unique():\n    df_ = df[(df['ano'] == ano)].copy()\n    df_['total'] = df_['count'].sum()\n    df_['percent']  = df_['count'] / df_['total'] * 100\n    dfs_anos.append(df_)\n  return pd.concat(dfs_anos)\n\n\ndef iter_anos_deslc(df):\n  dfs_anos = list()\n  for ano in df['ano'].unique():\n    df_ = df[(df['ano'] == ano)].copy()\n    for cri in range(df_['criticidade'].max()):\n      df_num = df_[df_['criticidade'] > cri]\n      df_den = df_[df_['criticidade'] >= cri]\n      d = {\n        'ano': ano,\n        'criticidade': f'(>{cri}) / (>={cri})',\n        'count': df_num['count'].sum(),\n        'total': df_den['count'].sum(),\n        'percent': df_num['count'].sum() / df_den['count'].sum() * 100\n      }\n      dfs_anos.append(d)\n  df_ano = pd.DataFrame(dfs_anos)\n  return df_ano\n\n\ndef iter_procs(df, func_iter_anos):\n  dfs_procs = list()\n  for proc in df['procedimento'].unique():\n    df_proc = filter_by_procedimento(df, proc)\n    df_anos = func_iter_anos(df_proc)\n    df_anos['procedimento'] = proc\n    dfs_procs.append(df_anos)\n  return pd.concat(dfs_procs)\n\n\ndef iter_infos(df, info_col, nome, categ_name):\n  dfs_infos = list()\n  for proc in df['procedimento'].unique():\n    df_pr = filter_by_procedimento(df, proc)\n    for categ in df_pr[info_col].unique():\n      dfc = df_pr[df_pr[info_col] == categ]\n      info = dict_info(dfc, nome, proc, categ_name, categ)\n      dfs_infos.append(info)\n  return pd.DataFrame(dfs_infos)\n\n\n\nCategorias\n\nquantidade X\ncriticidade X\ndistancia X\ntempo X\nsocioecom X\ncapitais X\n% residentes\ndeslocamento\n\n\ndef categ_min(val, und='min'):\n  if val < 10:\n    categ = f'000-010 ({und})'\n  elif val > 10 and val < 25:\n    categ = f'010-025 ({und})'\n  elif val > 25 and val < 50:\n    categ = f'025-050 ({und})'\n  elif val > 50 and val < 100:\n    categ = f'050-100 ({und})'\n  elif val > 100 and val < 200:\n    categ = f'100-200 ({und})'\n  else:\n    categ = f'200< ({und})'\n  return categ\n\n\ndef categ_km(val, und='km'):\n  if val < 10:\n    categ = f'000-010 ({und})'\n  elif val > 10 and val < 25:\n    categ = f'010-025 ({und})'\n  elif val > 25 and val < 50:\n    categ = f'025-050 ({und})'\n  elif val > 50 and val < 100:\n    categ = f'050-100 ({und})'\n  elif val > 100 and val < 200:\n    categ = f'100-200 ({und})'\n  else:\n    categ = f'200< ({und})'\n  return categ\n\n\ncategorias = {\n  'dslc': ['criticidade', 'Deslocamento', lambda x: x, iter_anos_deslc],\n  'quant': ['all', 'Quantidade', lambda x: x, iter_anos],\n  'socioecon': ['socioecon', 'Socioeconômico', lambda x: x, iter_anos],\n  'capitais': ['capitais', 'Capitais', lambda x: x, iter_anos],\n  'critic': ['criticidade', 'Criticidade', lambda x: x, iter_anos],\n  'dist': ['km (osm)', 'Distância Percorrida', categ_km, iter_anos],\n}\n\n\n\nModificações\n\ndef trend_table(df, nome, info_col, categ_name, categ_func, func_iter_anos):\n  cols_df = ['ano', 'procedimento', info_col, 'count']\n  df_mdf = filter_by_nomeclatura(df, nome)\n  if info_col == 'all': df_mdf[info_col] = 'procedimentos'\n  df_mdf = df_mdf[cols_df].copy()\n  df_mdf[info_col] = df_mdf[info_col].apply(categ_func)\n  df_mdf = df_mdf.groupby(cols_df[:-1], as_index=False).sum()\n  df_mdf = df_mdf.sort_values(by=cols_df[:-1])\n  df_mdf = iter_procs(df_mdf, func_iter_anos)\n  df_mdf = iter_infos(df_mdf, info_col, nome, categ_name)\n  return df_mdf\n\n\ndef get_trend_table(df_proc, nome, categ):\n  df = trend_table(df_proc, nome, *categorias[categ])\n  return df"
  },
  {
    "objectID": "sections/table_trend.html#tabelas-produzidas",
    "href": "sections/table_trend.html#tabelas-produzidas",
    "title": "Tendências",
    "section": "Tabelas produzidas",
    "text": "Tabelas produzidas\n\ndef trend_all_categs(categorias, nome='/BR/'):\n  dfs = list()\n  for categ in categorias:\n    df = get_trend_table(df_proc, nome, categ)\n    dfs.append(df)\n  df = pd.concat(dfs)\n  return df\n\n\ndef trend_all_nomeclaturas(df_locs, categorias):\n  dfs = list()\n  for nome in tqdm(df_locs['nomeclatura'][:40]):\n    df_t = trend_all_categs(categorias, nome)\n    dfs.append(df_t)\n  df = pd.concat(dfs)\n  return df\n\n\ndf_trend = trend_all_nomeclaturas(df_locs, categorias)\ndf_trend\n\n100%|██████████| 40/40 [01:51<00:00,  2.80s/it]\n\n\n\n\n\n\n  \n    \n      \n      Nomeclatura\n      Tipo Parto\n      Categorização\n      Categoria\n      Procedimentos\n      Count Biênio 2010-11\n      Count Biênio 2018-19\n      % Biênio 2010-11\n      % Biênio 2018-19\n      Média Década 2010\n      Interceptação no Eixo Y\n      Ângulo de Tendência\n    \n  \n  \n    \n      0\n      /BR/\n      C_\n      Deslocamento\n      (>0) / (>=0)\n      1813776.0\n      160984.0\n      195896.0\n      26.048474\n      28.684722\n      27.837217\n      26.023449\n      0.329776\n    \n    \n      1\n      /BR/\n      C_\n      Deslocamento\n      (>1) / (>=1)\n      465980.0\n      44287.0\n      47570.0\n      27.510187\n      24.283293\n      25.747766\n      27.654530\n      -0.346684\n    \n    \n      2\n      /BR/\n      C_\n      Deslocamento\n      (>2) / (>=2)\n      68744.0\n      5783.0\n      8243.0\n      12.869987\n      17.328148\n      14.714554\n      12.033099\n      0.487537\n    \n    \n      3\n      /BR/\n      C_\n      Deslocamento\n      (>3) / (>=3)\n      8179.0\n      451.0\n      1428.0\n      7.798720\n      17.323790\n      11.444020\n      4.219979\n      1.313462\n    \n    \n      4\n      /BR/\n      C_L\n      Deslocamento\n      (>0) / (>=0)\n      67565.0\n      4731.0\n      9163.0\n      22.306568\n      24.246514\n      23.274825\n      21.435850\n      0.334359\n    \n    \n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n      ...\n    \n    \n      14\n      /BR/CO/GO/52006/\n      N_\n      Distância Percorrida\n      025-050 (km)\n      312.0\n      107.0\n      90.0\n      16.041979\n      15.706806\n      12.342491\n      9.507901\n      0.515380\n    \n    \n      15\n      /BR/CO/GO/52006/\n      N_\n      Distância Percorrida\n      050-100 (km)\n      31.0\n      5.0\n      11.0\n      0.749625\n      1.919721\n      1.763654\n      1.088516\n      0.150031\n    \n    \n      16\n      /BR/CO/GO/52006/\n      N_\n      Distância Percorrida\n      100-200 (km)\n      317.0\n      88.0\n      101.0\n      13.193403\n      17.626527\n      12.457534\n      6.482769\n      1.086321\n    \n    \n      17\n      /BR/CO/GO/52006/\n      N_\n      Distância Percorrida\n      200< (km)\n      194.0\n      19.0\n      55.0\n      2.848576\n      9.598604\n      10.638393\n      7.898778\n      0.498112\n    \n    \n      18\n      /BR/CO/GO/52006/\n      N_R\n      Distância Percorrida\n      200< (km)\n      22.0\n      0.0\n      17.0\n      0.000000\n      100.000000\n      100.000000\n      100.000000\n      0.000000\n    \n  \n\n6852 rows × 12 columns"
  }
]