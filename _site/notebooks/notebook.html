<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Deslocamento de Gestantes – notebook</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">(Untitled)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Deslocamento de Gestantes</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/lucaslopes/gestantes" title="" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Coleta de Dados</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/sih.html" class="sidebar-item-text sidebar-link">SIH</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/socioecon.html" class="sidebar-item-text sidebar-link">Socioeconômico</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sections/mun_dist.html" class="sidebar-item-text sidebar-link">Distâncias</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Coleta de Dados</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  sections/data_network.ipynb
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#redes-de-deslocamento-para-acesso-ao-parto-hospitalar-no-brasil" id="toc-redes-de-deslocamento-para-acesso-ao-parto-hospitalar-no-brasil" class="nav-link active" data-scroll-target="#redes-de-deslocamento-para-acesso-ao-parto-hospitalar-no-brasil">Redes de deslocamento para acesso ao parto hospitalar no Brasil</a>
  <ul class="collapse">
  <li><a href="#contexto" id="toc-contexto" class="nav-link" data-scroll-target="#contexto">Contexto</a></li>
  <li><a href="#links" id="toc-links" class="nav-link" data-scroll-target="#links">Links</a></li>
  <li><a href="#importação-das-dependências" id="toc-importação-das-dependências" class="nav-link" data-scroll-target="#importação-das-dependências">Importação das dependências</a></li>
  </ul></li>
  <li><a href="#fontes-de-dados" id="toc-fontes-de-dados" class="nav-link" data-scroll-target="#fontes-de-dados">Fontes de dados</a>
  <ul class="collapse">
  <li><a href="#sistema-de-informações-hospitalares-do-sus-sihsus" id="toc-sistema-de-informações-hospitalares-do-sus-sihsus" class="nav-link" data-scroll-target="#sistema-de-informações-hospitalares-do-sus-sihsus">Sistema de Informações Hospitalares do SUS (SIHSUS)</a></li>
  <li><a href="#regiões-de-saúde-do-brasil" id="toc-regiões-de-saúde-do-brasil" class="nav-link" data-scroll-target="#regiões-de-saúde-do-brasil">Regiões de Saúde do Brasil</a></li>
  <li><a href="#grupos-de-regiões-de-saúde-segundo-condições-socioeconômicas-e-de-saúde" id="toc-grupos-de-regiões-de-saúde-segundo-condições-socioeconômicas-e-de-saúde" class="nav-link" data-scroll-target="#grupos-de-regiões-de-saúde-segundo-condições-socioeconômicas-e-de-saúde">Grupos de Regiões de Saúde segundo Condições Socioeconômicas e de Saúde</a></li>
  <li><a href="#openstreetmap-osm" id="toc-openstreetmap-osm" class="nav-link" data-scroll-target="#openstreetmap-osm">OpenStreetMap (OSM)</a></li>
  </ul></li>
  <li><a href="#base-de-dados" id="toc-base-de-dados" class="nav-link" data-scroll-target="#base-de-dados">Base de dados</a>
  <ul class="collapse">
  <li><a href="#seleção-dos-dados" id="toc-seleção-dos-dados" class="nav-link" data-scroll-target="#seleção-dos-dados">Seleção dos dados</a>
  <ul class="collapse">
  <li><a href="#seleção-das-variáveis-colunas" id="toc-seleção-das-variáveis-colunas" class="nav-link" data-scroll-target="#seleção-das-variáveis-colunas">Seleção das variáveis (colunas)</a></li>
  <li><a href="#seleção-dos-registros-linhas" id="toc-seleção-dos-registros-linhas" class="nav-link" data-scroll-target="#seleção-dos-registros-linhas">Seleção dos registros (linhas)</a></li>
  </ul></li>
  <li><a href="#criação-de-variáveis" id="toc-criação-de-variáveis" class="nav-link" data-scroll-target="#criação-de-variáveis">Criação de variáveis</a>
  <ul class="collapse">
  <li><a href="#deslocamento" id="toc-deslocamento" class="nav-link" data-scroll-target="#deslocamento">Deslocamento</a></li>
  <li><a href="#período" id="toc-período" class="nav-link" data-scroll-target="#período">Período</a></li>
  </ul></li>
  <li><a href="#tabelas-geradas" id="toc-tabelas-geradas" class="nav-link" data-scroll-target="#tabelas-geradas">Tabelas geradas</a>
  <ul class="collapse">
  <li><a href="#tabela-partos" id="toc-tabela-partos" class="nav-link" data-scroll-target="#tabela-partos">Tabela Partos</a></li>
  <li><a href="#tabela-localidades" id="toc-tabela-localidades" class="nav-link" data-scroll-target="#tabela-localidades">Tabela Localidades</a></li>
  </ul></li>
  <li><a href="#conhecimento-das-variávies" id="toc-conhecimento-das-variávies" class="nav-link" data-scroll-target="#conhecimento-das-variávies">Conhecimento das variávies</a>
  <ul class="collapse">
  <li><a href="#conhecendo-as-variáveis-da-tabela-de-partos" id="toc-conhecendo-as-variáveis-da-tabela-de-partos" class="nav-link" data-scroll-target="#conhecendo-as-variáveis-da-tabela-de-partos">Conhecendo as variáveis da tabela de partos</a></li>
  <li><a href="#conhecendo-as-variáveis-da-tabela-de-localidades" id="toc-conhecendo-as-variáveis-da-tabela-de-localidades" class="nav-link" data-scroll-target="#conhecendo-as-variáveis-da-tabela-de-localidades">Conhecendo as variáveis da tabela de localidades</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#investigações" id="toc-investigações" class="nav-link" data-scroll-target="#investigações">Investigações</a>
  <ul class="collapse">
  <li><a href="#comparando-momentos-temporais" id="toc-comparando-momentos-temporais" class="nav-link" data-scroll-target="#comparando-momentos-temporais">Comparando momentos temporais</a></li>
  <li><a href="#tendência-ao-longo-dos-anos" id="toc-tendência-ao-longo-dos-anos" class="nav-link" data-scroll-target="#tendência-ao-longo-dos-anos">Tendência ao longo dos anos</a></li>
  </ul></li>
  <li><a href="#conexões-entre-residência-e-internação" id="toc-conexões-entre-residência-e-internação" class="nav-link" data-scroll-target="#conexões-entre-residência-e-internação">Conexões entre Residência e Internação</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="redes-de-deslocamento-para-acesso-ao-parto-hospitalar-no-brasil" class="level1">
<h1>Redes de deslocamento para acesso ao parto hospitalar no Brasil</h1>
<section id="contexto" class="level2">
<h2 class="anchored" data-anchor-id="contexto">Contexto</h2>
<p>No Brasil, 98% dos partos ocorrem em ambiente hospitalar, e 77% no Sistema Único de Saúde (SUS). O acesso oportuno aos serviços obstétricos de internação para o parto é fundamental para garantir a segurança do cuidado materno e neonatal. Entretanto, há “vazios assistenciais” na oferta de serviços hospitalares pelo SUS que fazem com que grande parte das parturientes precise se deslocar de um município a outro para ser assistida.</p>
<p>O retardo na atenção obstétrica no momento do parto está associado à desfechos maternos adversos, e o deslocamento de grandes distâncias tem sido associado a níveis elevados de mortalidade infantil e neonatal, além de maior risco de morbimortalidade materna. Assim, a análise da distância percorrida pelas parturientes de sua residência até o hospital é um indicador útil e sensível para avaliar a dificuldade em acessar cuidados maternos e neonatais no SUS.</p>
<p>A análise da acessibilidade geográfica é um componente importante da avaliação de serviços de saúde e reflete aspectos da distribuição espacial da oferta de serviços que dificultam ou promovem sua utilização. A metodologia de análise de redes sociais (ARS) tem sido utilizada nesse contexto, incluindo a internação para o parto, e também como ferramenta para gestão em saúde.</p>
<p>Este projeto tem o objetivo de analisar a acessibilidade geográfica ao parto hospitalar realizado no SUS nos últimos 10 anos, em todo Brasil, aplicando a ARS como uma nova ferramenta para a gestão de serviços de saúde. Serão utilizados dados do Departamento de Informática do SUS (DATASUS) para a construção das redes de deslocamento das gestantes em busca de internação para o parto, levando-se em conta as distâncias percorridas, mapeando fluxos preferenciais e identificando lacunas geográficas de atendimento e polos de atração de maior demanda, como medida de inequidade no acesso aos serviços. O projeto avança no processo de avaliação do sistema de saúde ao desenvolver novos indicadores de acesso à serviços obstétricos, baseados em uma metodologia inovadora, e com abrangência nacional e aplicabilidade a outras áreas de saúde pública.</p>
<p>Espera-se, com este estudo, gerar evidências que permitam um melhor entendimento da organização e das fragilidades do SUS na assistência à saúde da mulher no ciclo gravídico-puerperal, contribuindo para o planejamento da atenção obstétrica e para o fortalecimento de políticas públicas voltadas para melhoria do acesso aos serviços de saúde.</p>
</section>
<section id="links" class="level2">
<h2 class="anchored" data-anchor-id="links">Links</h2>
<ul>
<li><p>https://github.com/lucaslopes/partos/</p></li>
<li><p>https://pcdas.icict.fiocruz.br/rede-de-parcerias/a-distancia-importa-redes-de-deslocamento-para-acesso-ao-parto-hospitalar-no-brasil/</p></li>
</ul>
</section>
<section id="importação-das-dependências" class="level2">
<h2 class="anchored" data-anchor-id="importação-das-dependências">Importação das dependências</h2>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> config, data_load, data_info, data_plot</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly <span class="im">import</span> graph_objects <span class="im">as</span> go</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style type="text/css">
.datatable table.frame { margin-bottom: 0; }
.datatable table.frame thead { border-bottom: none; }
.datatable table.frame tr.coltypes td {  color: #FFFFFF;  line-height: 6px;  padding: 0 0.5em;}
.datatable .bool    { background: #DDDD99; }
.datatable .object  { background: #565656; }
.datatable .int     { background: #5D9E5D; }
.datatable .float   { background: #4040CC; }
.datatable .str     { background: #CC4040; }
.datatable .time    { background: #40CC40; }
.datatable .row_index {  background: var(--jp-border-color3);  border-right: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  font-size: 9px;}
.datatable .frame tbody td { text-align: left; }
.datatable .frame tr.coltypes .row_index {  background: var(--jp-border-color0);}
.datatable th:nth-child(2) { padding-left: 12px; }
.datatable .hellipsis {  color: var(--jp-cell-editor-border-color);}
.datatable .vellipsis {  background: var(--jp-layout-color0);  color: var(--jp-cell-editor-border-color);}
.datatable .na {  color: var(--jp-cell-editor-border-color);  font-size: 80%;}
.datatable .sp {  opacity: 0.25;}
.datatable .footer { font-size: 9px; }
.datatable .frame_dimensions {  background: var(--jp-border-color3);  border-top: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  display: inline-block;  opacity: 0.6;  padding: 1px 10px 1px 5px;}
</style>
</div>
</div>
</section>
</section>
<section id="fontes-de-dados" class="level1">
<h1>Fontes de dados</h1>
<p>Utilizamos algumas fontes para compor nossa base de dados de análise, abaixo descrevemos cada uma delas:</p>
<section id="sistema-de-informações-hospitalares-do-sus-sihsus" class="level2">
<h2 class="anchored" data-anchor-id="sistema-de-informações-hospitalares-do-sus-sihsus">Sistema de Informações Hospitalares do SUS (SIHSUS)</h2>
<p>Dados do Sistema de Informações Hospitalares do SUS (SIHSUS) reunidos pela Plataforma de Ciência de Dados aplicada à Saúde (PCDaS). Os dados foram obtidos junto ao DATASUS (Ministério da Saúde), tratados e enriquecidos seguindo uma metodologia própria de ETL (processo de extração, transformação e carga dos dados) da PCDaS, resultando em um dataset mensal com todos os registros de internações hospitalares contidos no SIHSUS à partir de janeiro de 2008.</p>
<p>A atualização dos dados é realizada pelo DATASUS e a PCDaS extrai os registros mensais referentes aos arquivos <code>RD_UF_ANO_MÊS.dbc</code> (Reduzidos de AIH) assim que disponibilizados. As colunas com nomes em MAIÚSCULO representam dados originais advindos do DATASUS e colunas com nomes iniciando em minúsculo representam dados resultantes de transformação ou enriquecimento.</p>
<p><strong>Observações</strong></p>
<ul>
<li><p>A tabela contendo os municípios brasileiros e sua respectiva Região de Saúde ao qual faz parte pode ser obtida em https://sage.saude.gov.br/paineis/regiaoSaude/lista.php?output=html&amp;</p></li>
<li><p>O download da base de dados pode ser realizado através da PCDaS (necessário conta de usuário) pelo link: https://pcdas.icict.fiocruz.br/conjunto-de-dados/sistema-de-informacoes-hospitalares-do-sus-sihsus/</p></li>
<li><p>Ao concluír o download, é obtido um arquivo compactado <code>SIHSUS.zip</code></p></li>
<li><p>O arquivo contém <code>4401</code> arquivos no formato <code>.csv</code>, onde <code>4000</code> são arquivos com registros, e <code>1</code> é o dicionário das variáveis <code>dict_SIH.csv</code>, que também pode ser consultado em https://pcdas.icict.fiocruz.br/conjunto-de-dados/sistema-de-informacoes-hospitalares-do-sus-sihsus/dicionario-de-variaveis/</p></li>
<li><p>O arquivo foi baixado da PCDaS em <code>11/03/2022 16:13</code></p></li>
<li><p>Uma tabela listando os arquivos <code>.csv</code> contidos no arquivo compactado <code>.zip</code> pode ser visualizada abaixo:</p></li>
</ul>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_files <span class="op">=</span> pd.read_csv(<span class="st">'data/consult/files_in_zip.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_files</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>file_names</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>dict_SIH.csv</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ETLSIH.ST_AC_2010_10_t.csv</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ETLSIH.ST_AC_2010_11_t.csv</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ETLSIH.ST_AC_2010_12_t.csv</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ETLSIH.ST_AC_2010_1_t.csv</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>4396</th>
      <td>ETLSIH.ST_TO_2021_3_t.csv</td>
    </tr>
    <tr>
      <th>4397</th>
      <td>ETLSIH.ST_TO_2021_4_t.csv</td>
    </tr>
    <tr>
      <th>4398</th>
      <td>ETLSIH.ST_TO_2021_5_t.csv</td>
    </tr>
    <tr>
      <th>4399</th>
      <td>ETLSIH.ST_TO_2021_6_t.csv</td>
    </tr>
    <tr>
      <th>4400</th>
      <td>ETLSIH.ST_TO_2021_7_t.csv</td>
    </tr>
  </tbody>
</table>
<p>4401 rows × 1 columns</p>
</div>
</div>
</div>
</section>
<section id="regiões-de-saúde-do-brasil" class="level2">
<h2 class="anchored" data-anchor-id="regiões-de-saúde-do-brasil">Regiões de Saúde do Brasil</h2>
<p>A <a href="https://bvsms.saude.gov.br/bvs/saudelegis/cit/2011/res0001_29_09_2011.html">Resolução nº 1 de 29 de Setemebro de 2011</a>, estabelece diretrizes gerais para a instituição de Regiões de Saúde no âmbito do Sistema Único de Saúde (SUS), consituindo os objetivos sua organização:</p>
<ol type="1">
<li>garantir o acesso resolutivo da população, em tempo oportuno e com qualidade, a ações e serviços de promoção, proteção e recuperação, organizados em redes de atenção à saúde, assegurando-se um padrão de integralidade;</li>
<li>efetivar o processo de descentralização de ações e serviços de saúde entre os entes federados, com responsabilização compartilhada, favorecendo a ação solidária e cooperativa entre os gestores, impedindo a duplicação de meios para atingir as mesmas finalidades; e</li>
<li>buscar a racionalidade dos gastos, a otimização de recursos e eficiência na rede de atenção à saúde, por meio da conjugação interfederativa de recursos financeiros entre outros, de modo a reduzir as desigualdades locais e regionais.</li>
</ol>
<p>A <a href="https://www.gov.br/saude/pt-br/composicao/se/demas">Sala de Apoio à Gestão Estratégica (SAGE)</a> disponibiliza informações de saúde, especialmente das redes de atenção à saúde prioritárias, acompanhamento das metas, repasses, coberturas e indicadores epidemiológicos e operacionais das ações e programas para a tomada de decisão, gestão e geração de conhecimento pelos estados e municípios.</p>
<p><strong>Observações</strong></p>
<ul>
<li>A tabela contendo os municípios brasileiros e sua respectiva Região de Saúde ao qual faz parte pode ser obtida em https://sage.saude.gov.br/paineis/regiaoSaude/lista.php?output=html&amp;</li>
</ul>
</section>
<section id="grupos-de-regiões-de-saúde-segundo-condições-socioeconômicas-e-de-saúde" class="level2">
<h2 class="anchored" data-anchor-id="grupos-de-regiões-de-saúde-segundo-condições-socioeconômicas-e-de-saúde">Grupos de Regiões de Saúde segundo Condições Socioeconômicas e de Saúde</h2>
<p>Com o objetivo de elucidar os condicionantes estruturais do processo recente de regionalização nos estados, por meio da construção de uma tipologia nacional das regiões de saúde com base nas Comissões Intergestores Regionais – CIR formalmente constituídos até fevereiro de 2015. Essa tipologia é baseada na tipologia criada em 2010 para os antigos Colegiados de Gestão Regional – CGR’s que permitia observar os diversos graus de desenvolvimento econômico, social e características da rede de saúde dos municípios.</p>
<p>A nova tipologia apresentada mantém os parâmetros que nortearam a construção da antiga – no nível de CGR – mas apresenta uma operacionalização mais amigável a partir de um número menor de componentes. Essa simplificação operacional é importante dado às possíveis mudanças no desenho das CIR’s que eventualmente venham a ocorrer ao longo do tempo. Destaca-se ainda a introdução de informações referentes ao Censo Demográfico 2010, que não estavam disponíveis no momento da construção da antiga tipologia.</p>
<p>Analogamente a tipologia anterior as CIR’s foram classificadas, de forma independente, em cinco grupos de acordo com suas características socioeconômicas e de sistema de saúde.</p>
<p><strong>Observações</strong></p>
<ul>
<li>As Regiões de Saúde e sua respectiva classificação em um dos 5 Grupos Socioeconômicos pode ser visualizada em https://indicadores.resbr.net.br/view/index.php</li>
<li>A metododologia de como a classificação foi realizada está disponível em https://indicadores.resbr.net.br/view/pdf/relatorio_tipologia_versaofev2016.pdf</li>
<li>Os indicadores de classificação foram exportados a partir de https://indicadores.resbr.net.br/view/indicadores.php?clrSession=true</li>
<li>A informação do Indicador Socioeconômico de qual Grupo uma Região de Saúde pertence, foi mesclada com a tabela que lista dos Municípos e suas Regiões de Saúde, resultando na seguinte tabela abaixo:</li>
</ul>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>health_regions <span class="op">=</span> pd.read_csv(<span class="st">'data/consult/health_regions.csv'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>health_regions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>UF</th>
      <th>Município</th>
      <th>Cód IBGE</th>
      <th>Cód Região de Saúde</th>
      <th>Nome da Região de Saúde</th>
      <th>Grupo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AC</td>
      <td>Acrelândia</td>
      <td>120001</td>
      <td>12002</td>
      <td>Baixo Acre e Purus</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AC</td>
      <td>Assis Brasil</td>
      <td>120005</td>
      <td>12001</td>
      <td>Alto Acre</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AC</td>
      <td>Brasiléia</td>
      <td>120010</td>
      <td>12001</td>
      <td>Alto Acre</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AC</td>
      <td>Bujari</td>
      <td>120013</td>
      <td>12002</td>
      <td>Baixo Acre e Purus</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AC</td>
      <td>Capixaba</td>
      <td>120017</td>
      <td>12002</td>
      <td>Baixo Acre e Purus</td>
      <td>2</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5566</th>
      <td>TO</td>
      <td>Tocantinópolis</td>
      <td>172120</td>
      <td>17002</td>
      <td>Bico do Papagaio</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5567</th>
      <td>TO</td>
      <td>Tupirama</td>
      <td>172125</td>
      <td>17004</td>
      <td>Cerrado Tocantins Araguaia</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5568</th>
      <td>TO</td>
      <td>Tupiratins</td>
      <td>172130</td>
      <td>17004</td>
      <td>Cerrado Tocantins Araguaia</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5569</th>
      <td>TO</td>
      <td>Wanderlândia</td>
      <td>172208</td>
      <td>17001</td>
      <td>Médio Norte Araguaia</td>
      <td>3</td>
    </tr>
    <tr>
      <th>5570</th>
      <td>TO</td>
      <td>Xambioá</td>
      <td>172210</td>
      <td>17001</td>
      <td>Médio Norte Araguaia</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>5571 rows × 6 columns</p>
</div>
</div>
</div>
</section>
<section id="openstreetmap-osm" class="level2">
<h2 class="anchored" data-anchor-id="openstreetmap-osm">OpenStreetMap (OSM)</h2>
<p>OpenStreetMap (OSM) é um projeto de mapeamento colaborativo para criar um mapa livre e editável do mundo, inspirado por sites como a Wikipédia. Traduzindo para português o nome significa Mapa Aberto de Ruas. Ele fornece dados a centenas de sites na internet, aplicações de celular e outros dispositivos.</p>
<p>O objetivo ao utilizar essa fonte de dados é obter unidades de medida como <code>distância</code> e <code>tempo</code> custado no deslocamento da gestante a partir de sua residência até o hospital de internação.</p>
<p><strong>Observações</strong></p>
<ul>
<li>Ainda não coletamos os dados de descolamento</li>
</ul>
</section>
</section>
<section id="base-de-dados" class="level1">
<h1>Base de dados</h1>
<p>A partir das fontes de dados indicadas acima, construimos então nossa base de dados para o domínio de nosso objeto de pesquisa.</p>
<section id="seleção-dos-dados" class="level2">
<h2 class="anchored" data-anchor-id="seleção-dos-dados">Seleção dos dados</h2>
<p>Para isso, iremos selecionar as informações presentes nas fontes, para gerar as tabelas de nossa base resultante. Ao selecionar, consideramos as <code>variáveis</code> (<code>colunas</code>) e os <code>registros</code> (<code>linhas</code>) da forma descrita a seguir.</p>
<section id="seleção-das-variáveis-colunas" class="level3">
<h3 class="anchored" data-anchor-id="seleção-das-variáveis-colunas">Seleção das variáveis (colunas)</h3>
<p>Dentre as <a href="https://pcdas.icict.fiocruz.br/conjunto-de-dados/sistema-de-informacoes-hospitalares-do-sus-sihsus/dicionario-de-variaveis/">variáveis disponíveis pelo SIHSUS</a>, selecionamos de acordo com as seguintes características:</p>
<ul>
<li><code>hospital</code>: informações que dizem respeito ao procedimento de internação que foi realizado;</li>
<li><code>gestante</code>: informações que dizem respeito a paciente que passou pelo procedimento de internação;</li>
<li><code>localidade</code>: informações que dizem respeito a localização do municipípio, seja de residência da paciente ou do hospital de internação, a ser diferenciado pelo prefixo <code>res_</code> (residência) e <code>int_</code> (internação)</li>
</ul>
<p><strong>Observações</strong></p>
<ul>
<li>Com o objetivo de facilitar a nomeclatura para o escopo deste projeto, renomeamos as variáveis de acordo com nossa necessidade e contexto</li>
<li>Uma tabela contendo a lista das variáveis utilizadas, com sua respectiva característica, definição e nome ao qual será renomeada pode ser visualizada abaixo:</li>
</ul>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>variables <span class="op">=</span> pd.read_csv(<span class="st">'data/consult/variables.csv'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>variables</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Característica</th>
      <th>Variável</th>
      <th>Renomear</th>
      <th>Definição</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>hospital</td>
      <td>ano_internacao</td>
      <td>ano</td>
      <td>Ano de internação</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hospital</td>
      <td>PROC_REA</td>
      <td>parto</td>
      <td>Procedimento realizado</td>
    </tr>
    <tr>
      <th>2</th>
      <td>hospital</td>
      <td>CNES</td>
      <td>cod_hosp</td>
      <td>Código CNES do hospital</td>
    </tr>
    <tr>
      <th>3</th>
      <td>gestantante</td>
      <td>IDADE</td>
      <td>idade</td>
      <td>Idade</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gestantante</td>
      <td>def_raca_cor</td>
      <td>raca_cor</td>
      <td>Definição de raça/cor do paciente</td>
    </tr>
    <tr>
      <th>5</th>
      <td>localidade</td>
      <td>codigo_adotado</td>
      <td>cod_municipio</td>
      <td>Armazena o código atribuído ao município</td>
    </tr>
    <tr>
      <th>6</th>
      <td>localidade</td>
      <td>MUNNOMEX</td>
      <td>municipio</td>
      <td>Nome (sem acentos, em maiúsculas) do Município</td>
    </tr>
    <tr>
      <th>7</th>
      <td>localidade</td>
      <td>RSAUDCOD</td>
      <td>regiao_saude</td>
      <td>Código da Regional de Saúde a que o Município ...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>localidade</td>
      <td>SIGLA_UF</td>
      <td>uf</td>
      <td>Sigla da unidade da federação a que o Municípi...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>localidade</td>
      <td>REGIAO</td>
      <td>regiao</td>
      <td>Região do Brasil a que o Município pertence</td>
    </tr>
    <tr>
      <th>10</th>
      <td>localidade</td>
      <td>LATITUDE</td>
      <td>latitude</td>
      <td>Latitude da sede do Município</td>
    </tr>
    <tr>
      <th>11</th>
      <td>localidade</td>
      <td>LONGITUDE</td>
      <td>longitude</td>
      <td>Longitude da sede do Município</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="seleção-dos-registros-linhas" class="level3">
<h3 class="anchored" data-anchor-id="seleção-dos-registros-linhas">Seleção dos registros (linhas)</h3>
<p>Uma vez selecionado quais variáveis (colunas) utilizaremos, agora vamos definir quais são os critérios que usamos para selecionar os registros (linhas) a partir dos valores que possuem. A base do SIHSUS possui <code>157033546</code> registros no momento que foi baixada.</p>
<p><strong>Filtros</strong></p>
<p>A seguir descreveremos cada filtro aplicado, seu motivo, e o valor de registros resultantes ao aplica-lo (a ordem dos filtros importa).</p>
<ul>
<li><strong>PROC_REA in (‘0310010039’, ‘0411010034’)</strong></li>
</ul>
<p>Na base de dados do SIHSUS há vários procedimentos de internação que possuem seu código atribuído pelo <a href="http://sigtap.datasus.gov.br/tabela-unificada/app/sec/inicio.jsp">Sistema de Gerenciamento da Tabela de Procedimentos (SIGTAP)</a> registrado na variável <code>PROC_REA</code> que informa o procedimento que foi realizado. Em nossa análise, queremos observar apenas 2 códigos em específico: <code>03.10.01.003-9</code> para <em>Parto Normal</em>; e <code>04.11.01.003-4</code> para <em>Parto Cesariano</em>. Resutando em <code>23302307</code> registros.</p>
<ul>
<li><strong>ano_internacao between 2010 and 2019</strong></li>
</ul>
<p>Dos registros resultantes do filtro acima que foi aplicado, a variável <code>ano_internacao</code> contempla valores de 2007 até 2021. Entretanto, os da borda (2007 e 2021) estão incompletos. 2020 por ter sido um ano atípico devido a pandemia, é um ano que pode apresentar viés e portanto o consideremos ficar de fora de nossa análise. Escolhemos então analisar até o ano de 2019, e partir do anos de 2010 que inicia a segunda década deste milênio. Portanto, filtrando apenas os registros que possuiam o ano de internação entre 2010 e 2019, resultaram <code>17109256</code> registros.</p>
<ul>
<li><strong>res_RSAUDCOD != 0</strong></li>
</ul>
<p>Para realizarmos a análise de deslocamento entre residência e internação, precisamos necessariamente de ambas informações válidas. Como os registros são feitos no hospital, informações da localidade de internação já estão válido, já o de residência há excessões. Queremos portanto remover esses casos em que o código da Região de Saúde consta como <code>0</code>. O que resulta em <code>17106725</code> registros.</p>
<ul>
<li><strong>res_SIGLA_UF != ‘DF’</strong></li>
</ul>
<p>Estamos considerando a residência da paciente como ponto referencial da análise, e ao investigar seu estado de residência, não é do nosso interesse considerar os casos do Distrito Federal, pois os registros que ocorrêm nesse caso são em sua maioria sem problemas de deslocamento. Portanto, estamos filtrando apenas registros que não possuem <code>DF</code> como UF de residência. Resultando em <code>16817215</code> registros.</p>
<ul>
<li><strong>IDADE &gt;= 10</strong></li>
</ul>
<p>Existem alguns registros com valor da idade da gestante preenchido com apenas 1 dígito. Consideraremos apenas casos a partir de <code>10</code>, resultando no valor final de <code>16816760</code> registros.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>filters <span class="op">=</span> pd.read_csv(<span class="st">'data/check/filters.csv'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fig_filters <span class="op">=</span> go.Figure(go.Funnel(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> filters[<span class="st">'Registros'</span>],</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> filters[<span class="st">'Filtro'</span>],</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  textposition <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  textinfo <span class="op">=</span> <span class="st">"value+percent initial"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>fig_filters.show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-6-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="criação-de-variáveis" class="level2">
<h2 class="anchored" data-anchor-id="criação-de-variáveis">Criação de variáveis</h2>
<p>Além das informações coletadas das fontes de dados, acrescentaremos algumas para facilitar o escopo de nossa análise, são elas:</p>
<section id="deslocamento" class="level3">
<h3 class="anchored" data-anchor-id="deslocamento">Deslocamento</h3>
<p>Como é do nosso interesse detectar casos em que o <code>município</code> e/ou a <code>região de saúde</code> de residência diverge da de internação, criamos <code>1</code> variável de <code>criticidade</code> indicando:</p>
<ul>
<li><code>criticidade = 0</code>: município de residência e internação são iguais;</li>
<li><code>criticidade = 1</code>: município de residência e internação são diferentes, mas a região de saúde de residência é igual a região de saúde de internação;</li>
<li><code>criticidade = 2</code>: tanto município e região de saúde de residência, são diferentes do município e região de saúde de internação.</li>
</ul>
</section>
<section id="período" class="level3">
<h3 class="anchored" data-anchor-id="período">Período</h3>
<p>Queremos comparar 2 momentos distanciados significativamente pelo tempo, que sejam recortes que sirvam como <code>antes</code> e <code>depois</code>. Para isso criamos <code>1</code> variável <code>momento</code> que informa se é:</p>
<ul>
<li><code>antes</code> : 2010 e 2011;</li>
<li><code>depois</code> : 2018 e 2019;</li>
<li><code>durante</code> : demais anos intermediários.</li>
</ul>
</section>
</section>
<section id="tabelas-geradas" class="level2">
<h2 class="anchored" data-anchor-id="tabelas-geradas">Tabelas geradas</h2>
<p>Uma vez definido as informações a serem utilizadas na construção de nossa base de dados, agora vamos ver como ficou a estrutura resultante.</p>
<p>A base de dados resultante é um aquivo de extensão<code>.db</code> criado a partir de uma instância de um banco <code>SQLite3</code>. O arquivo contém as informações necessárias para a análise de nosso projeto, e possui <code>820MB</code> de tamanho. Ao comparar com a base completa do SIHSUS que possui <code>20GB</code>, nossa base equivale a <code>3.58%</code> do espaço da base original.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sizes <span class="op">=</span> pd.read_csv(<span class="st">'data/consult/sizes.csv'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    sizes,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="st">'File'</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span><span class="st">'Bytes'</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    text_auto<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>fig.show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-7-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>Tal redução foi possível graças ao processo de filtragem, mas também devido a organização da informação em 2 tabelas, onde:</p>
<ul>
<li><strong>Tabela Partos</strong>: possui os registros de cada ocorrência, informando as variáveis pertinentes;</li>
<li><strong>Tabela Localidades</strong>: possui informações relacionadas a localidade, como códigos, nomes, regiões, indicadores, etc.</li>
</ul>
<p>Dessa forma, na tabela de partos, não é necessário ter todas as informações de localidade, ainda mais duplicado para a residência e internação, enquanto que no modelo atual, basta registrar o código do município da residência e da internação, e a partir desse código, é possível consultar na tabela de localidade informações detalhadas de tal município.</p>
<p>Podemos olhar alguns registros e as colunas de cada tabela abaixo:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cnx <span class="op">=</span> sqlite3.<span class="ex">connect</span>(config.PATH_DB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="tabela-partos" class="level3">
<h3 class="anchored" data-anchor-id="tabela-partos">Tabela Partos</h3>
<p>A tabela de partos possui os <code>16816186</code> registros que estamos analisando.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(<span class="st">'select * from partos limit 5'</span>, cnx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ano</th>
      <th>parto</th>
      <th>cnes</th>
      <th>idade</th>
      <th>raca_cor</th>
      <th>criticidade</th>
      <th>momento</th>
      <th>res_cod_municipio</th>
      <th>int_cod_municipio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010</td>
      <td>NORMAL</td>
      <td>2001020</td>
      <td>23</td>
      <td>Amarela</td>
      <td>0</td>
      <td>antes</td>
      <td>120005</td>
      <td>120005</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010</td>
      <td>NORMAL</td>
      <td>2000733</td>
      <td>28</td>
      <td>Amarela</td>
      <td>0</td>
      <td>antes</td>
      <td>120040</td>
      <td>120040</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2010</td>
      <td>NORMAL</td>
      <td>2000733</td>
      <td>38</td>
      <td>Amarela</td>
      <td>0</td>
      <td>antes</td>
      <td>120040</td>
      <td>120040</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010</td>
      <td>NORMAL</td>
      <td>2000733</td>
      <td>16</td>
      <td>Amarela</td>
      <td>0</td>
      <td>antes</td>
      <td>120040</td>
      <td>120040</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2010</td>
      <td>NORMAL</td>
      <td>2000733</td>
      <td>26</td>
      <td>Amarela</td>
      <td>0</td>
      <td>antes</td>
      <td>120040</td>
      <td>120040</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="tabela-localidades" class="level3">
<h3 class="anchored" data-anchor-id="tabela-localidades">Tabela Localidades</h3>
<p>A tabela de localidades possui <code>5564</code> municípios brasileiros que contemplam os casos visualizados na tabela de partos.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(<span class="st">'select * from places limit 5'</span>, cnx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>cod_municipio</th>
      <th>municipio</th>
      <th>regiao_saude</th>
      <th>uf</th>
      <th>regiao</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>grupo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>510452</td>
      <td>IPIRANGA DO NORTE</td>
      <td>5114</td>
      <td>MT</td>
      <td>Centro-Oeste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>351600</td>
      <td>FLORIDA PAULISTA</td>
      <td>3514</td>
      <td>SP</td>
      <td>Sudeste</td>
      <td>-21.615</td>
      <td>-51.174</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>510454</td>
      <td>ITANHANGA</td>
      <td>5114</td>
      <td>MT</td>
      <td>Centro-Oeste</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>353990</td>
      <td>POLONI</td>
      <td>3522</td>
      <td>SP</td>
      <td>Sudeste</td>
      <td>-20.785</td>
      <td>-49.824</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>430063</td>
      <td>AMARAL FERRADOR</td>
      <td>4303</td>
      <td>RS</td>
      <td>Sul</td>
      <td>-30.875</td>
      <td>-52.253</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="conhecimento-das-variávies" class="level2">
<h2 class="anchored" data-anchor-id="conhecimento-das-variávies">Conhecimento das variávies</h2>
<p>Vamos ter um primeiro contato com algumas das variáveis ao ver a contagem que os valores de cada variável possui.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> query_value_counts(var, table_partos<span class="op">=</span><span class="va">True</span>):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> table_partos:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        q <span class="op">=</span> <span class="ss">f'select parto, </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss"> as value, count(</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">) as records from partos group by parto, </span><span class="sc">{</span>var<span class="sc">}</span><span class="ss"> order by count(</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">) desc'</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        q <span class="op">=</span> <span class="ss">f'select parto, PL.</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss"> as value, count(PL.</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">) as records from partos P left join places PL on P.res_cod_municipio = PL.cod_municipio group by parto, PL.</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss"> order by count(PL.</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">) desc'</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> q</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bar_plot(df, title<span class="op">=</span><span class="st">''</span>):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> px.bar(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        df,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'value'</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">'records'</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'parto'</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        category_orders<span class="op">=</span>{<span class="st">'value'</span>: df[<span class="st">'value'</span>].values},</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        text_auto<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span>title,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="conhecendo-as-variáveis-da-tabela-de-partos" class="level3">
<h3 class="anchored" data-anchor-id="conhecendo-as-variáveis-da-tabela-de-partos">Conhecendo as variáveis da tabela de partos</h3>
<section id="ano" class="level4">
<h4 class="anchored" data-anchor-id="ano">Ano</h4>
<p>Vamos começar obervando a quantidade de registros para cada ano de nossa base de dados.</p>
<p><strong>Observações</strong></p>
<ul>
<li>São todos bem parecidos</li>
</ul>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">'ano'</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="ss">f'data/consult/value_counts/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_sql_query(query_value_counts(var), cnx)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv(f'data/consult/value_counts/{var}.csv', index=False)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>bar_plot(df, var).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-13-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="parto" class="level4">
<h4 class="anchored" data-anchor-id="parto">Parto</h4>
<p>Em seguida vamos ver a quantidade de registros para cada tipo de parto.</p>
<p><strong>Observações</strong></p>
<ul>
<li>Cesariano é 2/3 o tamanho do Normal</li>
</ul>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">'parto'</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="ss">f'data/consult/value_counts/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_sql_query(query_value_counts(var), cnx)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv(f'data/consult/value_counts/{var}.csv', index=False)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>bar_plot(df, var).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-14-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="idade" class="level4">
<h4 class="anchored" data-anchor-id="idade">Idade</h4>
<p>Idade que as gestantes costumam ter.</p>
<p><strong>Observações</strong></p>
<ul>
<li>A distribuição pode ser modelada por uma gaussiana’</li>
<li>O pico é 20 anos;</li>
<li>Após os 20 anos há um leve declínio.</li>
</ul>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">'idade'</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="ss">f'data/consult/value_counts/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_sql_query(query_value_counts(var), cnx)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv(f'data/consult/value_counts/{var}.csv', index=False)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>bar_plot(df, var).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-15-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="raçacor" class="level4">
<h4 class="anchored" data-anchor-id="raçacor">Raça/Cor</h4>
<p>Vamos observar a frequência que cada raça/cor apresenta.</p>
<p><strong>Observações</strong></p>
<ul>
<li>O segundo maior valor é <code>None</code>, ou seja, não possui informação de raça/cor disponível;</li>
<li><code>Preta</code>, <code>Parda</code> e principalmente <code>Indígena</code> estão subnotificados;</li>
<li>A maioria está classificada como <code>Amarela</code>;</li>
<li><code>Branca</code> é um pouco mais que a metade de <code>Amarela</code>.</li>
</ul>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">'raca_cor'</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="ss">f'data/consult/value_counts/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_sql_query(query_value_counts(var), cnx)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv(f'data/consult/value_counts/{var}.csv', index=False)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>bar_plot(df, var).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-16-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="criticidade" class="level4">
<h4 class="anchored" data-anchor-id="criticidade">Criticidade</h4>
<p>A quantidade de registros que possuem o município de residência diferente do de internação (valor <code>1</code>), comparado com a quantidade cujo são iguais (valor <code>0</code>)</p>
<p><strong>Observações</strong></p>
<ul>
<li>A quantidade de municípios diferentes é cerca de 1/3 da quantidade de muncípio de residência e internação iguais.</li>
</ul>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">'criticidade'</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="ss">f'data/consult/value_counts/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_sql_query(query_value_counts(var), cnx)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv(f'data/consult/value_counts/{var}.csv', index=False)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>bar_plot(df, var).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-17-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="período-1" class="level4">
<h4 class="anchored" data-anchor-id="período-1">Período</h4>
<p>Por fim, vamos comparar os 2 biênios, passado (<code>2010-11</code>) e presente (<code>2018-19</code>).</p>
<p><strong>Observações</strong></p>
<ul>
<li>O passado é um pouco maior que o presente.</li>
</ul>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">'momento'</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="ss">f'data/consult/value_counts/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_sql_query(query_value_counts(var), cnx)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv(f'data/consult/value_counts/{var}.csv', index=False)</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>bar_plot(df, var).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-18-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="conhecendo-as-variáveis-da-tabela-de-localidades" class="level3">
<h3 class="anchored" data-anchor-id="conhecendo-as-variáveis-da-tabela-de-localidades">Conhecendo as variáveis da tabela de localidades</h3>
<p>Acima olhamos para variáveis da tabela de partos, agora olharemos para variáveis na tabela de localidades.</p>
<section id="região-do-brasil" class="level4">
<h4 class="anchored" data-anchor-id="região-do-brasil">Região do Brasil</h4>
<p>Regiões que compõe o Brasil, são elas:</p>
<ul>
<li>Norte</li>
<li>Nordeste</li>
<li>Centro-Oeste</li>
<li>Sudeste</li>
<li>Sul</li>
</ul>
<p><strong>Observações</strong></p>
<ul>
<li>Nordeste e Sudeste são equivalentes;</li>
<li>Sul e Norte também</li>
</ul>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">'regiao'</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="ss">f'data/consult/value_counts/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_sql_query(query_value_counts(var, False), cnx)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv(f'data/consult/value_counts/{var}.csv', index=False)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>bar_plot(df, var).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-19-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="grupo-socioeconômico-da-região-de-saúde" class="level4">
<h4 class="anchored" data-anchor-id="grupo-socioeconômico-da-região-de-saúde">Grupo Socioeconômico da Região de Saúde</h4>
<p>Indicador socioeconômico que informa a qual grupo uma região de saúde pertence, sendo de 1 até 5.</p>
<p><strong>Observações</strong></p>
<ul>
<li>Há alguns registros que não foi possível obter seu respectivo indicador socioeconômico, ficando no grupo <code>0</code></li>
</ul>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">'grupo'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="ss">f'data/consult/value_counts/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_sql_query(query_value_counts(var, False), cnx)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv(f'data/consult/value_counts/{var}.csv', index=False)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>bar_plot(df, var).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-20-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="unidade-federativa-uf" class="level4">
<h4 class="anchored" data-anchor-id="unidade-federativa-uf">Unidade Federativa (UF)</h4>
<p>O Brasil constitui de 26 Estados.</p>
<p><strong>Observações</strong></p>
<ul>
<li><code>SP</code> é quase o dobro do segundo estado <code>MG</code></li>
</ul>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>var <span class="op">=</span> <span class="st">'uf'</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="ss">f'data/consult/value_counts/</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df = pd.read_sql_query(query_value_counts(var, False), cnx)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df.to_csv(f'data/consult/value_counts/{var}.csv', index=False)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>bar_plot(df, var).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-21-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="investigações" class="level1">
<h1>Investigações</h1>
<p>Agora que já tivemos um primeiro contato com nossa base de dados, vamos começar a investigar as informações presentes.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_and_run_query(query_path, cnx):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(query_path) <span class="im">as</span> f:</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        query <span class="op">=</span> f.read()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_sql_query(query, cnx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> group_all_but(df, but<span class="op">=</span><span class="st">'records'</span>):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.groupby(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        by<span class="op">=</span>[col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> but <span class="kw">not</span> <span class="kw">in</span> col],</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        as_index<span class="op">=</span><span class="va">False</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">sum</span>().sort_values(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        by<span class="op">=</span>[<span class="st">'records'</span>],</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        ascending<span class="op">=</span>[<span class="va">False</span>],</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> join_dfs(left, right):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> left.join(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        right,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        lsuffix<span class="op">=</span><span class="st">'_num'</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        rsuffix<span class="op">=</span><span class="st">'_den'</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    den_cols <span class="op">=</span> [</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> (</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>            col[<span class="op">-</span><span class="dv">4</span>:] <span class="op">==</span> <span class="st">'_den'</span> <span class="kw">and</span> col[:<span class="dv">7</span>] <span class="op">!=</span> <span class="st">'records'</span>)]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.rename(columns<span class="op">=</span>{</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        col : col.replace(<span class="st">'_num'</span>, <span class="st">''</span>) <span class="cf">for</span> col <span class="kw">in</span> df.columns})</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.drop(den_cols, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_num_den(df_group):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    dfs <span class="op">=</span> {</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'all'</span> : df_group.copy(),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'municipal'</span> : df_group[(df_group[<span class="st">'criticidade'</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">|</span> (df_group[<span class="st">'criticidade'</span>] <span class="op">==</span> <span class="dv">2</span>)].copy(),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'regional'</span> : df_group[(df_group[<span class="st">'criticidade'</span>] <span class="op">==</span> <span class="dv">2</span>)].copy()</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> label, df <span class="kw">in</span> dfs.items():</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>        df[<span class="st">'criticidade'</span>] <span class="op">=</span> label</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        dfs[label] <span class="op">=</span> group_all_but(df)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.concat([</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        join_dfs(dfs[<span class="st">'municipal'</span>], dfs[<span class="st">'all'</span>]),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        join_dfs(dfs[<span class="st">'regional'</span>], dfs[<span class="st">'municipal'</span>])</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_percent(df, num<span class="op">=</span><span class="st">'records'</span>):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'percent'</span>] <span class="op">=</span> <span class="fl">100.</span> <span class="op">*</span> df[num] <span class="op">/</span> df[<span class="ss">f'</span><span class="sc">{</span>num<span class="sc">}</span><span class="ss">_den'</span>]</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> group_col(df, column<span class="op">=</span><span class="va">None</span>, value<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    del_cols <span class="op">=</span> [<span class="st">'regiao'</span>, <span class="st">'uf'</span>, <span class="st">'grupo'</span>]</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> column:</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        del_cols <span class="op">=</span> [col</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> col <span class="kw">in</span> del_cols</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> col <span class="op">!=</span> column]</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    cols_filter <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> df.columns</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> col <span class="kw">not</span> <span class="kw">in</span> del_cols]</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    dff <span class="op">=</span> df[cols_filter].copy()</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> value:</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        dff <span class="op">=</span> dff[dff[column] <span class="op">==</span> value]</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    dff <span class="op">=</span> group_all_but(dff)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    dff <span class="op">=</span> calc_percent(dff)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="comparando-momentos-temporais" class="level2">
<h2 class="anchored" data-anchor-id="comparando-momentos-temporais">Comparando momentos temporais</h2>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_bar_percent(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>        df,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        x, y,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">''</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> px.bar(</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        df, x<span class="op">=</span>x, y<span class="op">=</span>y,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        color <span class="op">=</span> <span class="st">'parto'</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        text_auto<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span>title,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        barmode<span class="op">=</span><span class="st">'group'</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>path_moments <span class="op">=</span> <span class="st">'data/consult/group/moments.csv'</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>path_moments_q <span class="op">=</span> path_moments.replace(<span class="st">'data'</span>, <span class="st">'queries'</span>).replace(<span class="st">'csv'</span>, <span class="st">'sql'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df_moments <span class="op">=</span> pd.read_csv(path_moments)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df_moments = read_and_run_query(path_moments_q, cnx)</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df_moments.to_csv(path_moments, index=False)</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>df_moments_counts <span class="op">=</span> get_num_den(df_moments)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>df_moments_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>momento</th>
      <th>parto</th>
      <th>regiao</th>
      <th>uf</th>
      <th>grupo</th>
      <th>criticidade</th>
      <th>records</th>
      <th>records_den</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>BA</td>
      <td>1</td>
      <td>municipal</td>
      <td>125273</td>
      <td>420550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>PE</td>
      <td>1</td>
      <td>municipal</td>
      <td>80239</td>
      <td>171589</td>
    </tr>
    <tr>
      <th>2</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Sudeste</td>
      <td>RJ</td>
      <td>5</td>
      <td>municipal</td>
      <td>79153</td>
      <td>399339</td>
    </tr>
    <tr>
      <th>3</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Nordeste</td>
      <td>BA</td>
      <td>1</td>
      <td>municipal</td>
      <td>76857</td>
      <td>186654</td>
    </tr>
    <tr>
      <th>4</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Sudeste</td>
      <td>SP</td>
      <td>5</td>
      <td>municipal</td>
      <td>73645</td>
      <td>776083</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>485</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Norte</td>
      <td>RR</td>
      <td>2</td>
      <td>regional</td>
      <td>6</td>
      <td>710</td>
    </tr>
    <tr>
      <th>486</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>AP</td>
      <td>2</td>
      <td>regional</td>
      <td>5</td>
      <td>548</td>
    </tr>
    <tr>
      <th>487</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Centro-Oeste</td>
      <td>MS</td>
      <td>2</td>
      <td>regional</td>
      <td>4</td>
      <td>1351</td>
    </tr>
    <tr>
      <th>488</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Centro-Oeste</td>
      <td>MS</td>
      <td>2</td>
      <td>regional</td>
      <td>4</td>
      <td>229</td>
    </tr>
    <tr>
      <th>489</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>RR</td>
      <td>2</td>
      <td>regional</td>
      <td>3</td>
      <td>31</td>
    </tr>
  </tbody>
</table>
<p>982 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df_regioes <span class="op">=</span> group_col(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    df_moments_counts, column<span class="op">=</span><span class="st">'regiao'</span>, value<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>plot_bar_percent(df_regioes, <span class="st">'regiao'</span>, <span class="st">'percent'</span>).show(renderer<span class="op">=</span><span class="st">"svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-30-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_regioes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>momento</th>
      <th>parto</th>
      <th>regiao</th>
      <th>criticidade</th>
      <th>records</th>
      <th>records_den</th>
      <th>percent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>52</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>municipal</td>
      <td>699622</td>
      <td>2083726</td>
      <td>33.575528</td>
    </tr>
    <tr>
      <th>42</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Nordeste</td>
      <td>municipal</td>
      <td>499142</td>
      <td>1207945</td>
      <td>41.321583</td>
    </tr>
    <tr>
      <th>56</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Sudeste</td>
      <td>municipal</td>
      <td>440628</td>
      <td>2189260</td>
      <td>20.126801</td>
    </tr>
    <tr>
      <th>46</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Sudeste</td>
      <td>municipal</td>
      <td>281450</td>
      <td>1287667</td>
      <td>21.857359</td>
    </tr>
    <tr>
      <th>12</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>municipal</td>
      <td>250103</td>
      <td>817957</td>
      <td>30.576546</td>
    </tr>
    <tr>
      <th>32</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>municipal</td>
      <td>222392</td>
      <td>634703</td>
      <td>35.038750</td>
    </tr>
    <tr>
      <th>58</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Sul</td>
      <td>municipal</td>
      <td>198546</td>
      <td>764529</td>
      <td>25.969715</td>
    </tr>
    <tr>
      <th>22</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Nordeste</td>
      <td>municipal</td>
      <td>181279</td>
      <td>428789</td>
      <td>42.276971</td>
    </tr>
    <tr>
      <th>53</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>regional</td>
      <td>176996</td>
      <td>662482</td>
      <td>26.717103</td>
    </tr>
    <tr>
      <th>2</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Nordeste</td>
      <td>municipal</td>
      <td>163596</td>
      <td>413105</td>
      <td>39.601554</td>
    </tr>
    <tr>
      <th>36</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Sudeste</td>
      <td>municipal</td>
      <td>150371</td>
      <td>701907</td>
      <td>21.423208</td>
    </tr>
    <tr>
      <th>48</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Sul</td>
      <td>municipal</td>
      <td>149781</td>
      <td>561724</td>
      <td>26.664519</td>
    </tr>
    <tr>
      <th>16</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Sudeste</td>
      <td>municipal</td>
      <td>140816</td>
      <td>772164</td>
      <td>18.236540</td>
    </tr>
    <tr>
      <th>43</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Nordeste</td>
      <td>regional</td>
      <td>132790</td>
      <td>493220</td>
      <td>26.923077</td>
    </tr>
    <tr>
      <th>54</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Norte</td>
      <td>municipal</td>
      <td>119164</td>
      <td>796221</td>
      <td>14.966197</td>
    </tr>
    <tr>
      <th>26</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Sudeste</td>
      <td>municipal</td>
      <td>104382</td>
      <td>463234</td>
      <td>22.533320</td>
    </tr>
    <tr>
      <th>44</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>municipal</td>
      <td>94726</td>
      <td>479500</td>
      <td>19.755162</td>
    </tr>
    <tr>
      <th>50</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Centro-Oeste</td>
      <td>municipal</td>
      <td>90060</td>
      <td>353234</td>
      <td>25.495847</td>
    </tr>
    <tr>
      <th>6</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Sudeste</td>
      <td>municipal</td>
      <td>85166</td>
      <td>428777</td>
      <td>19.862539</td>
    </tr>
    <tr>
      <th>38</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Sul</td>
      <td>municipal</td>
      <td>71082</td>
      <td>236440</td>
      <td>30.063441</td>
    </tr>
    <tr>
      <th>13</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>regional</td>
      <td>64562</td>
      <td>250132</td>
      <td>25.811172</td>
    </tr>
    <tr>
      <th>40</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Centro-Oeste</td>
      <td>municipal</td>
      <td>60389</td>
      <td>277740</td>
      <td>21.742997</td>
    </tr>
    <tr>
      <th>33</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>regional</td>
      <td>59201</td>
      <td>211268</td>
      <td>28.021754</td>
    </tr>
    <tr>
      <th>18</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Sul</td>
      <td>municipal</td>
      <td>59116</td>
      <td>273384</td>
      <td>21.623797</td>
    </tr>
    <tr>
      <th>28</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Sul</td>
      <td>municipal</td>
      <td>56726</td>
      <td>187838</td>
      <td>30.199427</td>
    </tr>
    <tr>
      <th>51</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Centro-Oeste</td>
      <td>regional</td>
      <td>48545</td>
      <td>86949</td>
      <td>55.831579</td>
    </tr>
    <tr>
      <th>3</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Nordeste</td>
      <td>regional</td>
      <td>47994</td>
      <td>163596</td>
      <td>29.336903</td>
    </tr>
    <tr>
      <th>23</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Nordeste</td>
      <td>regional</td>
      <td>47132</td>
      <td>179260</td>
      <td>26.292536</td>
    </tr>
    <tr>
      <th>57</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Sudeste</td>
      <td>regional</td>
      <td>42057</td>
      <td>333122</td>
      <td>12.625104</td>
    </tr>
    <tr>
      <th>14</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Norte</td>
      <td>municipal</td>
      <td>39730</td>
      <td>291774</td>
      <td>13.616703</td>
    </tr>
    <tr>
      <th>34</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Norte</td>
      <td>municipal</td>
      <td>38669</td>
      <td>251436</td>
      <td>15.379262</td>
    </tr>
    <tr>
      <th>8</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Sul</td>
      <td>municipal</td>
      <td>37971</td>
      <td>166097</td>
      <td>22.860738</td>
    </tr>
    <tr>
      <th>55</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Norte</td>
      <td>regional</td>
      <td>35815</td>
      <td>171621</td>
      <td>20.868658</td>
    </tr>
    <tr>
      <th>24</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>municipal</td>
      <td>33005</td>
      <td>172802</td>
      <td>19.099895</td>
    </tr>
    <tr>
      <th>30</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Centro-Oeste</td>
      <td>municipal</td>
      <td>32940</td>
      <td>117882</td>
      <td>27.943197</td>
    </tr>
    <tr>
      <th>41</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Centro-Oeste</td>
      <td>regional</td>
      <td>30500</td>
      <td>59182</td>
      <td>51.535940</td>
    </tr>
    <tr>
      <th>45</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>regional</td>
      <td>29764</td>
      <td>109905</td>
      <td>27.081570</td>
    </tr>
    <tr>
      <th>47</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Sudeste</td>
      <td>regional</td>
      <td>26627</td>
      <td>207424</td>
      <td>12.836991</td>
    </tr>
    <tr>
      <th>4</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>municipal</td>
      <td>26529</td>
      <td>146771</td>
      <td>18.075097</td>
    </tr>
    <tr>
      <th>10</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Centro-Oeste</td>
      <td>municipal</td>
      <td>25467</td>
      <td>126106</td>
      <td>20.194915</td>
    </tr>
    <tr>
      <th>20</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Centro-Oeste</td>
      <td>municipal</td>
      <td>23868</td>
      <td>104931</td>
      <td>22.746376</td>
    </tr>
    <tr>
      <th>59</th>
      <td>durante</td>
      <td>NORMAL</td>
      <td>Sul</td>
      <td>regional</td>
      <td>23015</td>
      <td>278040</td>
      <td>8.277586</td>
    </tr>
    <tr>
      <th>49</th>
      <td>durante</td>
      <td>CESARIANO</td>
      <td>Sul</td>
      <td>regional</td>
      <td>21641</td>
      <td>208118</td>
      <td>10.398428</td>
    </tr>
    <tr>
      <th>31</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Centro-Oeste</td>
      <td>regional</td>
      <td>17681</td>
      <td>31013</td>
      <td>57.011576</td>
    </tr>
    <tr>
      <th>37</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Sudeste</td>
      <td>regional</td>
      <td>15780</td>
      <td>112454</td>
      <td>14.032404</td>
    </tr>
    <tr>
      <th>0</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Centro-Oeste</td>
      <td>municipal</td>
      <td>14953</td>
      <td>79117</td>
      <td>18.899857</td>
    </tr>
    <tr>
      <th>17</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Sudeste</td>
      <td>regional</td>
      <td>13246</td>
      <td>107183</td>
      <td>12.358303</td>
    </tr>
    <tr>
      <th>35</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Norte</td>
      <td>regional</td>
      <td>13138</td>
      <td>55701</td>
      <td>23.586650</td>
    </tr>
    <tr>
      <th>11</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Centro-Oeste</td>
      <td>regional</td>
      <td>12897</td>
      <td>25388</td>
      <td>50.799590</td>
    </tr>
    <tr>
      <th>25</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>regional</td>
      <td>11265</td>
      <td>38843</td>
      <td>29.001364</td>
    </tr>
    <tr>
      <th>21</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Centro-Oeste</td>
      <td>regional</td>
      <td>11019</td>
      <td>28867</td>
      <td>38.171615</td>
    </tr>
    <tr>
      <th>27</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Sudeste</td>
      <td>regional</td>
      <td>10524</td>
      <td>80045</td>
      <td>13.147604</td>
    </tr>
    <tr>
      <th>15</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Norte</td>
      <td>regional</td>
      <td>9414</td>
      <td>40536</td>
      <td>23.223801</td>
    </tr>
    <tr>
      <th>19</th>
      <td>antes</td>
      <td>NORMAL</td>
      <td>Sul</td>
      <td>regional</td>
      <td>9126</td>
      <td>85244</td>
      <td>10.705739</td>
    </tr>
    <tr>
      <th>7</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Sudeste</td>
      <td>regional</td>
      <td>7860</td>
      <td>68906</td>
      <td>11.406844</td>
    </tr>
    <tr>
      <th>39</th>
      <td>depois</td>
      <td>NORMAL</td>
      <td>Sul</td>
      <td>regional</td>
      <td>7804</td>
      <td>98385</td>
      <td>7.932103</td>
    </tr>
    <tr>
      <th>1</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Centro-Oeste</td>
      <td>regional</td>
      <td>7234</td>
      <td>14953</td>
      <td>48.378252</td>
    </tr>
    <tr>
      <th>5</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>regional</td>
      <td>7104</td>
      <td>25996</td>
      <td>27.327281</td>
    </tr>
    <tr>
      <th>29</th>
      <td>depois</td>
      <td>CESARIANO</td>
      <td>Sul</td>
      <td>regional</td>
      <td>6992</td>
      <td>76399</td>
      <td>9.151952</td>
    </tr>
    <tr>
      <th>9</th>
      <td>antes</td>
      <td>CESARIANO</td>
      <td>Sul</td>
      <td>regional</td>
      <td>6847</td>
      <td>50976</td>
      <td>13.431811</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="tendência-ao-longo-dos-anos" class="level2">
<h2 class="anchored" data-anchor-id="tendência-ao-longo-dos-anos">Tendência ao longo dos anos</h2>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_year_percent(df):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sns.lineplot(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">'ano'</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">'percent'</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        hue<span class="op">=</span><span class="st">'parto'</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        style<span class="op">=</span><span class="st">'criticidade'</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        data<span class="op">=</span>df</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>path_years <span class="op">=</span> <span class="st">'data/consult/group/years.csv'</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>path_years_q <span class="op">=</span> path_years.replace(<span class="st">'data'</span>, <span class="st">'queries'</span>).replace(<span class="st">'csv'</span>, <span class="st">'sql'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>df_years <span class="op">=</span> pd.read_csv(path_years)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># df_years = read_and_run_query(path_years_q, cnx)</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># df_years.to_csv(path_years, index=False)</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>df_years_counts <span class="op">=</span> get_num_den(df_years)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>df_years_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ano</th>
      <th>parto</th>
      <th>regiao</th>
      <th>uf</th>
      <th>grupo</th>
      <th>criticidade</th>
      <th>records</th>
      <th>records_den</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>BA</td>
      <td>1</td>
      <td>municipal</td>
      <td>22866</td>
      <td>84460</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>BA</td>
      <td>1</td>
      <td>municipal</td>
      <td>22350</td>
      <td>80253</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2012</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>BA</td>
      <td>1</td>
      <td>municipal</td>
      <td>21502</td>
      <td>73804</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2015</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>BA</td>
      <td>1</td>
      <td>municipal</td>
      <td>21412</td>
      <td>71521</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016</td>
      <td>NORMAL</td>
      <td>Nordeste</td>
      <td>BA</td>
      <td>1</td>
      <td>municipal</td>
      <td>20926</td>
      <td>68220</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1629</th>
      <td>2012</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>RR</td>
      <td>2</td>
      <td>regional</td>
      <td>1</td>
      <td>3057</td>
    </tr>
    <tr>
      <th>1630</th>
      <td>2015</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>RR</td>
      <td>1</td>
      <td>regional</td>
      <td>1</td>
      <td>7621</td>
    </tr>
    <tr>
      <th>1631</th>
      <td>2015</td>
      <td>NORMAL</td>
      <td>Norte</td>
      <td>RR</td>
      <td>1</td>
      <td>regional</td>
      <td>1</td>
      <td>7518</td>
    </tr>
    <tr>
      <th>1632</th>
      <td>2013</td>
      <td>CESARIANO</td>
      <td>Norte</td>
      <td>RR</td>
      <td>2</td>
      <td>regional</td>
      <td>1</td>
      <td>341</td>
    </tr>
    <tr>
      <th>1633</th>
      <td>2010</td>
      <td>NORMAL</td>
      <td>Centro-Oeste</td>
      <td>MS</td>
      <td>2</td>
      <td>regional</td>
      <td>1</td>
      <td>98</td>
    </tr>
  </tbody>
</table>
<p>3274 rows × 8 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_brasil <span class="op">=</span> group_col(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    df_years_counts, column<span class="op">=</span><span class="va">None</span>, value<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>plot_year_percent(df_brasil)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>&lt;AxesSubplot:xlabel='ano', ylabel='percent'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-34-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>df_rj <span class="op">=</span> group_col(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    df_years_counts, column<span class="op">=</span><span class="st">'uf'</span>, value<span class="op">=</span><span class="st">'RJ'</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>plot_year_percent(df_rj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>&lt;AxesSubplot:xlabel='ano', ylabel='percent'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-35-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df_norte <span class="op">=</span> group_col(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    df_years_counts, column<span class="op">=</span><span class="st">'regiao'</span>, value<span class="op">=</span><span class="st">'Norte'</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>plot_year_percent(df_norte)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>&lt;AxesSubplot:xlabel='ano', ylabel='percent'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-36-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df_grupo_1 <span class="op">=</span> group_col(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    df_years_counts, column<span class="op">=</span><span class="st">'grupo'</span>, value<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>plot_year_percent(df_grupo_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>&lt;AxesSubplot:xlabel='ano', ylabel='percent'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="notebook_files/figure-html/cell-37-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="conexões-entre-residência-e-internação" class="level1">
<h1>Conexões entre Residência e Internação</h1>
<p>Arestas entre origem (residência) e destino (internação)</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>path_edges <span class="op">=</span> <span class="st">'data/consult/edges/municipios_conectados.csv'</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>path_edges_q <span class="op">=</span> path_edges.replace(<span class="st">'data'</span>, <span class="st">'queries'</span>).replace(<span class="st">'csv'</span>, <span class="st">'sql'</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># df_edges = pd.read_csv(path_edges)</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>df_edges <span class="op">=</span> read_and_run_query(path_edges_q, cnx)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>df_edges.to_csv(path_edges, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>df_edges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloaded at: data/SIHSUS.zip</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="42">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>res_cod_municipio</th>
      <th>int_cod_municipio</th>
      <th>records</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>355030</td>
      <td>355030</td>
      <td>789130</td>
    </tr>
    <tr>
      <th>1</th>
      <td>330455</td>
      <td>330455</td>
      <td>358173</td>
    </tr>
    <tr>
      <th>2</th>
      <td>130260</td>
      <td>130260</td>
      <td>296680</td>
    </tr>
    <tr>
      <th>3</th>
      <td>230440</td>
      <td>230440</td>
      <td>196059</td>
    </tr>
    <tr>
      <th>4</th>
      <td>292740</td>
      <td>292740</td>
      <td>165847</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>71671</th>
      <td>522220</td>
      <td>520540</td>
      <td>1</td>
    </tr>
    <tr>
      <th>71672</th>
      <td>522220</td>
      <td>521830</td>
      <td>1</td>
    </tr>
    <tr>
      <th>71673</th>
      <td>522230</td>
      <td>521830</td>
      <td>1</td>
    </tr>
    <tr>
      <th>71674</th>
      <td>522230</td>
      <td>521970</td>
      <td>1</td>
    </tr>
    <tr>
      <th>71675</th>
      <td>522230</td>
      <td>522045</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>71676 rows × 3 columns</p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>